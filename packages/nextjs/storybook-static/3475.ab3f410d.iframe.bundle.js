/*! For license information please see 3475.ab3f410d.iframe.bundle.js.LICENSE.txt */
(self.webpackChunk_se_2_nextjs=self.webpackChunk_se_2_nextjs||[]).push([[3475],{"./node_modules/@coinbase/wallet-sdk/dist/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{createCoinbaseWalletSDK:()=>createCoinbaseWalletSDK});var decodeAbiParameters=__webpack_require__("./node_modules/viem/_esm/utils/abi/decodeAbiParameters.js"),encodeFunctionData=__webpack_require__("./node_modules/viem/_esm/utils/abi/encodeFunctionData.js"),toHex=__webpack_require__("./node_modules/viem/_esm/utils/encoding/toHex.js"),console=__webpack_require__("./node_modules/console-browserify/index.js");function createJSONStorage(getStorage,options){let storage;try{storage=getStorage()}catch(e){return}const persistStorage={getItem:name=>{var _a;const parse=str2=>null===str2?null:JSON.parse(str2,null==options?void 0:options.reviver),str=null!=(_a=storage.getItem(name))?_a:null;return str instanceof Promise?str.then(parse):parse(str)},setItem:(name,newValue)=>storage.setItem(name,JSON.stringify(newValue,null==options?void 0:options.replacer)),removeItem:name=>storage.removeItem(name)};return persistStorage}const toThenable=fn=>input=>{try{const result=fn(input);return result instanceof Promise?result:{then:onFulfilled=>toThenable(onFulfilled)(result),catch(_onRejected){return this}}}catch(e){return{then(_onFulfilled){return this},catch:onRejected=>toThenable(onRejected)(e)}}},persist=(config,baseOptions)=>(set,get,api)=>{let options={storage:createJSONStorage(()=>localStorage),partialize:state=>state,version:0,merge:(persistedState,currentState)=>({...currentState,...persistedState}),...baseOptions},hasHydrated=!1;const hydrationListeners=new Set,finishHydrationListeners=new Set;let storage=options.storage;if(!storage)return config((...args)=>{console.warn(`[zustand persist middleware] Unable to update item '${options.name}', the given storage is currently unavailable.`),set(...args)},get,api);const setItem=()=>{const state=options.partialize({...get()});return storage.setItem(options.name,{state,version:options.version})},savedSetState=api.setState;api.setState=(state,replace)=>{savedSetState(state,replace),setItem()};const configResult=config((...args)=>{set(...args),setItem()},get,api);let stateFromStorage;api.getInitialState=()=>configResult;const hydrate=()=>{var _a,_b;if(!storage)return;hasHydrated=!1,hydrationListeners.forEach(cb=>{var _a2;return cb(null!=(_a2=get())?_a2:configResult)});const postRehydrationCallback=(null==(_b=options.onRehydrateStorage)?void 0:_b.call(options,null!=(_a=get())?_a:configResult))||void 0;return toThenable(storage.getItem.bind(storage))(options.name).then(deserializedStorageValue=>{if(deserializedStorageValue){if("number"!=typeof deserializedStorageValue.version||deserializedStorageValue.version===options.version)return[!1,deserializedStorageValue.state];if(options.migrate){const migration=options.migrate(deserializedStorageValue.state,deserializedStorageValue.version);return migration instanceof Promise?migration.then(result=>[!0,result]):[!0,migration]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}return[!1,void 0]}).then(migrationResult=>{var _a2;const[migrated,migratedState]=migrationResult;if(stateFromStorage=options.merge(migratedState,null!=(_a2=get())?_a2:configResult),set(stateFromStorage,!0),migrated)return setItem()}).then(()=>{null==postRehydrationCallback||postRehydrationCallback(stateFromStorage,void 0),stateFromStorage=get(),hasHydrated=!0,finishHydrationListeners.forEach(cb=>cb(stateFromStorage))}).catch(e=>{null==postRehydrationCallback||postRehydrationCallback(void 0,e)})};return api.persist={setOptions:newOptions=>{options={...options,...newOptions},newOptions.storage&&(storage=newOptions.storage)},clearStorage:()=>{null==storage||storage.removeItem(options.name)},getOptions:()=>options,rehydrate:()=>hydrate(),hasHydrated:()=>hasHydrated,onHydrate:cb=>(hydrationListeners.add(cb),()=>{hydrationListeners.delete(cb)}),onFinishHydration:cb=>(finishHydrationListeners.add(cb),()=>{finishHydrationListeners.delete(cb)})},options.skipHydration||hydrate(),stateFromStorage||configResult},createStoreImpl=createState=>{let state;const listeners=new Set,setState=(partial,replace)=>{const nextState="function"==typeof partial?partial(state):partial;if(!Object.is(nextState,state)){const previousState=state;state=(null!=replace?replace:"object"!=typeof nextState||null===nextState)?nextState:Object.assign({},state,nextState),listeners.forEach(listener=>listener(state,previousState))}},getState=()=>state,api={setState,getState,getInitialState:()=>initialState,subscribe:listener=>(listeners.add(listener),()=>listeners.delete(listener))},initialState=state=createState(setState,getState,api);return api},createStore=createState=>createState?createStoreImpl(createState):createStoreImpl,NAME="@coinbase/wallet-sdk",sdkstore=createStore(persist((...args)=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},{chains:[]}),{keys:{}}),{account:{}}),{subAccount:void 0}),{spendPermissions:[]}),{config:{version:"4.3.6"}}),{subAccountConfig:{}}),{name:"cbwsdk.store",storage:createJSONStorage(()=>localStorage),partialize:state=>({chains:state.chains,keys:state.keys,account:state.account,subAccount:state.subAccount,spendPermissions:state.spendPermissions,config:state.config})})),config={get:()=>sdkstore.getState().config,set:config=>{sdkstore.setState(state=>({config:Object.assign(Object.assign({},state.config),config)}))}},actions={subAccounts:{get:()=>sdkstore.getState().subAccount,set:subAccount=>{sdkstore.setState(state=>({subAccount:state.subAccount?Object.assign(Object.assign({},state.subAccount),subAccount):Object.assign({address:subAccount.address},subAccount)}))},clear:()=>{sdkstore.setState({subAccount:void 0})}},subAccountsConfig:{get:()=>sdkstore.getState().subAccountConfig,set:subAccountConfig=>{sdkstore.setState(state=>({subAccountConfig:Object.assign(Object.assign({},state.subAccountConfig),subAccountConfig)}))},clear:()=>{sdkstore.setState({subAccountConfig:{}})}},spendPermissions:{get:()=>sdkstore.getState().spendPermissions,set:spendPermissions=>{sdkstore.setState({spendPermissions})},clear:()=>{sdkstore.setState({spendPermissions:[]})}},account:{get:()=>sdkstore.getState().account,set:account=>{sdkstore.setState(state=>({account:Object.assign(Object.assign({},state.account),account)}))},clear:()=>{sdkstore.setState({account:{}})}},chains:{get:()=>sdkstore.getState().chains,set:chains=>{sdkstore.setState({chains})},clear:()=>{sdkstore.setState({chains:[]})}},keys:{get:key=>sdkstore.getState().keys[key],set:(key,value)=>{sdkstore.setState(state=>({keys:Object.assign(Object.assign({},state.keys),{[key]:value})}))},clear:()=>{sdkstore.setState({keys:{}})}},config},store=Object.assign(Object.assign({},sdkstore),actions);var initCCA_console=__webpack_require__("./node_modules/console-browserify/index.js");const loadTelemetryScript=()=>new Promise((resolve,reject)=>{if(window.ClientAnalytics)return resolve();try{const script=document.createElement("script");script.textContent='!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.ClientAnalytics=t():e.ClientAnalytics=t()}(this,(function(){return(()=>{var e={792:e=>{var t={utf8:{stringToBytes:function(e){return t.bin.stringToBytes(unescape(encodeURIComponent(e)))},bytesToString:function(e){return decodeURIComponent(escape(t.bin.bytesToString(e)))}},bin:{stringToBytes:function(e){for(var t=[],n=0;n<e.length;n++)t.push(255&e.charCodeAt(n));return t},bytesToString:function(e){for(var t=[],n=0;n<e.length;n++)t.push(String.fromCharCode(e[n]));return t.join("")}}};e.exports=t},562:e=>{var t,n;t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n={rotl:function(e,t){return e<<t|e>>>32-t},rotr:function(e,t){return e<<32-t|e>>>t},endian:function(e){if(e.constructor==Number)return 16711935&n.rotl(e,8)|4278255360&n.rotl(e,24);for(var t=0;t<e.length;t++)e[t]=n.endian(e[t]);return e},randomBytes:function(e){for(var t=[];e>0;e--)t.push(Math.floor(256*Math.random()));return t},bytesToWords:function(e){for(var t=[],n=0,r=0;n<e.length;n++,r+=8)t[r>>>5]|=e[n]<<24-r%32;return t},wordsToBytes:function(e){for(var t=[],n=0;n<32*e.length;n+=8)t.push(e[n>>>5]>>>24-n%32&255);return t},bytesToHex:function(e){for(var t=[],n=0;n<e.length;n++)t.push((e[n]>>>4).toString(16)),t.push((15&e[n]).toString(16));return t.join("")},hexToBytes:function(e){for(var t=[],n=0;n<e.length;n+=2)t.push(parseInt(e.substr(n,2),16));return t},bytesToBase64:function(e){for(var n=[],r=0;r<e.length;r+=3)for(var i=e[r]<<16|e[r+1]<<8|e[r+2],a=0;a<4;a++)8*r+6*a<=8*e.length?n.push(t.charAt(i>>>6*(3-a)&63)):n.push("=");return n.join("")},base64ToBytes:function(e){e=e.replace(/[^A-Z0-9+\\/]/gi,"");for(var n=[],r=0,i=0;r<e.length;i=++r%4)0!=i&&n.push((t.indexOf(e.charAt(r-1))&Math.pow(2,-2*i+8)-1)<<2*i|t.indexOf(e.charAt(r))>>>6-2*i);return n}},e.exports=n},335:e=>{function t(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}e.exports=function(e){return null!=e&&(t(e)||function(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&t(e.slice(0,0))}(e)||!!e._isBuffer)}},762:(e,t,n)=>{var r,i,a,o,s;r=n(562),i=n(792).utf8,a=n(335),o=n(792).bin,(s=function(e,t){e.constructor==String?e=t&&"binary"===t.encoding?o.stringToBytes(e):i.stringToBytes(e):a(e)?e=Array.prototype.slice.call(e,0):Array.isArray(e)||e.constructor===Uint8Array||(e=e.toString());for(var n=r.bytesToWords(e),c=8*e.length,u=1732584193,l=-271733879,d=-1732584194,p=271733878,m=0;m<n.length;m++)n[m]=16711935&(n[m]<<8|n[m]>>>24)|4278255360&(n[m]<<24|n[m]>>>8);n[c>>>5]|=128<<c%32,n[14+(c+64>>>9<<4)]=c;var f=s._ff,v=s._gg,g=s._hh,b=s._ii;for(m=0;m<n.length;m+=16){var h=u,w=l,y=d,T=p;u=f(u,l,d,p,n[m+0],7,-680876936),p=f(p,u,l,d,n[m+1],12,-389564586),d=f(d,p,u,l,n[m+2],17,606105819),l=f(l,d,p,u,n[m+3],22,-1044525330),u=f(u,l,d,p,n[m+4],7,-176418897),p=f(p,u,l,d,n[m+5],12,1200080426),d=f(d,p,u,l,n[m+6],17,-1473231341),l=f(l,d,p,u,n[m+7],22,-45705983),u=f(u,l,d,p,n[m+8],7,1770035416),p=f(p,u,l,d,n[m+9],12,-1958414417),d=f(d,p,u,l,n[m+10],17,-42063),l=f(l,d,p,u,n[m+11],22,-1990404162),u=f(u,l,d,p,n[m+12],7,1804603682),p=f(p,u,l,d,n[m+13],12,-40341101),d=f(d,p,u,l,n[m+14],17,-1502002290),u=v(u,l=f(l,d,p,u,n[m+15],22,1236535329),d,p,n[m+1],5,-165796510),p=v(p,u,l,d,n[m+6],9,-1069501632),d=v(d,p,u,l,n[m+11],14,643717713),l=v(l,d,p,u,n[m+0],20,-373897302),u=v(u,l,d,p,n[m+5],5,-701558691),p=v(p,u,l,d,n[m+10],9,38016083),d=v(d,p,u,l,n[m+15],14,-660478335),l=v(l,d,p,u,n[m+4],20,-405537848),u=v(u,l,d,p,n[m+9],5,568446438),p=v(p,u,l,d,n[m+14],9,-1019803690),d=v(d,p,u,l,n[m+3],14,-187363961),l=v(l,d,p,u,n[m+8],20,1163531501),u=v(u,l,d,p,n[m+13],5,-1444681467),p=v(p,u,l,d,n[m+2],9,-51403784),d=v(d,p,u,l,n[m+7],14,1735328473),u=g(u,l=v(l,d,p,u,n[m+12],20,-1926607734),d,p,n[m+5],4,-378558),p=g(p,u,l,d,n[m+8],11,-2022574463),d=g(d,p,u,l,n[m+11],16,1839030562),l=g(l,d,p,u,n[m+14],23,-35309556),u=g(u,l,d,p,n[m+1],4,-1530992060),p=g(p,u,l,d,n[m+4],11,1272893353),d=g(d,p,u,l,n[m+7],16,-155497632),l=g(l,d,p,u,n[m+10],23,-1094730640),u=g(u,l,d,p,n[m+13],4,681279174),p=g(p,u,l,d,n[m+0],11,-358537222),d=g(d,p,u,l,n[m+3],16,-722521979),l=g(l,d,p,u,n[m+6],23,76029189),u=g(u,l,d,p,n[m+9],4,-640364487),p=g(p,u,l,d,n[m+12],11,-421815835),d=g(d,p,u,l,n[m+15],16,530742520),u=b(u,l=g(l,d,p,u,n[m+2],23,-995338651),d,p,n[m+0],6,-198630844),p=b(p,u,l,d,n[m+7],10,1126891415),d=b(d,p,u,l,n[m+14],15,-1416354905),l=b(l,d,p,u,n[m+5],21,-57434055),u=b(u,l,d,p,n[m+12],6,1700485571),p=b(p,u,l,d,n[m+3],10,-1894986606),d=b(d,p,u,l,n[m+10],15,-1051523),l=b(l,d,p,u,n[m+1],21,-2054922799),u=b(u,l,d,p,n[m+8],6,1873313359),p=b(p,u,l,d,n[m+15],10,-30611744),d=b(d,p,u,l,n[m+6],15,-1560198380),l=b(l,d,p,u,n[m+13],21,1309151649),u=b(u,l,d,p,n[m+4],6,-145523070),p=b(p,u,l,d,n[m+11],10,-1120210379),d=b(d,p,u,l,n[m+2],15,718787259),l=b(l,d,p,u,n[m+9],21,-343485551),u=u+h>>>0,l=l+w>>>0,d=d+y>>>0,p=p+T>>>0}return r.endian([u,l,d,p])})._ff=function(e,t,n,r,i,a,o){var s=e+(t&n|~t&r)+(i>>>0)+o;return(s<<a|s>>>32-a)+t},s._gg=function(e,t,n,r,i,a,o){var s=e+(t&r|n&~r)+(i>>>0)+o;return(s<<a|s>>>32-a)+t},s._hh=function(e,t,n,r,i,a,o){var s=e+(t^n^r)+(i>>>0)+o;return(s<<a|s>>>32-a)+t},s._ii=function(e,t,n,r,i,a,o){var s=e+(n^(t|~r))+(i>>>0)+o;return(s<<a|s>>>32-a)+t},s._blocksize=16,s._digestsize=16,e.exports=function(e,t){if(null==e)throw new Error("Illegal argument "+e);var n=r.wordsToBytes(s(e,t));return t&&t.asBytes?n:t&&t.asString?o.bytesToString(n):r.bytesToHex(n)}},2:(e,t,n)=>{"use strict";n.r(t),n.d(t,{Perfume:()=>ze,incrementUjNavigation:()=>Le,markStep:()=>Re,markStepOnce:()=>qe});var r,i,a={isResourceTiming:!1,isElementTiming:!1,maxTime:3e4,reportOptions:{},enableNavigationTracking:!0},o=window,s=o.console,c=o.navigator,u=o.performance,l=function(){return c.deviceMemory},d=function(){return c.hardwareConcurrency},p="mark.",m=function(){return u&&!!u.getEntriesByType&&!!u.now&&!!u.mark},f="4g",v=!1,g={},b={value:0},h={value:{beacon:0,css:0,fetch:0,img:0,other:0,script:0,total:0,xmlhttprequest:0}},w={value:0},y={value:0},T={},k={isHidden:!1,didChange:!1},_=function(){k.isHidden=!1,document.hidden&&(k.isHidden=document.hidden,k.didChange=!0)},S=function(e,t){try{var n=new PerformanceObserver((function(e){t(e.getEntries())}));return n.observe({type:e,buffered:!0}),n}catch(e){s.warn("Perfume.js:",e)}return null},E=function(){return!!(d()&&d()<=4)||!!(l()&&l()<=4)},x=function(e,t){switch(e){case"slow-2g":case"2g":case"3g":return!0;default:return E()||t}},O=function(e){return parseFloat(e.toFixed(4))},j=function(e){return"number"!=typeof e?null:O(e/Math.pow(1024,2))},N=function(e,t,n,r,i){var s,u=function(){a.analyticsTracker&&(k.isHidden&&!["CLS","INP"].includes(e)||a.analyticsTracker({attribution:r,metricName:e,data:t,navigatorInformation:c?{deviceMemory:l()||0,hardwareConcurrency:d()||0,serviceWorkerStatus:"serviceWorker"in c?c.serviceWorker.controller?"controlled":"supported":"unsupported",isLowEndDevice:E(),isLowEndExperience:x(f,v)}:{},rating:n,navigationType:i}))};["CLS","INP"].includes(e)?u():(s=u,"requestIdleCallback"in o?o.requestIdleCallback(s,{timeout:3e3}):s())},I=function(e){e.forEach((function(e){if(!("self"!==e.name||e.startTime<b.value)){var t=e.duration-50;t>0&&(w.value+=t,y.value+=t)}}))};!function(e){e.instant="instant",e.quick="quick",e.moderate="moderate",e.slow="slow",e.unavoidable="unavoidable"}(r||(r={}));var P,M,B,C,D,A=((i={})[r.instant]={vitalsThresholds:[100,200],maxOutlierThreshold:1e4},i[r.quick]={vitalsThresholds:[200,500],maxOutlierThreshold:1e4},i[r.moderate]={vitalsThresholds:[500,1e3],maxOutlierThreshold:1e4},i[r.slow]={vitalsThresholds:[1e3,2e3],maxOutlierThreshold:1e4},i[r.unavoidable]={vitalsThresholds:[2e3,5e3],maxOutlierThreshold:2e4},i),L={RT:[100,200],TBT:[200,600],NTBT:[200,600]},U=function(e,t){return L[e]?t<=L[e][0]?"good":t<=L[e][1]?"needsImprovement":"poor":null},R=function(e,t,n){Object.keys(t).forEach((function(e){"number"==typeof t[e]&&(t[e]=O(t[e]))})),N(e,t,null,n||{})},q=function(e){var t=e.attribution,n=e.name,r=e.rating,i=e.value,o=e.navigationType;"FCP"===n&&(b.value=i),["FCP","LCP"].includes(n)&&!T[0]&&(T[0]=S("longtask",I)),"FID"===n&&setTimeout((function(){k.didChange||(q({attribution:t,name:"TBT",rating:U("TBT",w.value),value:w.value,navigationType:o}),R("dataConsumption",h.value))}),1e4);var s=O(i);s<=a.maxTime&&s>=0&&N(n,s,r,t,o)},F=function(){return window.performance&&performance.getEntriesByType&&performance.getEntriesByType("navigation")[0]},z=function(e){if("loading"===document.readyState)return"loading";var t=F();if(t){if(e<t.domInteractive)return"loading";if(0===t.domContentLoadedEventStart||e<t.domContentLoadedEventStart)return"dom-interactive";if(0===t.domComplete||e<t.domComplete)return"dom-content-loaded"}return"complete"},K=function(e){var t=e.nodeName;return 1===e.nodeType?t.toLowerCase():t.toUpperCase().replace(/^#/,"")},$=function(e,t){var n="";try{for(;e&&9!==e.nodeType;){var r=e,i=r.id?"#"+r.id:K(r)+(r.className&&r.className.length?"."+r.className.replace(/\\s+/g,"."):"");if(n.length+i.length>(t||100)-1)return n||i;if(n=n?i+">"+n:i,r.id)break;e=r.parentNode}}catch(e){}return n},Q=-1,W=function(){return Q},H=function(e){addEventListener("pageshow",(function(t){t.persisted&&(Q=t.timeStamp,e(t))}),!0)},V=function(){var e=F();return e&&e.activationStart||0},J=function(e,t){var n=F(),r="navigate";return W()>=0?r="back-forward-cache":n&&(r=document.prerendering||V()>0?"prerender":document.wasDiscarded?"restore":n.type.replace(/_/g,"-")),{name:e,value:void 0===t?-1:t,rating:"good",delta:0,entries:[],id:"v3-".concat(Date.now(),"-").concat(Math.floor(8999999999999*Math.random())+1e12),navigationType:r}},X=function(e,t,n){try{if(PerformanceObserver.supportedEntryTypes.includes(e)){var r=new PerformanceObserver((function(e){Promise.resolve().then((function(){t(e.getEntries())}))}));return r.observe(Object.assign({type:e,buffered:!0},n||{})),r}}catch(e){}},G=function(e,t){var n=function n(r){"pagehide"!==r.type&&"hidden"!==document.visibilityState||(e(r),t&&(removeEventListener("visibilitychange",n,!0),removeEventListener("pagehide",n,!0)))};addEventListener("visibilitychange",n,!0),addEventListener("pagehide",n,!0)},Z=function(e,t,n,r){var i,a;return function(o){t.value>=0&&(o||r)&&((a=t.value-(i||0))||void 0===i)&&(i=t.value,t.delta=a,t.rating=function(e,t){return e>t[1]?"poor":e>t[0]?"needs-improvement":"good"}(t.value,n),e(t))}},Y=function(e){requestAnimationFrame((function(){return requestAnimationFrame((function(){return e()}))}))},ee=function(e){document.prerendering?addEventListener("prerenderingchange",(function(){return e()}),!0):e()},te=-1,ne=function(){return"hidden"!==document.visibilityState||document.prerendering?1/0:0},re=function(e){"hidden"===document.visibilityState&&te>-1&&(te="visibilitychange"===e.type?e.timeStamp:0,ae())},ie=function(){addEventListener("visibilitychange",re,!0),addEventListener("prerenderingchange",re,!0)},ae=function(){removeEventListener("visibilitychange",re,!0),removeEventListener("prerenderingchange",re,!0)},oe=function(){return te<0&&(te=ne(),ie(),H((function(){setTimeout((function(){te=ne(),ie()}),0)}))),{get firstHiddenTime(){return te}}},se=function(e,t){t=t||{},ee((function(){var n,r=[1800,3e3],i=oe(),a=J("FCP"),o=X("paint",(function(e){e.forEach((function(e){"first-contentful-paint"===e.name&&(o.disconnect(),e.startTime<i.firstHiddenTime&&(a.value=Math.max(e.startTime-V(),0),a.entries.push(e),n(!0)))}))}));o&&(n=Z(e,a,r,t.reportAllChanges),H((function(i){a=J("FCP"),n=Z(e,a,r,t.reportAllChanges),Y((function(){a.value=performance.now()-i.timeStamp,n(!0)}))})))}))},ce={passive:!0,capture:!0},ue=new Date,le=function(e,t){P||(P=t,M=e,B=new Date,me(removeEventListener),de())},de=function(){if(M>=0&&M<B-ue){var e={entryType:"first-input",name:P.type,target:P.target,cancelable:P.cancelable,startTime:P.timeStamp,processingStart:P.timeStamp+M};C.forEach((function(t){t(e)})),C=[]}},pe=function(e){if(e.cancelable){var t=(e.timeStamp>1e12?new Date:performance.now())-e.timeStamp;"pointerdown"==e.type?function(e,t){var n=function(){le(e,t),i()},r=function(){i()},i=function(){removeEventListener("pointerup",n,ce),removeEventListener("pointercancel",r,ce)};addEventListener("pointerup",n,ce),addEventListener("pointercancel",r,ce)}(t,e):le(t,e)}},me=function(e){["mousedown","keydown","touchstart","pointerdown"].forEach((function(t){return e(t,pe,ce)}))},fe=0,ve=1/0,ge=0,be=function(e){e.forEach((function(e){e.interactionId&&(ve=Math.min(ve,e.interactionId),ge=Math.max(ge,e.interactionId),fe=ge?(ge-ve)/7+1:0)}))},he=function(){return D?fe:performance.interactionCount||0},we=0,ye=function(){return he()-we},Te=[],ke={},_e=function(e){var t=Te[Te.length-1],n=ke[e.interactionId];if(n||Te.length<10||e.duration>t.latency){if(n)n.entries.push(e),n.latency=Math.max(n.latency,e.duration);else{var r={id:e.interactionId,latency:e.duration,entries:[e]};ke[r.id]=r,Te.push(r)}Te.sort((function(e,t){return t.latency-e.latency})),Te.splice(10).forEach((function(e){delete ke[e.id]}))}},Se={},Ee=function e(t){document.prerendering?ee((function(){return e(t)})):"complete"!==document.readyState?addEventListener("load",(function(){return e(t)}),!0):setTimeout(t,0)},xe=function(e,t){t=t||{};var n=[800,1800],r=J("TTFB"),i=Z(e,r,n,t.reportAllChanges);Ee((function(){var a=F();if(a){var o=a.responseStart;if(o<=0||o>performance.now())return;r.value=Math.max(o-V(),0),r.entries=[a],i(!0),H((function(){r=J("TTFB",0),(i=Z(e,r,n,t.reportAllChanges))(!0)}))}}))},Oe=function(e){e.forEach((function(e){e.identifier&&q({attribution:{identifier:e.identifier},name:"ET",rating:null,value:e.startTime})}))},je=function(e){e.forEach((function(e){if(a.isResourceTiming&&R("resourceTiming",e),e.decodedBodySize&&e.initiatorType){var t=e.decodedBodySize/1e3;h.value[e.initiatorType]+=t,h.value.total+=t}}))},Ne=function(){!function(e,t){xe((function(e){!function(e){if(e.entries.length){var t=e.entries[0],n=t.activationStart||0,r=Math.max(t.domainLookupStart-n,0),i=Math.max(t.connectStart-n,0),a=Math.max(t.requestStart-n,0);e.attribution={waitingTime:r,dnsTime:i-r,connectionTime:a-i,requestTime:e.value-a,navigationEntry:t}}else e.attribution={waitingTime:0,dnsTime:0,connectionTime:0,requestTime:0}}(e),function(e){e.value>0&&q(e)}(e)}),t)}(0,a.reportOptions.ttfb),function(e,t){!function(e,t){t=t||{},ee((function(){var e,n=[.1,.25],r=J("CLS"),i=-1,a=0,o=[],s=function(e){i>-1&&function(e){!function(e){if(e.entries.length){var t=e.entries.reduce((function(e,t){return e&&e.value>t.value?e:t}));if(t&&t.sources&&t.sources.length){var n=(r=t.sources).find((function(e){return e.node&&1===e.node.nodeType}))||r[0];if(n)return void(e.attribution={largestShiftTarget:$(n.node),largestShiftTime:t.startTime,largestShiftValue:t.value,largestShiftSource:n,largestShiftEntry:t,loadState:z(t.startTime)})}}var r;e.attribution={}}(e),function(e){q(e)}(e)}(e)},c=function(t){t.forEach((function(t){if(!t.hadRecentInput){var n=o[0],i=o[o.length-1];a&&t.startTime-i.startTime<1e3&&t.startTime-n.startTime<5e3?(a+=t.value,o.push(t)):(a=t.value,o=[t]),a>r.value&&(r.value=a,r.entries=o,e())}}))},u=X("layout-shift",c);u&&(e=Z(s,r,n,t.reportAllChanges),se((function(t){i=t.value,r.value<0&&(r.value=0,e())})),G((function(){c(u.takeRecords()),e(!0)})),H((function(){a=0,i=-1,r=J("CLS",0),e=Z(s,r,n,t.reportAllChanges),Y((function(){return e()}))})))}))}(0,t)}(0,a.reportOptions.cls),function(e,t){se((function(e){!function(e){if(e.entries.length){var t=F(),n=e.entries[e.entries.length-1];if(t){var r=t.activationStart||0,i=Math.max(0,t.responseStart-r);return void(e.attribution={timeToFirstByte:i,firstByteToFCP:e.value-i,loadState:z(e.entries[0].startTime),navigationEntry:t,fcpEntry:n})}}e.attribution={timeToFirstByte:0,firstByteToFCP:e.value,loadState:z(W())}}(e),function(e){q(e)}(e)}),t)}(0,a.reportOptions.fcp),function(e,t){!function(e,t){t=t||{},ee((function(){var n,r=[100,300],i=oe(),a=J("FID"),o=function(e){e.startTime<i.firstHiddenTime&&(a.value=e.processingStart-e.startTime,a.entries.push(e),n(!0))},s=function(e){e.forEach(o)},c=X("first-input",s);n=Z(e,a,r,t.reportAllChanges),c&&G((function(){s(c.takeRecords()),c.disconnect()}),!0),c&&H((function(){var i;a=J("FID"),n=Z(e,a,r,t.reportAllChanges),C=[],M=-1,P=null,me(addEventListener),i=o,C.push(i),de()}))}))}((function(e){!function(e){var t=e.entries[0];e.attribution={eventTarget:$(t.target),eventType:t.name,eventTime:t.startTime,eventEntry:t,loadState:z(t.startTime)}}(e),function(e){q(e)}(e)}),t)}(0,a.reportOptions.fid),function(e,t){!function(e,t){t=t||{},ee((function(){var n,r=[2500,4e3],i=oe(),a=J("LCP"),o=function(e){var t=e[e.length-1];if(t){var r=Math.max(t.startTime-V(),0);r<i.firstHiddenTime&&(a.value=r,a.entries=[t],n())}},s=X("largest-contentful-paint",o);if(s){n=Z(e,a,r,t.reportAllChanges);var c=function(){Se[a.id]||(o(s.takeRecords()),s.disconnect(),Se[a.id]=!0,n(!0))};["keydown","click"].forEach((function(e){addEventListener(e,c,{once:!0,capture:!0})})),G(c,!0),H((function(i){a=J("LCP"),n=Z(e,a,r,t.reportAllChanges),Y((function(){a.value=performance.now()-i.timeStamp,Se[a.id]=!0,n(!0)}))}))}}))}((function(e){!function(e){if(e.entries.length){var t=F();if(t){var n=t.activationStart||0,r=e.entries[e.entries.length-1],i=r.url&&performance.getEntriesByType("resource").filter((function(e){return e.name===r.url}))[0],a=Math.max(0,t.responseStart-n),o=Math.max(a,i?(i.requestStart||i.startTime)-n:0),s=Math.max(o,i?i.responseEnd-n:0),c=Math.max(s,r?r.startTime-n:0),u={element:$(r.element),timeToFirstByte:a,resourceLoadDelay:o-a,resourceLoadTime:s-o,elementRenderDelay:c-s,navigationEntry:t,lcpEntry:r};return r.url&&(u.url=r.url),i&&(u.lcpResourceEntry=i),void(e.attribution=u)}}e.attribution={timeToFirstByte:0,resourceLoadDelay:0,resourceLoadTime:0,elementRenderDelay:e.value}}(e),function(e){q(e)}(e)}),t)}(0,a.reportOptions.lcp),function(e,t){!function(e,t){t=t||{},ee((function(){var n=[200,500];"interactionCount"in performance||D||(D=X("event",be,{type:"event",buffered:!0,durationThreshold:0}));var r,i=J("INP"),a=function(e){e.forEach((function(e){e.interactionId&&_e(e),"first-input"===e.entryType&&!Te.some((function(t){return t.entries.some((function(t){return e.duration===t.duration&&e.startTime===t.startTime}))}))&&_e(e)}));var t,n=(t=Math.min(Te.length-1,Math.floor(ye()/50)),Te[t]);n&&n.latency!==i.value&&(i.value=n.latency,i.entries=n.entries,r())},o=X("event",a,{durationThreshold:t.durationThreshold||40});r=Z(e,i,n,t.reportAllChanges),o&&(o.observe({type:"first-input",buffered:!0}),G((function(){a(o.takeRecords()),i.value<0&&ye()>0&&(i.value=0,i.entries=[]),r(!0)})),H((function(){Te=[],we=he(),i=J("INP"),r=Z(e,i,n,t.reportAllChanges)})))}))}((function(t){!function(e){if(e.entries.length){var t=e.entries.sort((function(e,t){return t.duration-e.duration||t.processingEnd-t.processingStart-(e.processingEnd-e.processingStart)}))[0];e.attribution={eventTarget:$(t.target),eventType:t.name,eventTime:t.startTime,eventEntry:t,loadState:z(t.startTime)}}else e.attribution={}}(t),e(t)}),t)}((function(e){return q(e)}),a.reportOptions.inp),a.isResourceTiming&&S("resource",je),a.isElementTiming&&S("element",Oe)},Ie=function(e){var t="usageDetails"in e?e.usageDetails:{};R("storageEstimate",{quota:j(e.quota),usage:j(e.usage),caches:j(t.caches),indexedDB:j(t.indexedDB),serviceWorker:j(t.serviceWorkerRegistrations)})},Pe={finalMarkToStepsMap:{},startMarkToStepsMap:{},active:{},navigationSteps:{}},Me=function(e){delete Pe.active[e]},Be=function(){return Pe.navigationSteps},Ce=function(e){var t;return null!==(t=Be()[e])&&void 0!==t?t:{}},De=function(e,t,n){var r="step."+e,i=u.getEntriesByName(p+t).length>0;if(u.getEntriesByName(p+n).length>0&&a.steps){var o=A[a.steps[e].threshold],s=o.maxOutlierThreshold,c=o.vitalsThresholds;if(i){var l=u.measure(r,p+t,p+n),d=l.duration;if(d<=s){var m=function(e,t){return e<=t[0]?"good":e<=t[1]?"needsImprovement":"poor"}(d,c);d>=0&&(N("userJourneyStep",d,m,{stepName:e},void 0),u.measure("step.".concat(e,"_vitals_").concat(m),{start:l.startTime+l.duration,end:l.startTime+l.duration,detail:{type:"stepVital",duration:d}}))}}}},Ae=function(){var e=Be(),t=Pe.startMarkToStepsMap,n=Object.keys(e).length;if(0===n)return{};var r={},i=n-1,a=Ce(i);if(Object.keys(a).forEach((function(e){var n,i=null!==(n=t[e])&&void 0!==n?n:[];Object.keys(i).forEach((function(e){r[e]=!0}))})),n>1){var o=Ce(i-1);Object.keys(o).forEach((function(e){var n,i=null!==(n=t[e])&&void 0!==n?n:[];Object.keys(i).forEach((function(e){r[e]=!0}))}))}return r},Le=function(){var e,t=Object.keys(Pe.navigationSteps).length;Pe.navigationSteps[t]={};var n=Ae();null===(e=a.onMarkStep)||void 0===e||e.call(a,"",Object.keys(n))},Ue=function(e){var t,n,r,i,o,s,c;if(Pe.finalMarkToStepsMap[e]){!function(e){var t=Pe.navigationSteps,n=Pe.finalMarkToStepsMap,r=Object.keys(t).length;if(0!==r){var i=r-1,a=Ce(i);if(a&&n[e]){var o=n[e];o&&Object.keys(o).forEach((function(e){if(a[e]){var n=Ce(i)||{};n[e]=!1,t[i]=n}if(r>1){var o=i-1,s=Ce(o);s[e]&&(s[e]=!1,t[o]=s)}}))}}}(e);var u=Pe.finalMarkToStepsMap[e];Object.keys(u).forEach((function(t){var n=u[t];n.forEach(Me),Promise.all(n.map((function(n){return function(e,t,n,r){return new(n||(n=Promise))((function(e,t){function i(e){try{o(r.next(e))}catch(e){t(e)}}function a(e){try{o(r.throw(e))}catch(e){t(e)}}function o(t){var r;t.done?e(t.value):(r=t.value,r instanceof n?r:new n((function(e){e(r)}))).then(i,a)}o((r=r.apply(undefined,[])).next())}))}(0,0,void 0,(function(){return function(e,t){var n,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,r=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}(this,(function(r){switch(r.label){case 0:return[4,De(n,t,e)];case 1:return r.sent(),[2]}}))}))}))).catch((function(){}))}))}else r=e,i=Pe.navigationSteps,o=Object.keys(i).length,(c=Ce(s=(o>0?o:1)-1)||[])[r]=!0,i[s]=c,function(e){var t,n=null!==(t=Pe.startMarkToStepsMap[e])&&void 0!==t?t:[];Object.keys(n).forEach((function(e){Pe.active[e]||(Pe.active[e]=!0)}))}(e);if(a.enableNavigationTracking){var l=Ae();null===(t=a.onMarkStep)||void 0===t||t.call(a,e,Object.keys(l))}else null===(n=a.onMarkStep)||void 0===n||n.call(a,e,Object.keys(Pe.active))},Re=function(e){u.mark(p+e),Ue(e)},qe=function(e){0===u.getEntriesByName(p+e).length&&(u.mark(p+e),Ue(e))},Fe=0,ze=function(){function e(e){if(void 0===e&&(e={}),this.v="9.0.0-rc.3",a.analyticsTracker=e.analyticsTracker,a.isResourceTiming=!!e.resourceTiming,a.isElementTiming=!!e.elementTiming,a.maxTime=e.maxMeasureTime||a.maxTime,a.reportOptions=e.reportOptions||a.reportOptions,a.steps=e.steps,a.onMarkStep=e.onMarkStep,a.enableNavigationTracking=e.enableNavigationTracking,m()){"PerformanceObserver"in o&&Ne(),void 0!==document.hidden&&document.addEventListener("visibilitychange",_);var t=function(){if(!m())return{};var e=u.getEntriesByType("navigation")[0];if(!e)return{};var t=e.responseStart,n=e.responseEnd;return{fetchTime:n-e.fetchStart,workerTime:e.workerStart>0?n-e.workerStart:0,totalTime:n-e.requestStart,downloadTime:n-t,timeToFirstByte:t-e.requestStart,headerSize:e.transferSize-e.encodedBodySize||0,dnsLookupTime:e.domainLookupEnd-e.domainLookupStart,redirectTime:e.redirectEnd-e.redirectStart}}();R("navigationTiming",t),t.redirectTime&&q({attribution:{},name:"RT",rating:U("RT",t.redirectTime),value:t.redirectTime}),R("networkInformation",function(){if("connection"in c){var e=c.connection;return"object"!=typeof e?{}:(f=e.effectiveType,v=!!e.saveData,{downlink:e.downlink,effectiveType:e.effectiveType,rtt:e.rtt,saveData:!!e.saveData})}return{}}()),c&&c.storage&&"function"==typeof c.storage.estimate&&c.storage.estimate().then(Ie),a.steps&&a.steps&&(Pe.startMarkToStepsMap={},Pe.finalMarkToStepsMap={},Pe.active={},Pe.navigationSteps={},Object.entries(a.steps).forEach((function(e){var t,n,r=e[0],i=e[1].marks,a=i[0],o=i[1],s=null!==(n=Pe.startMarkToStepsMap[a])&&void 0!==n?n:{};if(s[r]=!0,Pe.startMarkToStepsMap[a]=s,Pe.finalMarkToStepsMap[o]){var c=Pe.finalMarkToStepsMap[o][a]||[];c.push(r),Pe.finalMarkToStepsMap[o][a]=c}else Pe.finalMarkToStepsMap[o]=((t={})[a]=[r],t)})))}}return e.prototype.start=function(e){m()&&!g[e]&&(g[e]=!0,u.mark("mark_".concat(e,"_start")))},e.prototype.end=function(e,t,n){if(void 0===t&&(t={}),void 0===n&&(n=!0),m()&&g[e]){u.mark("mark_".concat(e,"_end")),delete g[e];var r=function(e){u.measure(e,"mark_".concat(e,"_start"),"mark_".concat(e,"_end"));var t=u.getEntriesByName(e).pop();return t&&"measure"===t.entryType?t.duration:-1}(e);n&&R(e,O(r),t)}},e.prototype.endPaint=function(e,t){var n=this;setTimeout((function(){n.end(e,t)}))},e.prototype.clear=function(e){delete g[e],u.clearMarks&&(u.clearMarks("mark_".concat(e,"_start")),u.clearMarks("mark_".concat(e,"_end")))},e.prototype.markNTBT=function(){var e=this;this.start("ntbt"),y.value=0,clearTimeout(Fe),Fe=setTimeout((function(){e.end("ntbt",{},!1),q({attribution:{},name:"NTBT",rating:U("NTBT",y.value),value:y.value}),y.value=0}),2e3)},e}()},426:(e,t)=>{"use strict";Symbol.for("react.element"),Symbol.for("react.portal"),Symbol.for("react.fragment"),Symbol.for("react.strict_mode"),Symbol.for("react.profiler"),Symbol.for("react.provider"),Symbol.for("react.context"),Symbol.for("react.forward_ref"),Symbol.for("react.suspense"),Symbol.for("react.memo"),Symbol.for("react.lazy"),Symbol.iterator;var n={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},r=Object.assign,i={};function a(e,t,r){this.props=e,this.context=t,this.refs=i,this.updater=r||n}function o(){}function s(e,t,r){this.props=e,this.context=t,this.refs=i,this.updater=r||n}a.prototype.isReactComponent={},a.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},a.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},o.prototype=a.prototype;var c=s.prototype=new o;c.constructor=s,r(c,a.prototype),c.isPureReactComponent=!0;Array.isArray,Object.prototype.hasOwnProperty;var u={current:null};t.useCallback=function(e,t){return u.current.useCallback(e,t)},t.useEffect=function(e,t){return u.current.useEffect(e,t)},t.useRef=function(e){return u.current.useRef(e)}},784:(e,t,n)=>{"use strict";e.exports=n(426)},353:function(e,t,n){var r;!function(i,a){"use strict";var o="function",s="undefined",c="object",u="string",l="major",d="model",p="name",m="type",f="vendor",v="version",g="architecture",b="console",h="mobile",w="tablet",y="smarttv",T="wearable",k="embedded",_="Amazon",S="Apple",E="ASUS",x="BlackBerry",O="Browser",j="Chrome",N="Firefox",I="Google",P="Huawei",M="LG",B="Microsoft",C="Motorola",D="Opera",A="Samsung",L="Sharp",U="Sony",R="Xiaomi",q="Zebra",F="Facebook",z="Chromium OS",K="Mac OS",$=function(e){for(var t={},n=0;n<e.length;n++)t[e[n].toUpperCase()]=e[n];return t},Q=function(e,t){return typeof e===u&&-1!==W(t).indexOf(W(e))},W=function(e){return e.toLowerCase()},H=function(e,t){if(typeof e===u)return e=e.replace(/^\\s\\s*/,""),typeof t===s?e:e.substring(0,350)},V=function(e,t){for(var n,r,i,s,u,l,d=0;d<t.length&&!u;){var p=t[d],m=t[d+1];for(n=r=0;n<p.length&&!u&&p[n];)if(u=p[n++].exec(e))for(i=0;i<m.length;i++)l=u[++r],typeof(s=m[i])===c&&s.length>0?2===s.length?typeof s[1]==o?this[s[0]]=s[1].call(this,l):this[s[0]]=s[1]:3===s.length?typeof s[1]!==o||s[1].exec&&s[1].test?this[s[0]]=l?l.replace(s[1],s[2]):a:this[s[0]]=l?s[1].call(this,l,s[2]):a:4===s.length&&(this[s[0]]=l?s[3].call(this,l.replace(s[1],s[2])):a):this[s]=l||a;d+=2}},J=function(e,t){for(var n in t)if(typeof t[n]===c&&t[n].length>0){for(var r=0;r<t[n].length;r++)if(Q(t[n][r],e))return"?"===n?a:n}else if(Q(t[n],e))return"?"===n?a:n;return e},X={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},G={browser:[[/\\b(?:crmo|crios)\\/([\\w\\.]+)/i],[v,[p,"Chrome"]],[/edg(?:e|ios|a)?\\/([\\w\\.]+)/i],[v,[p,"Edge"]],[/(opera mini)\\/([-\\w\\.]+)/i,/(opera [mobiletab]{3,6})\\b.+version\\/([-\\w\\.]+)/i,/(opera)(?:.+version\\/|[\\/ ]+)([\\w\\.]+)/i],[p,v],[/opios[\\/ ]+([\\w\\.]+)/i],[v,[p,D+" Mini"]],[/\\bopr\\/([\\w\\.]+)/i],[v,[p,D]],[/(kindle)\\/([\\w\\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\\/ ]?([\\w\\.]*)/i,/(avant |iemobile|slim)(?:browser)?[\\/ ]?([\\w\\.]*)/i,/(ba?idubrowser)[\\/ ]?([\\w\\.]+)/i,/(?:ms|\\()(ie) ([\\w\\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|qq|duckduckgo)\\/([-\\w\\.]+)/i,/(heytap|ovi)browser\\/([\\d\\.]+)/i,/(weibo)__([\\d\\.]+)/i],[p,v],[/(?:\\buc? ?browser|(?:juc.+)ucweb)[\\/ ]?([\\w\\.]+)/i],[v,[p,"UC"+O]],[/microm.+\\bqbcore\\/([\\w\\.]+)/i,/\\bqbcore\\/([\\w\\.]+).+microm/i],[v,[p,"WeChat(Win) Desktop"]],[/micromessenger\\/([\\w\\.]+)/i],[v,[p,"WeChat"]],[/konqueror\\/([\\w\\.]+)/i],[v,[p,"Konqueror"]],[/trident.+rv[: ]([\\w\\.]{1,9})\\b.+like gecko/i],[v,[p,"IE"]],[/ya(?:search)?browser\\/([\\w\\.]+)/i],[v,[p,"Yandex"]],[/(avast|avg)\\/([\\w\\.]+)/i],[[p,/(.+)/,"$1 Secure "+O],v],[/\\bfocus\\/([\\w\\.]+)/i],[v,[p,N+" Focus"]],[/\\bopt\\/([\\w\\.]+)/i],[v,[p,D+" Touch"]],[/coc_coc\\w+\\/([\\w\\.]+)/i],[v,[p,"Coc Coc"]],[/dolfin\\/([\\w\\.]+)/i],[v,[p,"Dolphin"]],[/coast\\/([\\w\\.]+)/i],[v,[p,D+" Coast"]],[/miuibrowser\\/([\\w\\.]+)/i],[v,[p,"MIUI "+O]],[/fxios\\/([-\\w\\.]+)/i],[v,[p,N]],[/\\bqihu|(qi?ho?o?|360)browser/i],[[p,"360 "+O]],[/(oculus|samsung|sailfish|huawei)browser\\/([\\w\\.]+)/i],[[p,/(.+)/,"$1 "+O],v],[/(comodo_dragon)\\/([\\w\\.]+)/i],[[p,/_/g," "],v],[/(electron)\\/([\\w\\.]+) safari/i,/(tesla)(?: qtcarbrowser|\\/(20\\d\\d\\.[-\\w\\.]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\\/ ]?([\\w\\.]+)/i],[p,v],[/(metasr)[\\/ ]?([\\w\\.]+)/i,/(lbbrowser)/i,/\\[(linkedin)app\\]/i],[p],[/((?:fban\\/fbios|fb_iab\\/fb4a)(?!.+fbav)|;fbav\\/([\\w\\.]+);)/i],[[p,F],v],[/(kakao(?:talk|story))[\\/ ]([\\w\\.]+)/i,/(naver)\\(.*?(\\d+\\.[\\w\\.]+).*\\)/i,/safari (line)\\/([\\w\\.]+)/i,/\\b(line)\\/([\\w\\.]+)\\/iab/i,/(chromium|instagram)[\\/ ]([-\\w\\.]+)/i],[p,v],[/\\bgsa\\/([\\w\\.]+) .*safari\\//i],[v,[p,"GSA"]],[/musical_ly(?:.+app_?version\\/|_)([\\w\\.]+)/i],[v,[p,"TikTok"]],[/headlesschrome(?:\\/([\\w\\.]+)| )/i],[v,[p,j+" Headless"]],[/ wv\\).+(chrome)\\/([\\w\\.]+)/i],[[p,j+" WebView"],v],[/droid.+ version\\/([\\w\\.]+)\\b.+(?:mobile safari|safari)/i],[v,[p,"Android "+O]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\\/v?([\\w\\.]+)/i],[p,v],[/version\\/([\\w\\.\\,]+) .*mobile\\/\\w+ (safari)/i],[v,[p,"Mobile Safari"]],[/version\\/([\\w(\\.|\\,)]+) .*(mobile ?safari|safari)/i],[v,p],[/webkit.+?(mobile ?safari|safari)(\\/[\\w\\.]+)/i],[p,[v,J,{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\\/([\\w\\.]+)/i],[p,v],[/(navigator|netscape\\d?)\\/([-\\w\\.]+)/i],[[p,"Netscape"],v],[/mobile vr; rv:([\\w\\.]+)\\).+firefox/i],[v,[p,N+" Reality"]],[/ekiohf.+(flow)\\/([\\w\\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\\/ ]?([\\w\\.\\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\\/([-\\w\\.]+)$/i,/(firefox)\\/([\\w\\.]+)/i,/(mozilla)\\/([\\w\\.]+) .+rv\\:.+gecko\\/\\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\\. ]?browser)[-\\/ ]?v?([\\w\\.]+)/i,/(links) \\(([\\w\\.]+)/i,/panasonic;(viera)/i],[p,v],[/(cobalt)\\/([\\w\\.]+)/i],[p,[v,/master.|lts./,""]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\\)]/i],[[g,"amd64"]],[/(ia32(?=;))/i],[[g,W]],[/((?:i[346]|x)86)[;\\)]/i],[[g,"ia32"]],[/\\b(aarch64|arm(v?8e?l?|_?64))\\b/i],[[g,"arm64"]],[/\\b(arm(?:v[67])?ht?n?[fl]p?)\\b/i],[[g,"armhf"]],[/windows (ce|mobile); ppc;/i],[[g,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\\))/i],[[g,/ower/,"",W]],[/(sun4\\w)[;\\)]/i],[[g,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\\))|\\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\\b|pa-risc)/i],[[g,W]]],device:[[/\\b(sch-i[89]0\\d|shw-m380s|sm-[ptx]\\w{2,4}|gt-[pn]\\d{2,4}|sgh-t8[56]9|nexus 10)/i],[d,[f,A],[m,w]],[/\\b((?:s[cgp]h|gt|sm)-\\w+|sc[g-]?[\\d]+a?|galaxy nexus)/i,/samsung[- ]([-\\w]+)/i,/sec-(sgh\\w+)/i],[d,[f,A],[m,h]],[/(?:\\/|\\()(ip(?:hone|od)[\\w, ]*)(?:\\/|;)/i],[d,[f,S],[m,h]],[/\\((ipad);[-\\w\\),; ]+apple/i,/applecoremedia\\/[\\w\\.]+ \\((ipad)/i,/\\b(ipad)\\d\\d?,\\d\\d?[;\\]].+ios/i],[d,[f,S],[m,w]],[/(macintosh);/i],[d,[f,S]],[/\\b(sh-?[altvz]?\\d\\d[a-ekm]?)/i],[d,[f,L],[m,h]],[/\\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\\d{2})\\b(?!.+d\\/s)/i],[d,[f,P],[m,w]],[/(?:huawei|honor)([-\\w ]+)[;\\)]/i,/\\b(nexus 6p|\\w{2,4}e?-[atu]?[ln][\\dx][012359c][adn]?)\\b(?!.+d\\/s)/i],[d,[f,P],[m,h]],[/\\b(poco[\\w ]+)(?: bui|\\))/i,/\\b; (\\w+) build\\/hm\\1/i,/\\b(hm[-_ ]?note?[_ ]?(?:\\d\\w)?) bui/i,/\\b(redmi[\\-_ ]?(?:note|k)?[\\w_ ]+)(?: bui|\\))/i,/\\b(mi[-_ ]?(?:a\\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\\d?\\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\\))/i],[[d,/_/g," "],[f,R],[m,h]],[/\\b(mi[-_ ]?(?:pad)(?:[\\w_ ]+))(?: bui|\\))/i],[[d,/_/g," "],[f,R],[m,w]],[/; (\\w+) bui.+ oppo/i,/\\b(cph[12]\\d{3}|p(?:af|c[al]|d\\w|e[ar])[mt]\\d0|x9007|a101op)\\b/i],[d,[f,"OPPO"],[m,h]],[/vivo (\\w+)(?: bui|\\))/i,/\\b(v[12]\\d{3}\\w?[at])(?: bui|;)/i],[d,[f,"Vivo"],[m,h]],[/\\b(rmx[12]\\d{3})(?: bui|;|\\))/i],[d,[f,"Realme"],[m,h]],[/\\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\\b[\\w ]+build\\//i,/\\bmot(?:orola)?[- ](\\w*)/i,/((?:moto[\\w\\(\\) ]+|xt\\d{3,4}|nexus 6)(?= bui|\\)))/i],[d,[f,C],[m,h]],[/\\b(mz60\\d|xoom[2 ]{0,2}) build\\//i],[d,[f,C],[m,w]],[/((?=lg)?[vl]k\\-?\\d{3}) bui| 3\\.[-\\w; ]{10}lg?-([06cv9]{3,4})/i],[d,[f,M],[m,w]],[/(lm(?:-?f100[nv]?|-[\\w\\.]+)(?= bui|\\))|nexus [45])/i,/\\blg[-e;\\/ ]+((?!browser|netcast|android tv)\\w+)/i,/\\blg-?([\\d\\w]+) bui/i],[d,[f,M],[m,h]],[/(ideatab[-\\w ]+)/i,/lenovo ?(s[56]000[-\\w]+|tab(?:[\\w ]+)|yt[-\\d\\w]{6}|tb[-\\d\\w]{6})/i],[d,[f,"Lenovo"],[m,w]],[/(?:maemo|nokia).*(n900|lumia \\d+)/i,/nokia[-_ ]?([-\\w\\.]*)/i],[[d,/_/g," "],[f,"Nokia"],[m,h]],[/(pixel c)\\b/i],[d,[f,I],[m,w]],[/droid.+; (pixel[\\daxl ]{0,6})(?: bui|\\))/i],[d,[f,I],[m,h]],[/droid.+ (a?\\d[0-2]{2}so|[c-g]\\d{4}|so[-gl]\\w+|xq-a\\w[4-7][12])(?= bui|\\).+chrome\\/(?![1-6]{0,1}\\d\\.))/i],[d,[f,U],[m,h]],[/sony tablet [ps]/i,/\\b(?:sony)?sgp\\w+(?: bui|\\))/i],[[d,"Xperia Tablet"],[f,U],[m,w]],[/ (kb2005|in20[12]5|be20[12][59])\\b/i,/(?:one)?(?:plus)? (a\\d0\\d\\d)(?: b|\\))/i],[d,[f,"OnePlus"],[m,h]],[/(alexa)webm/i,/(kf[a-z]{2}wi|aeo[c-r]{2})( bui|\\))/i,/(kf[a-z]+)( bui|\\)).+silk\\//i],[d,[f,_],[m,w]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\\)).+silk\\//i],[[d,/(.+)/g,"Fire Phone $1"],[f,_],[m,h]],[/(playbook);[-\\w\\),; ]+(rim)/i],[d,f,[m,w]],[/\\b((?:bb[a-f]|st[hv])100-\\d)/i,/\\(bb10; (\\w+)/i],[d,[f,x],[m,h]],[/(?:\\b|asus_)(transfo[prime ]{4,10} \\w+|eeepc|slider \\w+|nexus 7|padfone|p00[cj])/i],[d,[f,E],[m,w]],[/ (z[bes]6[027][012][km][ls]|zenfone \\d\\w?)\\b/i],[d,[f,E],[m,h]],[/(nexus 9)/i],[d,[f,"HTC"],[m,w]],[/(htc)[-;_ ]{1,2}([\\w ]+(?=\\)| bui)|\\w+)/i,/(zte)[- ]([\\w ]+?)(?: bui|\\/|\\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\\.))|sony(?!-bra))[-_ ]?([-\\w]*)/i],[f,[d,/_/g," "],[m,h]],[/droid.+; ([ab][1-7]-?[0178a]\\d\\d?)/i],[d,[f,"Acer"],[m,w]],[/droid.+; (m[1-5] note) bui/i,/\\bmz-([-\\w]{2,})/i],[d,[f,"Meizu"],[m,h]],[/(blackberry|benq|palm(?=\\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[-_ ]?([-\\w]*)/i,/(hp) ([\\w ]+\\w)/i,/(asus)-?(\\w+)/i,/(microsoft); (lumia[\\w ]+)/i,/(lenovo)[-_ ]?([-\\w]+)/i,/(jolla)/i,/(oppo) ?([\\w ]+) bui/i],[f,d,[m,h]],[/(kobo)\\s(ereader|touch)/i,/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\\/([\\w\\.]+)/i,/(nook)[\\w ]+build\\/(\\w+)/i,/(dell) (strea[kpr\\d ]*[\\dko])/i,/(le[- ]+pan)[- ]+(\\w{1,9}) bui/i,/(trinity)[- ]*(t\\d{3}) bui/i,/(gigaset)[- ]+(q\\w{1,9}) bui/i,/(vodafone) ([\\w ]+)(?:\\)| bui)/i],[f,d,[m,w]],[/(surface duo)/i],[d,[f,B],[m,w]],[/droid [\\d\\.]+; (fp\\du?)(?: b|\\))/i],[d,[f,"Fairphone"],[m,h]],[/(u304aa)/i],[d,[f,"AT&T"],[m,h]],[/\\bsie-(\\w*)/i],[d,[f,"Siemens"],[m,h]],[/\\b(rct\\w+) b/i],[d,[f,"RCA"],[m,w]],[/\\b(venue[\\d ]{2,7}) b/i],[d,[f,"Dell"],[m,w]],[/\\b(q(?:mv|ta)\\w+) b/i],[d,[f,"Verizon"],[m,w]],[/\\b(?:barnes[& ]+noble |bn[rt])([\\w\\+ ]*) b/i],[d,[f,"Barnes & Noble"],[m,w]],[/\\b(tm\\d{3}\\w+) b/i],[d,[f,"NuVision"],[m,w]],[/\\b(k88) b/i],[d,[f,"ZTE"],[m,w]],[/\\b(nx\\d{3}j) b/i],[d,[f,"ZTE"],[m,h]],[/\\b(gen\\d{3}) b.+49h/i],[d,[f,"Swiss"],[m,h]],[/\\b(zur\\d{3}) b/i],[d,[f,"Swiss"],[m,w]],[/\\b((zeki)?tb.*\\b) b/i],[d,[f,"Zeki"],[m,w]],[/\\b([yr]\\d{2}) b/i,/\\b(dragon[- ]+touch |dt)(\\w{5}) b/i],[[f,"Dragon Touch"],d,[m,w]],[/\\b(ns-?\\w{0,9}) b/i],[d,[f,"Insignia"],[m,w]],[/\\b((nxa|next)-?\\w{0,9}) b/i],[d,[f,"NextBook"],[m,w]],[/\\b(xtreme\\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[f,"Voice"],d,[m,h]],[/\\b(lvtel\\-)?(v1[12]) b/i],[[f,"LvTel"],d,[m,h]],[/\\b(ph-1) /i],[d,[f,"Essential"],[m,h]],[/\\b(v(100md|700na|7011|917g).*\\b) b/i],[d,[f,"Envizen"],[m,w]],[/\\b(trio[-\\w\\. ]+) b/i],[d,[f,"MachSpeed"],[m,w]],[/\\btu_(1491) b/i],[d,[f,"Rotor"],[m,w]],[/(shield[\\w ]+) b/i],[d,[f,"Nvidia"],[m,w]],[/(sprint) (\\w+)/i],[f,d,[m,h]],[/(kin\\.[onetw]{3})/i],[[d,/\\./g," "],[f,B],[m,h]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\\)/i],[d,[f,q],[m,w]],[/droid.+; (ec30|ps20|tc[2-8]\\d[kx])\\)/i],[d,[f,q],[m,h]],[/smart-tv.+(samsung)/i],[f,[m,y]],[/hbbtv.+maple;(\\d+)/i],[[d,/^/,"SmartTV"],[f,A],[m,y]],[/(nux; netcast.+smarttv|lg (netcast\\.tv-201\\d|android tv))/i],[[f,M],[m,y]],[/(apple) ?tv/i],[f,[d,S+" TV"],[m,y]],[/crkey/i],[[d,j+"cast"],[f,I],[m,y]],[/droid.+aft(\\w)( bui|\\))/i],[d,[f,_],[m,y]],[/\\(dtv[\\);].+(aquos)/i,/(aquos-tv[\\w ]+)\\)/i],[d,[f,L],[m,y]],[/(bravia[\\w ]+)( bui|\\))/i],[d,[f,U],[m,y]],[/(mitv-\\w{5}) bui/i],[d,[f,R],[m,y]],[/Hbbtv.*(technisat) (.*);/i],[f,d,[m,y]],[/\\b(roku)[\\dx]*[\\)\\/]((?:dvp-)?[\\d\\.]*)/i,/hbbtv\\/\\d+\\.\\d+\\.\\d+ +\\([\\w\\+ ]*; *([\\w\\d][^;]*);([^;]*)/i],[[f,H],[d,H],[m,y]],[/\\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\\b/i],[[m,y]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[f,d,[m,b]],[/droid.+; (shield) bui/i],[d,[f,"Nvidia"],[m,b]],[/(playstation [345portablevi]+)/i],[d,[f,U],[m,b]],[/\\b(xbox(?: one)?(?!; xbox))[\\); ]/i],[d,[f,B],[m,b]],[/((pebble))app/i],[f,d,[m,T]],[/(watch)(?: ?os[,\\/]|\\d,\\d\\/)[\\d\\.]+/i],[d,[f,S],[m,T]],[/droid.+; (glass) \\d/i],[d,[f,I],[m,T]],[/droid.+; (wt63?0{2,3})\\)/i],[d,[f,q],[m,T]],[/(quest( 2| pro)?)/i],[d,[f,F],[m,T]],[/(tesla)(?: qtcarbrowser|\\/[-\\w\\.]+)/i],[f,[m,k]],[/(aeobc)\\b/i],[d,[f,_],[m,k]],[/droid .+?; ([^;]+?)(?: bui|\\) applew).+? mobile safari/i],[d,[m,h]],[/droid .+?; ([^;]+?)(?: bui|\\) applew).+?(?! mobile) safari/i],[d,[m,w]],[/\\b((tablet|tab)[;\\/]|focus\\/\\d(?!.+mobile))/i],[[m,w]],[/(phone|mobile(?:[;\\/]| [ \\w\\/\\.]*safari)|pda(?=.+windows ce))/i],[[m,h]],[/(android[-\\w\\. ]{0,9});.+buil/i],[d,[f,"Generic"]]],engine:[[/windows.+ edge\\/([\\w\\.]+)/i],[v,[p,"EdgeHTML"]],[/webkit\\/537\\.36.+chrome\\/(?!27)([\\w\\.]+)/i],[v,[p,"Blink"]],[/(presto)\\/([\\w\\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\\/([\\w\\.]+)/i,/ekioh(flow)\\/([\\w\\.]+)/i,/(khtml|tasman|links)[\\/ ]\\(?([\\w\\.]+)/i,/(icab)[\\/ ]([23]\\.[\\d\\.]+)/i,/\\b(libweb)/i],[p,v],[/rv\\:([\\w\\.]{1,9})\\b.+(gecko)/i],[v,p]],os:[[/microsoft (windows) (vista|xp)/i],[p,v],[/(windows) nt 6\\.2; (arm)/i,/(windows (?:phone(?: os)?|mobile))[\\/ ]?([\\d\\.\\w ]*)/i,/(windows)[\\/ ]?([ntce\\d\\. ]+\\w)(?!.+xbox)/i],[p,[v,J,X]],[/(win(?=3|9|n)|win 9x )([nt\\d\\.]+)/i],[[p,"Windows"],[v,J,X]],[/ip[honead]{2,4}\\b(?:.*os ([\\w]+) like mac|; opera)/i,/ios;fbsv\\/([\\d\\.]+)/i,/cfnetwork\\/.+darwin/i],[[v,/_/g,"."],[p,"iOS"]],[/(mac os x) ?([\\w\\. ]*)/i,/(macintosh|mac_powerpc\\b)(?!.+haiku)/i],[[p,K],[v,/_/g,"."]],[/droid ([\\w\\.]+)\\b.+(android[- ]x86|harmonyos)/i],[v,p],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\\/ ]?([\\w\\.]*)/i,/(blackberry)\\w*\\/([\\w\\.]*)/i,/(tizen|kaios)[\\/ ]([\\w\\.]+)/i,/\\((series40);/i],[p,v],[/\\(bb(10);/i],[v,[p,x]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\\/ ]?([\\w\\.]*)/i],[v,[p,"Symbian"]],[/mozilla\\/[\\d\\.]+ \\((?:mobile|tablet|tv|mobile; [\\w ]+); rv:.+ gecko\\/([\\w\\.]+)/i],[v,[p,N+" OS"]],[/web0s;.+rt(tv)/i,/\\b(?:hp)?wos(?:browser)?\\/([\\w\\.]+)/i],[v,[p,"webOS"]],[/watch(?: ?os[,\\/]|\\d,\\d\\/)([\\d\\.]+)/i],[v,[p,"watchOS"]],[/crkey\\/([\\d\\.]+)/i],[v,[p,j+"cast"]],[/(cros) [\\w]+(?:\\)| ([\\w\\.]+)\\b)/i],[[p,z],v],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\\/(\\d+\\.[\\w\\.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\\);]+)/i,/\\b(joli|palm)\\b ?(?:os)?\\/?([\\w\\.]*)/i,/(mint)[\\/\\(\\) ]?(\\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\\/ ]?(?!chrom|package)([-\\w\\.]*)/i,/(hurd|linux) ?([\\w\\.]*)/i,/(gnu) ?([\\w\\.]*)/i,/\\b([-frentopcghs]{0,5}bsd|dragonfly)[\\/ ]?(?!amd|[ix346]{1,2}86)([\\w\\.]*)/i,/(haiku) (\\w+)/i],[p,v],[/(sunos) ?([\\w\\.\\d]*)/i],[[p,"Solaris"],v],[/((?:open)?solaris)[-\\/ ]?([\\w\\.]*)/i,/(aix) ((\\d)(?=\\.|\\)| )[\\w\\.])*/i,/\\b(beos|os\\/2|amigaos|morphos|openvms|fuchsia|hp-ux|serenityos)/i,/(unix) ?([\\w\\.]*)/i],[p,v]]},Z=function(e,t){if(typeof e===c&&(t=e,e=a),!(this instanceof Z))return new Z(e,t).getResult();var n=typeof i!==s&&i.navigator?i.navigator:a,r=e||(n&&n.userAgent?n.userAgent:""),b=n&&n.userAgentData?n.userAgentData:a,y=t?function(e,t){var n={};for(var r in e)t[r]&&t[r].length%2==0?n[r]=t[r].concat(e[r]):n[r]=e[r];return n}(G,t):G,T=n&&n.userAgent==r;return this.getBrowser=function(){var e,t={};return t[p]=a,t[v]=a,V.call(t,r,y.browser),t[l]=typeof(e=t[v])===u?e.replace(/[^\\d\\.]/g,"").split(".")[0]:a,T&&n&&n.brave&&typeof n.brave.isBrave==o&&(t[p]="Brave"),t},this.getCPU=function(){var e={};return e[g]=a,V.call(e,r,y.cpu),e},this.getDevice=function(){var e={};return e[f]=a,e[d]=a,e[m]=a,V.call(e,r,y.device),T&&!e[m]&&b&&b.mobile&&(e[m]=h),T&&"Macintosh"==e[d]&&n&&typeof n.standalone!==s&&n.maxTouchPoints&&n.maxTouchPoints>2&&(e[d]="iPad",e[m]=w),e},this.getEngine=function(){var e={};return e[p]=a,e[v]=a,V.call(e,r,y.engine),e},this.getOS=function(){var e={};return e[p]=a,e[v]=a,V.call(e,r,y.os),T&&!e[p]&&b&&"Unknown"!=b.platform&&(e[p]=b.platform.replace(/chrome os/i,z).replace(/macos/i,K)),e},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return r},this.setUA=function(e){return r=typeof e===u&&e.length>350?H(e,350):e,this},this.setUA(r),this};Z.VERSION="1.0.35",Z.BROWSER=$([p,v,l]),Z.CPU=$([g]),Z.DEVICE=$([d,f,m,b,h,y,w,T,k]),Z.ENGINE=Z.OS=$([p,v]),typeof t!==s?(e.exports&&(t=e.exports=Z),t.UAParser=Z):n.amdO?(r=function(){return Z}.call(t,n,t,e))===a||(e.exports=r):typeof i!==s&&(i.UAParser=Z);var Y=typeof i!==s&&(i.jQuery||i.Zepto);if(Y&&!Y.ua){var ee=new Z;Y.ua=ee.getResult(),Y.ua.get=function(){return ee.getUA()},Y.ua.set=function(e){ee.setUA(e);var t=ee.getResult();for(var n in t)Y.ua[n]=t[n]}}}("object"==typeof window?window:this)}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var a=t[r]={exports:{}};return e[r].call(a.exports,a,a.exports,n),a.exports}n.amdO={},n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var r={};return(()=>{"use strict";n.r(r),n.d(r,{ActionType:()=>f,AmplitudePlatformName:()=>g,AnalyticsEventImportance:()=>l,AnalyticsQueries:()=>e,AuthStatus:()=>b,ComponentType:()=>m,IThresholdTier:()=>Jt,MetricType:()=>d,PlatformName:()=>v,SessionActions:()=>h,SessionAutomatedEvents:()=>w,SessionRank:()=>y,SubjectType:()=>p,UserTypeCommerce:()=>c,UserTypeInsto:()=>i,UserTypeRetail:()=>t,UserTypeRetailBusinessBanking:()=>s,UserTypeRetailEmployeeInternal:()=>a,UserTypeRetailEmployeePersonal:()=>o,UserTypeWallet:()=>u,automatedEvents:()=>xn,automatedMappingConfig:()=>In,clearMarkEntry:()=>Vn,clearPerformanceMarkEntries:()=>Xn,config:()=>A,createEventConfig:()=>On,createNewSpan:()=>Ln,createNewTrace:()=>Un,device:()=>W,endPerfMark:()=>Jn,exposeExperiment:()=>wn,flushQueue:()=>or,generateUUID:()=>V,getAnalyticsHeaders:()=>sr,getReferrerData:()=>le,getTracingHeaders:()=>An,getTracingId:()=>Dn,getUrlHostname:()=>pe,getUrlParams:()=>me,getUrlPathname:()=>fe,getUserContext:()=>ar,identify:()=>Tn,identifyFlow:()=>xe,identity:()=>H,identityFlow:()=>Se,incrementUjNavigation:()=>an,init:()=>yn,initNextJsTrackPageview:()=>_n,initTrackPageview:()=>kn,isEventKeyFormatValid:()=>we,isSessionEnded:()=>pt,location:()=>re,logEvent:()=>$t,logMetric:()=>Ht,logPageView:()=>on,logTrace:()=>Rn,markNTBT:()=>tn,markStep:()=>nn,markStepOnce:()=>rn,onVisibilityChange:()=>ln,optIn:()=>En,optOut:()=>Sn,perfMark:()=>Wn,persistentData:()=>oe,postMessage:()=>K,recordSessionDuration:()=>pn,removeFromIdentifyFlow:()=>Ee,savePersistentData:()=>st,sendScheduledEvents:()=>Bt,setBreadcrumbs:()=>ie,setConfig:()=>U,setLocation:()=>ae,setPagePath:()=>ve,setPageview:()=>Kt,setPersistentData:()=>se,setSessionStart:()=>dt,setTime:()=>Ue,startPerfMark:()=>Hn,timeStone:()=>Le,useEventLogger:()=>Yn,useLogEventOnMount:()=>tr,usePerformanceMarks:()=>rr});let e=function(e){return e.fbclid="fbclid",e.gclid="gclid",e.msclkid="msclkid",e.ptclid="ptclid",e.ttclid="ttclid",e.utm_source="utm_source",e.utm_medium="utm_medium",e.utm_campaign="utm_campaign",e.utm_term="utm_term",e.utm_content="utm_content",e}({});const t=0,i=1,a=2,o=3,s=4,c=5,u=6;let l=function(e){return e.low="low",e.high="high",e}({}),d=function(e){return e.count="count",e.rate="rate",e.gauge="gauge",e.distribution="distribution",e.histogram="histogram",e}({}),p=function(e){return e.commerce_merchant="commerce_merchant",e.device="device",e.edp_fingerprint_id="edp_fingerprint_id",e.nft_user="nft_user",e.user="user",e.wallet_user="wallet_user",e.uuid="user_uuid",e}({}),m=function(e){return e.unknown="unknown",e.banner="banner",e.button="button",e.card="card",e.chart="chart",e.content_script="content_script",e.dropdown="dropdown",e.link="link",e.page="page",e.modal="modal",e.table="table",e.search_bar="search_bar",e.service_worker="service_worker",e.text="text",e.text_input="text_input",e.tray="tray",e.checkbox="checkbox",e.icon="icon",e}({}),f=function(e){return e.unknown="unknown",e.blur="blur",e.click="click",e.change="change",e.dismiss="dismiss",e.focus="focus",e.hover="hover",e.select="select",e.measurement="measurement",e.move="move",e.process="process",e.render="render",e.scroll="scroll",e.view="view",e.search="search",e.keyPress="keyPress",e}({}),v=function(e){return e.unknown="unknown",e.web="web",e.android="android",e.ios="ios",e.mobile_web="mobile_web",e.tablet_web="tablet_web",e.server="server",e.windows="windows",e.macos="macos",e.extension="extension",e}({}),g=function(e){return e.web="Web",e.ios="iOS",e.android="Android",e}({}),b=function(e){return e[e.notLoggedIn=0]="notLoggedIn",e[e.loggedIn=1]="loggedIn",e}({}),h=function(e){return e.ac="ac",e.af="af",e.ah="ah",e.al="al",e.am="am",e.ar="ar",e.as="as",e}({}),w=function(e){return e.pv="pv",e}({}),y=function(e){return e.xs="xs",e.s="s",e.m="m",e.l="l",e.xl="xl",e.xxl="xxl",e}({});const T="https://analytics-service-dev.cbhq.net",k=3e5,_=5e3,S="analytics-db",E="experiment-exposure-db",x="Analytics SDK:",O=Object.values(e),j="pageview",N="session_duration",I={navigationTiming:{eventName:"perf_navigation_timing"},redirectTime:{eventName:"perf_redirect_time"},RT:{eventName:"perf_redirect_time"},TTFB:{eventName:"perf_time_to_first_byte"},networkInformation:{eventName:"perf_network_information"},storageEstimate:{eventName:"perf_storage_estimate"},FCP:{eventName:"perf_first_contentful_paint"},FID:{eventName:"perf_first_input_delay"},LCP:{eventName:"perf_largest_contentful_paint"},CLS:{eventName:"perf_cumulative_layout_shift"},TBT:{eventName:"perf_total_blocking_time"},NTBT:{eventName:"perf_navigation_total_blocking_time"},INP:{eventName:"perf_interact_to_next_paint"},ET:{eventName:"perf_element_timing"},userJourneyStep:{eventName:"perf_user_journey_step"}},P="1",M="web";function B(){return B=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},B.apply(this,arguments)}const C=/^(https?:\\/\\/)/;function D(e){return{eventsEndpoint:e+"/amp",metricsEndPoint:e+"/metrics",exposureEndpoint:e+"/track-exposures",tracesEndpoint:e+"/traces"}}const A=B({authCookie:"logged_in",amplitudeApiKey:"",batchEventsPeriod:_,batchEventsThreshold:30,batchMetricsPeriod:_,batchMetricsThreshold:30,batchTracesPeriod:_,batchTracesThreshold:30,headers:{},interactionManager:null,isAlwaysAuthed:!1,isProd:!1,isInternalApplication:!1,onError:(e,t)=>{console.error(x,e,t)},platform:v.unknown,projectName:"",ricTimeoutScheduleEvent:1e3,ricTimeoutSetDevice:500,showDebugLogging:!1,trackUserId:!1,version:null,apiEndpoint:T},D(T),{steps:{}}),L=[].reduce(((e,t)=>n=>e(t(n))),(e=>{if(!e.isProd)return e.isInternalApplication?(e.apiEndpoint="https://analytics-service-internal-dev.cbhq.net",B({},e,D(e.apiEndpoint))):e;const t=(e=>e.apiEndpoint?C.test(e.apiEndpoint)?e.apiEndpoint:`https://${e.apiEndpoint}`:e.isInternalApplication?"https://analytics-service-internal.cbhq.net":"https://as.coinbase.com")(e);return B({},e,{apiEndpoint:t},D(t))})),U=e=>{const{batchEventsThreshold:t,batchMetricsThreshold:n,batchTracesThreshold:r}=e,i=[t,n,r];for(const e of i)if((e||0)>30){console.warn("You are setting the threshhold for the batch limit to be greater than 30. This may cause request overload.");break}Object.assign(A,L(e))},R=[v.web,v.mobile_web,v.tablet_web];function q(){return"android"===A.platform}function F(){return"ios"===A.platform}function z(){return R.includes(A.platform)}function K(e){if(z()&&navigator&&"serviceWorker"in navigator&&navigator.serviceWorker.controller)try{navigator.serviceWorker.controller.postMessage(e)}catch(e){e instanceof Error&&A.onError(e)}}var $=n(353),Q=n.n($);const W={amplitudeOSName:null,amplitudeOSVersion:null,amplitudeDeviceModel:null,amplitudePlatform:null,browserName:null,browserMajor:null,osName:null,userAgent:null,width:null,height:null},H={countryCode:null,deviceId:null,device_os:null,isOptOut:!1,languageCode:null,locale:null,jwt:null,session_lcc_id:null,userAgent:null,userId:null},V=e=>e?(e^16*Math.random()>>e/4).toString(16):"10000000-1000-4000-8000-100000000000".replace(/[018]/g,V),J=()=>A.isAlwaysAuthed||!!H.userId,X=()=>{const e={};return H.countryCode&&(e.country_code=H.countryCode),e},G=()=>{const{platform:e}=A;if(e===v.web)switch(!0){case window.matchMedia("(max-width: 560px)").matches:return v.mobile_web;case window.matchMedia("(max-width: 1024px, min-width: 561px)").matches:return v.tablet_web}return e},Z=()=>{var e,t,n,r,i;z()?("requestIdleCallback"in window?window.requestIdleCallback(ne,{timeout:A.ricTimeoutSetDevice}):ne(),W.amplitudePlatform=g.web,W.userAgent=(null==(e=window)||null==(e=e.navigator)?void 0:e.userAgent)||null,ee({height:null!=(t=null==(n=window)?void 0:n.innerHeight)?t:null,width:null!=(r=null==(i=window)?void 0:i.innerWidth)?r:null})):F()?(W.amplitudePlatform=g.ios,W.userAgent=H.userAgent,W.userAgent&&ne()):q()&&(W.userAgent=H.userAgent,W.amplitudePlatform=g.android,W.userAgent&&ne())},Y=e=>{Object.assign(H,e),z()&&K({identity:{isAuthed:!!H.userId,locale:H.locale||null}})},ee=e=>{W.height=e.height,W.width=e.width},te=()=>{U({platform:G()}),z()&&K({config:{platform:A.platform}})},ne=()=>{var e;performance.mark&&performance.mark("ua_parser_start");const t=new(Q())(null!=(e=W.userAgent)?e:"").getResult();W.browserName=t.browser.name||null,W.browserMajor=t.browser.major||null,W.osName=t.os.name||null,W.amplitudeOSName=W.browserName,W.amplitudeOSVersion=W.browserMajor,W.amplitudeDeviceModel=W.osName,K({device:{browserName:W.browserName,osName:W.osName}}),performance.mark&&(performance.mark("ua_parser_end"),performance.measure("ua_parser","ua_parser_start","ua_parser_end"))},re={breadcrumbs:[],initialUAAData:{},pageKey:"",pageKeyRegex:{},pagePath:"",prevPageKey:"",prevPagePath:""};function ie(e){Object.assign(re,{breadcrumbs:e})}function ae(e){Object.assign(re,e)}const oe={eventId:0,sequenceNumber:0,sessionId:0,lastEventTime:0,sessionStart:0,sessionUUID:null,userId:null,ac:0,af:0,ah:0,al:0,am:0,ar:0,as:0,pv:0};function se(e){Object.assign(oe,e)}function ce(){var e,t;return null!=(e=null==(t=document)?void 0:t.referrer)?e:""}function ue(){return ue=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ue.apply(this,arguments)}const le=()=>{const e=ce();if(!e)return{};const t=new URL(e);return t.hostname===pe()?{}:{referrer:e,referring_domain:t.hostname}},de=()=>{const e=new URLSearchParams(me()),t={};return O.forEach((n=>{e.has(n)&&(t[n]=(e.get(n)||"").toLowerCase())})),t},pe=()=>{var e;return(null==(e=window)||null==(e=e.location)?void 0:e.hostname)||""},me=()=>{var e;return(null==(e=window)||null==(e=e.location)?void 0:e.search)||""},fe=()=>{var e;return(null==(e=window)||null==(e=e.location)?void 0:e.pathname)||""},ve=()=>{const e=A.overrideWindowLocation?re.pagePath:fe()+me();e&&e!==re.pagePath&&(e!==re.pagePath&&ge(),re.pagePath=e,re.pageKeyRegex&&Object.keys(re.pageKeyRegex).some((e=>{if(re.pageKeyRegex[e].test(re.pagePath))return re.pageKey=e,!0})))},ge=()=>{if(z()){const e=ce();if(!re.prevPagePath&&e){const t=new URL(e);if(t.hostname===pe())return void(re.prevPagePath=t.pathname)}}re.prevPagePath=re.pagePath,re.prevPageKey=re.pageKey},be=e=>{z()&&Object.assign(e,z()?(Object.keys(re.initialUAAData).length>0||(new URLSearchParams(me()),re.initialUAAData=ue({},(()=>{const e={};return O.forEach((t=>{oe[t]&&(e[t]=oe[t])})),e})(),de(),le())),re.initialUAAData):re.initialUAAData)},he=/^[a-zd]+(_[a-zd]+)*$/;function we(e){return he.test(e)}function ye(){return ye=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ye.apply(this,arguments)}const Te=["action","component_type","component_name","context","logging_id"],ke=["num_non_hardware_accounts","ujs"],_e="ujs_",Se={};function Ee(e){e.forEach((e=>{ke.includes(e)&&delete Se[e]}))}function xe(e){var t;const n=Object.entries(e).reduce(((e,t)=>{const[n,r]=t;return!Te.includes(n)&&ke.includes(n)?we(n)?ye({},e,{[n]:r}):(A.onError(new Error("IdentityFlow property names must have snake case format"),{[n]:r}),e):e}),{});null!=(t=n.ujs)&&t.length&&(n.ujs=n.ujs.map((e=>`${_e}${e}`))),Object.assign(Se,n)}function Oe(){return A.platform!==v.unknown||(A.onError(new Error("SDK platform not initialized")),!1)}const je={eventsQueue:[],eventsScheduled:!1,metricsQueue:[],metricsScheduled:!1,tracesQueue:[],tracesScheduled:!1};function Ne(e){Object.assign(je,e)}const Ie={ac:0,af:0,ah:0,al:0,am:0,ar:0,as:0,pv:0,sqs:0},Pe={ac:20,af:5,ah:1,al:1,am:0,ar:10,as:20},Me={pv:25},Be={xs:0,s:1,m:1,l:2,xl:2,xxl:2},Ce=e=>e<15?y.xs:e<60?y.s:e<240?y.m:e<960?y.l:e<3840?y.xl:y.xxl,De=e=>{Object.assign(Ie,e)};function Ae(){return(new Date).getTime()}const Le={timeStart:Ae(),timeOnPagePath:0,timeOnPageKey:0,prevTimeOnPagePath:0,prevTimeOnPageKey:0,sessionDuration:0,sessionEnd:0,sessionStart:0,prevSessionDuration:0};function Ue(e){Object.assign(Le,e)}const Re=(e,t)=>t.some((t=>e instanceof t));let qe,Fe;const ze=new WeakMap,Ke=new WeakMap,$e=new WeakMap,Qe=new WeakMap,We=new WeakMap;let He={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return Ke.get(e);if("objectStoreNames"===t)return e.objectStoreNames||$e.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Je(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function Ve(e){return"function"==typeof e?(t=e)!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(Fe||(Fe=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(t)?function(...e){return t.apply(Xe(this),e),Je(ze.get(this))}:function(...e){return Je(t.apply(Xe(this),e))}:function(e,...n){const r=t.call(Xe(this),e,...n);return $e.set(r,e.sort?e.sort():[e]),Je(r)}:(e instanceof IDBTransaction&&function(e){if(Ke.has(e))return;const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",a),e.removeEventListener("abort",a)},i=()=>{t(),r()},a=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",a),e.addEventListener("abort",a)}));Ke.set(e,t)}(e),Re(e,qe||(qe=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,He):e);var t}function Je(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("success",i),e.removeEventListener("error",a)},i=()=>{t(Je(e.result)),r()},a=()=>{n(e.error),r()};e.addEventListener("success",i),e.addEventListener("error",a)}));return t.then((t=>{t instanceof IDBCursor&&ze.set(t,e)})).catch((()=>{})),We.set(t,e),t}(e);if(Qe.has(e))return Qe.get(e);const t=Ve(e);return t!==e&&(Qe.set(e,t),We.set(t,e)),t}const Xe=e=>We.get(e),Ge=["get","getKey","getAll","getAllKeys","count"],Ze=["put","add","delete","clear"],Ye=new Map;function et(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(Ye.get(t))return Ye.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,i=Ze.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!i&&!Ge.includes(n))return;const a=async function(e,...t){const a=this.transaction(e,i?"readwrite":"readonly");let o=a.store;return r&&(o=o.index(t.shift())),(await Promise.all([o[n](...t),i&&a.done]))[0]};return Ye.set(t,a),a}var tt;tt=He,He={...tt,get:(e,t,n)=>et(e,t)||tt.get(e,t,n),has:(e,t)=>!!et(e,t)||tt.has(e,t)};const nt={isReady:!1,idbKeyval:null};function rt(e){Object.assign(nt,e)}const it={},at=async e=>{if(!nt.idbKeyval)return Promise.resolve(null);try{return await nt.idbKeyval.get(e)}catch(e){return A.onError(new Error("IndexedDB:Get:InternalError")),Promise.resolve(null)}},ot=async(e,t)=>{if(nt.idbKeyval)try{await nt.idbKeyval.set(e,t)}catch(e){A.onError(new Error("IndexedDB:Set:InternalError"))}},st=()=>{"server"!==A.platform&&(se({sessionStart:Le.sessionStart,ac:Ie.ac,af:Ie.af,ah:Ie.ah,al:Ie.al,am:Ie.am,ar:Ie.ar,as:Ie.as,pv:Ie.pv}),H.userId&&se({userId:H.userId}),ot(S,oe))},ct="rgb(5,177,105)",ut=e=>{const{metricName:t,data:n}=e,r=e.importance||l.low;if(!A.showDebugLogging||!console)return;const i=`%c ${x}`,a=`color:${ct};font-size:11px;`,o=`Importance: ${r}`;console.group(i,a,t,o),n.forEach((e=>{e.event_type?console.log(e.event_type,e):console.log(e)})),console.groupEnd()},lt=e=>{const{metricName:t,data:n}=e,r=e.importance||l.low;if(!A.showDebugLogging||!console)return;const i=`color:${ct};font-size:11px;`,a=`%c ${x}`,o=`Importance: ${r}`;console.log(a,i,t,n,o)},dt=()=>{const e=Ae();oe.sessionId&&oe.lastEventTime&&oe.sessionUUID&&!pt(e)||(oe.sessionId=e,oe.sessionUUID=V(),Ue({sessionStart:e}),lt({metricName:"Started new session:",data:{persistentData:oe,timeStone:Le}})),oe.lastEventTime=e},pt=e=>e-oe.lastEventTime>18e5;function mt(){return mt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},mt.apply(this,arguments)}const ft=e=>{var t;(e=>{switch(e.action){case f.click:Ie.ac+=1;break;case f.focus:Ie.af+=1;break;case f.hover:Ie.ah+=1;break;case f.move:Ie.am+=1;break;case f.scroll:Ie.al+=1;break;case f.search:Ie.ar+=1;break;case f.select:Ie.as+=1}})(t=e),t.event_type!==j?t.event_type===N&&((e=>{if(!e.session_rank)return;const t=e.session_rank;Object.values(h).forEach((e=>{Ie.sqs+=Ie[e]*Pe[e]})),Object.values(w).forEach((e=>{Ie.sqs+=Ie[e]*Me[e]})),Ie.sqs*=Be[t]})(t),Object.assign(t,Ie),De({ac:0,af:0,ah:0,al:0,am:0,ar:0,as:0,pv:0,sqs:0})):Ie.pv+=1;const n=e.event_type;delete e.event_type;const r=e.deviceId?e.deviceId:null,i=e.timestamp;return delete e.timestamp,se({eventId:oe.eventId+1}),se({sequenceNumber:oe.sequenceNumber+1}),dt(),st(),{device_id:H.deviceId||r||null,user_id:H.userId,timestamp:i,event_id:oe.eventId,session_id:oe.sessionId||-1,event_type:n,version_name:A.version||null,platform:W.amplitudePlatform,os_name:W.amplitudeOSName,os_version:W.amplitudeOSVersion,device_model:W.amplitudeDeviceModel,language:H.languageCode,event_properties:mt({},e,{session_uuid:oe.sessionUUID,height:W.height,width:W.width}),user_properties:X(),uuid:V(),library:{name:"@cbhq/client-analytics",version:"10.6.0"},sequence_number:oe.sequenceNumber,user_agent:W.userAgent||H.userAgent}},vt=e=>e.map((e=>ft(e)));function gt(){return gt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},gt.apply(this,arguments)}const bt=e=>e.map((e=>(e=>{const t=e.tags||{},n=gt({authed:J()?"true":"false",platform:A.platform},t,{project_name:A.projectName,version_name:A.version||null});return{metric_name:e.metricName,page_path:e.pagePath||null,value:e.value,tags:n,type:e.metricType}})(e))),ht=e=>0!==je.metricsQueue.length&&(je.metricsQueue.length>=A.batchMetricsThreshold||(je.metricsScheduled||(je.metricsScheduled=!0,setTimeout((()=>{je.metricsScheduled=!1,e(bt(je.metricsQueue)),je.metricsQueue=[]}),A.batchMetricsPeriod)),!1)),wt=e=>0!==je.tracesQueue.length&&(je.tracesQueue.length>=A.batchTracesThreshold||(je.tracesScheduled||(je.tracesScheduled=!0,setTimeout((()=>{je.tracesScheduled=!1,e(je.tracesQueue),je.tracesQueue=[]}),A.batchTracesPeriod)),!1)),yt=e=>{var t;z()&&null!=(t=window)&&t.requestIdleCallback?window.requestIdleCallback(e,{timeout:A.ricTimeoutScheduleEvent}):(q()||F())&&A.interactionManager?A.interactionManager.runAfterInteractions(e):e()};function Tt(){return Tt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Tt.apply(this,arguments)}const kt="application/x-www-form-urlencoded; charset=UTF-8",_t=e=>{const{data:t,importance:n,isJSON:r,onError:i,url:a}=e,o=r?"application/json":kt,s=n||l.low,c=r?JSON.stringify(t):new URLSearchParams(t).toString();function u(){const e=new XMLHttpRequest;e.open("POST",a,!0),Object.keys(A.headers||{}).forEach((t=>{e.setRequestHeader(t,A.headers[t])})),e.setRequestHeader("Content-Type",kt),H.jwt&&e.setRequestHeader("authorization",`Bearer ${H.jwt}`),e.send(c)}if(!z()||r||!("sendBeacon"in navigator)||s!==l.low||A.headers&&0!==Object.keys(A.headers).length)if(z()&&!r)u();else{const e=Tt({},A.headers,{"Content-Type":o});H.jwt&&(e.Authorization=`Bearer ${H.jwt}`),fetch(a,{method:"POST",mode:"no-cors",headers:e,body:c}).catch((e=>{i(e,{context:"AnalyticsSDKApiError"})}))}else{const e=new Blob([c],{type:kt});try{navigator.sendBeacon.bind(navigator)(a,e)||u()}catch(e){console.error(e),u()}}};var St=n(762),Et=n.n(St);const xt=(e,t,n)=>{const r=e||"";return Et()("2"+r+t+n)};function Ot(){return Ot=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ot.apply(this,arguments)}class jt extends Error{constructor(e){super(e),this.name="CircularJsonReference",this.message=e,"function"==typeof Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error(e).stack}}class Nt extends jt{constructor(...e){super(...e),this.name="DomReferenceInAnalyticsEvent"}}function It(){return It=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},It.apply(this,arguments)}const Pt=(e,t=l.low)=>{var n;e&&je.eventsQueue.push(e),nt.isReady&&(!A.trackUserId||H.userId?(t===l.high||(n=Mt,0!==je.eventsQueue.length&&(je.eventsQueue.length>=A.batchEventsThreshold||(je.eventsScheduled||(je.eventsScheduled=!0,setTimeout((()=>{je.eventsScheduled=!1,n(vt(je.eventsQueue)),je.eventsQueue=[]}),A.batchEventsPeriod)),0))))&&Bt():je.eventsQueue.length>10&&(A.trackUserId=!1,A.onError(new Error("userId not set in Logged-in"))))},Mt=(e,t=l.low)=>{if(H.isOptOut||0===e.length)return;let n;try{n=JSON.stringify(e)}catch(t){const r=e.map((e=>e.event_type)).join(", "),[i,a]=(e=>{try{const n=[];for(const r of e){const e=Ot({},r);r.event_properties&&(e.event_properties=Ot({},e.event_properties,{currentTarget:null,target:null,relatedTarget:null,_dispatchInstances:null,_targetInst:null,view:(t=r.event_properties.view,["string","number","boolean"].includes(typeof t)?r.event_properties.view:null)})),n.push(e)}return[!0,JSON.stringify(n)]}catch(e){return[!1,""]}var t})(e);if(!i)return void A.onError(new jt(t instanceof Error?t.message:"unknown"),{listEventType:r});n=a,A.onError(new Nt("Found DOM element reference"),{listEventType:r,stringifiedEventData:n})}const r=Ae().toString(),i=It({},{e:n,v:"2",upload_time:r},{client:A.amplitudeApiKey,checksum:xt(A.amplitudeApiKey,n,r)});_t({url:A.eventsEndpoint,data:i,importance:t,onError:A.onError}),ut({metricName:"Batch Events",data:e,importance:t})},Bt=()=>{Mt(vt(je.eventsQueue)),Ne({eventsQueue:[]})};function Ct(){return Ct=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ct.apply(this,arguments)}const Dt=Object.values(f),At=Object.values(m),Lt=e=>Dt.includes(e)?e:f.unknown,Ut=e=>At.includes(e)?e:m.unknown,Rt=(e,t,n)=>{const r={auth:J()?b.loggedIn:b.notLoggedIn,action:Lt(e),component_type:Ut(t),logging_id:n,platform:A.platform,project_name:A.projectName};return"number"==typeof H.userTypeEnum&&(r.user_type_enum=H.userTypeEnum),r},qt=e=>{const t=Ae();if(!e)return A.onError(new Error("missing logData")),Ct({},Rt(f.unknown,m.unknown),{locale:H.locale,session_lcc_id:H.session_lcc_id,timestamp:t,time_start:Le.timeStart});const n=Ct({},e,Rt(e.action,e.componentType,e.loggingId),{locale:H.locale,session_lcc_id:H.session_lcc_id,timestamp:t,time_start:Le.timeStart});return delete n.componentType,delete n.loggingId,n},Ft={blacklistRegex:[],isEnabled:!1};function zt(){return{page_key:re.pageKey,page_path:re.pagePath,prev_page_key:re.prevPageKey,prev_page_path:re.prevPagePath}}function Kt(e){Object.assign(Ft,e)}function $t(e,t,n=l.low){if(H.isOptOut)return;if(!Oe())return;const r=qt(t);!function(e){Ft.isEnabled&&(ve(),Object.assign(e,zt()))}(r),be(r),function(e){Object.keys(Se).length>0&&Object.assign(e,Se)}(r),r.has_double_fired=!1,r.event_type=e,n===l.high?Pt(r,n):yt((()=>{Pt(r)}))}function Qt(e,t=!1){t?_t({url:A.metricsEndPoint,data:{metrics:e},isJSON:!0,onError:A.onError}):yt((()=>{_t({url:A.metricsEndPoint,data:{metrics:e},isJSON:!0,onError:A.onError})})),ut({metricName:"Batch Metrics",data:e})}function Wt(){return Wt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Wt.apply(this,arguments)}function Ht(e){if(!Oe())return;v.server!==A.platform&&!e.pagePath&&re.pagePath&&(e.pagePath=re.pagePath);const t=Object.keys(Se).length?Wt({},e.tags,Se):e.tags;t&&Object.assign(e,{tags:t}),je.metricsQueue.push(e),ht(Qt)&&(Qt(bt(je.metricsQueue)),je.metricsQueue=[])}function Vt(){return Vt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Vt.apply(this,arguments)}let Jt=function(e){return e.instant="instant",e.quick="quick",e.moderate="moderate",e.slow="slow",e.unavoidable="unavoidable",e}({});function Xt(e){return e.toLowerCase()}let Gt={};const Zt=(e,t)=>{null!=A&&A.onMarkStep&&A.onMarkStep(e,t),xe({ujs:t})};let Yt;const en={Perfume:()=>{},markStep:e=>{},markStepOnce:e=>{},incrementUjNavigation:()=>{}},tn=()=>{z()&&Yt&&Yt.markNTBT&&Yt.markNTBT()},nn=e=>{z()&&Yt&&en.markStep&&en.markStep(e)},rn=e=>{z()&&Yt&&en.markStepOnce&&en.markStepOnce(e)},an=()=>{z()&&Yt&&en.incrementUjNavigation&&en.incrementUjNavigation()};function on(e={callMarkNTBT:!0}){"unknown"!==A.platform&&(Ft.blacklistRegex.some((e=>e.test(fe())))||($t(j,{action:f.render,componentType:m.page}),e.callMarkNTBT&&tn()))}let sn=!1,cn=!1;const un=e=>{sn=!e.persisted},ln=(e,t="hidden",n=!1)=>{cn||(addEventListener("pagehide",un),addEventListener("beforeunload",(()=>{})),cn=!0),addEventListener("visibilitychange",(({timeStamp:n})=>{document.visibilityState===t&&e({timeStamp:n,isUnloading:sn})}),{capture:!0,once:n})},dn=36e3;function pn(){const e=pt(Ae());if(e&&(O.forEach((e=>{oe[e]&&delete oe[e]})),st()),!oe.lastEventTime||!Le.sessionStart||!e)return;const t=Math.round((oe.lastEventTime-Le.sessionStart)/1e3);if(t<1||t>dn)return;const n=Ce(t);$t(N,{action:f.measurement,componentType:m.page,session_duration:t,session_end:oe.lastEventTime,session_start:Le.sessionStart,session_rank:n})}function mn(){return mn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},mn.apply(this,arguments)}const fn=[],vn=[],gn=()=>{const e=fn.shift();e&&e()},bn=()=>{const e=vn.shift();e&&e()};let hn={};function wn(e){const t=function(e){return{test_name:e.testName,group_name:e.group,subject_id:e.subjectId,exposed_at:Ae(),subject_type:e.subjectType,platform:A.platform}}(e);hn[e.testName]=hn[e.testName]||0,hn[e.testName]+k>Ae()?lt({metricName:`Event: exposeExperiment ${e.testName} not sent`,data:t}):(hn[e.testName]=Ae(),ot(E,hn),lt({metricName:`Event: exposeExperiment ${e.testName} sent`,data:t}),_t({url:A.exposureEndpoint,data:[t],onError:(t,n)=>{hn[e.testName]=0,ot(E,hn),A.onError(t,n)},isJSON:!0,importance:l.high}))}const yn=e=>{var t,r,i;U(e),z()&&(H.languageCode=(null==(t=navigator)?void 0:t.languages[0])||(null==(r=navigator)?void 0:r.language)||""),te(),(()=>{var e;if(z()&&null!=(e=window)&&e.indexedDB){const e=function(e,t,{blocked:n,upgrade:r,blocking:i,terminated:a}={}){const o=indexedDB.open(e,t),s=Je(o);return r&&o.addEventListener("upgradeneeded",(e=>{r(Je(o.result),e.oldVersion,e.newVersion,Je(o.transaction),e)})),n&&o.addEventListener("blocked",(e=>n(e.oldVersion,e.newVersion,e))),s.then((e=>{a&&e.addEventListener("close",(()=>a())),i&&e.addEventListener("versionchange",(e=>i(e.oldVersion,e.newVersion,e)))})).catch((()=>{})),s}("keyval-store",1,{upgrade(e){e.createObjectStore("keyval")}});rt({idbKeyval:{get:async t=>(await e).get("keyval",t),set:async(t,n)=>(await e).put("keyval",n,t),delete:async t=>(await e).delete("keyval",t),keys:async()=>(await e).getAllKeys("keyval")}})}else rt({idbKeyval:{get:async e=>new Promise((t=>{t(it[e])})),set:async(e,t)=>new Promise((n=>{it[e]=t,n(e)})),delete:async e=>new Promise((()=>{delete it[e]})),keys:async()=>new Promise((e=>{e(Object.keys(it))}))}})})(),lt({metricName:"Initialized Analytics:",data:{deviceId:H.deviceId}}),fn.push((()=>{Pt()})),(async()=>{const e=await at(S);rt({isReady:!0}),gn(),e&&(bn(),se({eventId:e.eventId||oe.eventId,sequenceNumber:e.sequenceNumber||oe.sequenceNumber,sessionId:e.sessionId||oe.sessionId,lastEventTime:e.lastEventTime||oe.lastEventTime,sessionUUID:e.sessionUUID||oe.sessionUUID}),function(e){se(mn({},function(e){const t={};return O.forEach((n=>{e[n]&&(t[n]=e[n])})),t}(e),de()))}(e),Ue({sessionStart:e.sessionStart||oe.sessionStart}),De({ac:e.ac||Ie.ac,af:e.af||Ie.af,ah:e.ah||Ie.ah,al:e.al||Ie.al,am:e.am||Ie.am,ar:e.ar||Ie.ar,as:e.as||Ie.as,pv:e.pv||Ie.pv}),A.trackUserId&&Y({userId:e.userId||H.userId}),pn(),lt({metricName:"Initialized Analytics IndexedDB:",data:e}))})(),async function(){at(E).then((e=>{hn=null!=e?e:{}})).catch((e=>{e instanceof Error&&A.onError(e)}))}(),Z(),z()&&(ln((()=>{se({lastEventTime:Ae()}),st(),Bt()}),"hidden"),ln((()=>{pn()}),"visible")),z()&&(i=()=>{var e,t,n,r;te(),ee({width:null!=(e=null==(t=window)?void 0:t.innerWidth)?e:null,height:null!=(n=null==(r=window)?void 0:r.innerHeight)?n:null})},addEventListener("resize",(()=>{requestAnimationFrame((()=>{i()}))}))),(()=>{if(z())try{const e=n(2);en.markStep=e.markStep,en.markStepOnce=e.markStepOnce,en.incrementUjNavigation=e.incrementUjNavigation,Yt=new e.Perfume({analyticsTracker:e=>{const{data:t,attribution:n,metricName:r,navigatorInformation:i,rating:a}=e,o=I[r],s=(null==n?void 0:n.category)||null;if(!o&&!s)return;const c=(null==i?void 0:i.deviceMemory)||0,u=(null==i?void 0:i.hardwareConcurrency)||0,l=(null==i?void 0:i.isLowEndDevice)||!1,p=(null==i?void 0:i.isLowEndExperience)||!1,v=(null==i?void 0:i.serviceWorkerStatus)||"unsupported",g=Vt({deviceMemory:c,hardwareConcurrency:u,isLowEndDevice:l,isLowEndExperience:p,serviceWorkerStatus:v},Gt),b={is_low_end_device:l,is_low_end_experience:p,page_key:re.pageKey||"",save_data:t.saveData||!1,service_worker:v,is_perf_metric:!0};if("navigationTiming"===r)t&&"number"==typeof t.redirectTime&&Ht({metricName:I.redirectTime.eventName,metricType:d.histogram,tags:b,value:t.redirectTime||0});else if("TTFB"===r)$t(o.eventName,Vt({action:f.measurement,componentType:m.page,duration:t||null,vitalsScore:a||null},g)),Ht({metricName:I.TTFB.eventName,metricType:d.histogram,tags:Vt({},b),value:t}),a&&Ht({metricName:`perf_web_vitals_ttfb_${a}`,metricType:d.count,tags:b,value:1});else if("networkInformation"===r)null!=t&&t.effectiveType&&(Gt=t,$t(o.eventName,{action:f.measurement,componentType:m.page,networkInformationDownlink:t.downlink,networkInformationEffectiveType:t.effectiveType,networkInformationRtt:t.rtt,networkInformationSaveData:t.saveData,navigatorDeviceMemory:c,navigatorHardwareConcurrency:u}));else if("storageEstimate"===r)$t(o.eventName,Vt({action:f.measurement,componentType:m.page},t,g)),Ht({metricName:"perf_storage_estimate_caches",metricType:d.histogram,tags:b,value:t.caches}),Ht({metricName:"perf_storage_estimate_indexed_db",metricType:d.histogram,tags:b,value:t.indexedDB});else if("CLS"===r)$t(o.eventName,Vt({action:f.measurement,componentType:m.page,score:100*t||null,vitalsScore:a||null},g)),a&&Ht({metricName:`perf_web_vitals_cls_${a}`,metricType:d.count,tags:b,value:1});else if("FID"===r){const e=(null==n?void 0:n.performanceEntry)||null,r=parseInt((null==e?void 0:e.processingStart)||"");$t(o.eventName,Vt({action:f.measurement,componentType:m.page,duration:t||null,processingStart:null!=e&&e.processingStart?r:null,startTime:null!=e&&e.startTime?parseInt(e.startTime):null,vitalsScore:a||null},g)),a&&Ht({metricName:`perf_web_vitals_fidVitals_${a}`,metricType:d.count,tags:b,value:1})}else"userJourneyStep"===r?($t("perf_user_journey_step",Vt({action:f.measurement,componentType:m.page,duration:t||null,rating:null!=a?a:null,step_name:(null==n?void 0:n.stepName)||""},g)),Ht({metricName:`user_journey_step.${A.projectName}.${A.platform}.${(null==n?void 0:n.stepName)||""}_vitals_${a}`,metricType:d.count,tags:b,value:1}),Ht({metricName:`user_journey_step.${A.projectName}.${A.platform}.${(null==n?void 0:n.stepName)||""}`,metricType:d.distribution,tags:b,value:t||null})):I[r]&&t&&($t(o.eventName,Vt({action:f.measurement,componentType:m.page,duration:t||null,vitalsScore:a||null},g)),a&&(Ht({metricName:`perf_web_vitals_${Xt(r)}_${a}`,metricType:d.count,tags:b,value:1}),"LCP"===r&&Ht({metricName:`perf_web_vitals_${Xt(r)}`,metricType:d.distribution,tags:b,value:t})))},maxMeasureTime:3e4,steps:A.steps,onMarkStep:Zt})}catch(e){e instanceof Error&&A.onError(e)}})()},Tn=e=>{Y(e),e.userAgent&&Z(),lt({metricName:"Identify:",data:{countryCode:H.countryCode,deviceId:H.deviceId,userId:H.userId}})},kn=({blacklistRegex:e,pageKeyRegex:t,browserHistory:n})=>{Kt({blacklistRegex:e||[],isEnabled:!0}),ae({pageKeyRegex:t}),on({callMarkNTBT:!1}),n.listen((()=>{on()}))},_n=({blacklistRegex:e,pageKeyRegex:t,nextJsRouter:n})=>{Kt({blacklistRegex:e||[],isEnabled:!0}),ae({pageKeyRegex:t}),on({callMarkNTBT:!1}),n.events.on("routeChangeComplete",(()=>{on()}))},Sn=()=>{Y({isOptOut:!0}),ot(S,{})},En=()=>{Y({isOptOut:!1})},xn={Button:{label:"cb_button",uuid:"e921a074-40e6-4371-8700-134d5cd633e6",componentType:m.button}};function On(e,t,n){return{componentName:e,actions:t,data:n}}function jn(){return jn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},jn.apply(this,arguments)}function Nn(e,t,n){const{componentName:r,data:i}=n;$t(e.label,jn({componentType:e.componentType,action:t,loggingId:e.uuid,component_name:r},i))}const In={actionMapping:{onPress:f.click,onHover:f.hover},handlers:{Button:{[f.click]:e=>Nn(xn.Button,f.click,e),[f.hover]:e=>Nn(xn.Button,f.hover,e)}}};function Pn(e,t=!1){t?_t({url:A.tracesEndpoint,data:{traces:e},isJSON:!0,onError:A.onError}):yt((()=>{_t({url:A.tracesEndpoint,data:{traces:e},isJSON:!0,onError:A.onError})})),ut({metricName:"Batch Traces",data:e})}function Mn(){return Mn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Mn.apply(this,arguments)}const Bn=1e6;function Cn(e){return e*Bn}function Dn(e=function(){var e;return null==(e=window)?void 0:e.crypto}()){const t=new Uint32Array(2);return null==e||e.getRandomValues(t),((BigInt(t[0])<<BigInt(32))+BigInt(t[1])).toString()}function An(e,t){return{"x-datadog-origin":"rum","x-datadog-parent-id":t,"x-datadog-sampling-priority":"1","x-datadog-trace-id":e}}function Ln(e){var t;const{name:n,traceId:r,spanId:i,start:a,duration:o,resource:s,meta:c}=e;return{duration:o?Cn(o):0,name:n,resource:s,service:A.projectName,span_id:null!=i?i:Dn(),start:a?Cn(a):0,trace_id:null!=r?r:Dn(),parent_id:P,type:M,meta:Mn({platform:A.platform},re.pageKey?{page_key:re.pageKey}:{},null!=(t=Se.ujs)&&t.length?{last_ujs:Se.ujs[Se.ujs.length-1]}:{},null!=c?c:{})}}function Un(e){return[Ln(e)]}function Rn(e,t){Oe()&&function(e){return e.length>0}(e)&&(t&&function(e,t){e.forEach((e=>function(e,t){const n=Mn({},e.meta,t.meta),r={start:t.start?Cn(t.start):e.start,duration:t.duration?Cn(t.duration):e.duration};Object.assign(e,t,Mn({meta:n},r))}(e,t)))}(e,t),je.tracesQueue.push(e),wt(Pn)&&(Pn(je.tracesQueue),je.tracesQueue=[]))}function qn(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}function Fn(){return Fn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Fn.apply(this,arguments)}function zn(){return void 0!==typeof window&&"performance"in window&&"mark"in performance&&"getEntriesByName"in performance}function Kn(e,t){return`perf_${e}${null!=t&&t.label?`_${t.label}`:""}`}function $n(e,t,n){return`${Kn(e,n)}__${t}`}let Qn={};function Wn(e,t,n){if(!zn())return;const r=$n(e,t,n);if(performance.mark(r),"end"===t){const t=Kn(e,n);!function(e,t,n){try{performance.measure(e,t,n)}catch(e){A.onError(e)}}(t,$n(e,"start",n),r);const i=performance.getEntriesByName(t).pop();i&&Ht(Fn({metricName:e,metricType:d.distribution,value:i.duration},null!=n&&n.tags?{tags:n.tags}:{}))}}function Hn(e,t){if(!zn())return;const n=$n(e,"start",t);Qn[n]||(Wn(e,"start",t),Qn[n]=!0)}function Vn(e,t){const n=$n(e,"start",t),r=function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(Qn,[n].map(qn));Qn=r}function Jn(e,t){if(!zn())return;const n=$n(e,"start",t);Qn[n]&&(Wn(e,"end",t),Vn(e,t))}function Xn(){zn()&&(performance.clearMarks(),Qn={})}var Gn=n(784);function Zn(){return Zn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Zn.apply(this,arguments)}function Yn(e,t,n=l.low){const r=(0,Gn.useRef)(t);return(0,Gn.useEffect)((()=>{r.current=t}),[t]),(0,Gn.useCallback)((t=>{$t(e,Zn({},r.current,t),n)}),[e,n])}function er(){return er=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},er.apply(this,arguments)}function tr(e,t,n=l.low){(0,Gn.useEffect)((()=>{const r=er({},t,{action:f.render});$t(e,r,n)}),[])}function nr(){return nr=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},nr.apply(this,arguments)}const rr=function(e,t){return{markStartPerf:(0,Gn.useCallback)((()=>Hn(e,t)),[e,t]),markEndPerf:(0,Gn.useCallback)((n=>Jn(e,nr({},t,n))),[e,t])}};function ir(){return ir=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ir.apply(this,arguments)}function ar(){return Object.entries(ir({},Se,zt(),{sessionUUID:oe.sessionUUID,userId:oe.userId})).reduce(((e,t)=>{return null!=(n=t[1])&&""!==n?ir({},e,{[t[0]]:t[1]}):e;var n}),{})}async function or(){return new Promise((e=>{Mt(vt(je.eventsQueue)),Qt(bt(je.metricsQueue),!0),Pn(je.tracesQueue,!0),Ne({eventsQueue:[],metricsQueue:[],tracesQueue:[]}),e()}))}function sr(){return{"X-CB-Device-ID":H.deviceId||"unknown","X-CB-Is-Logged-In":H.userId?"true":"false","X-CB-Pagekey":re.pageKey||"unknown","X-CB-UJS":(e=Se.ujs,void 0===e||0===e.length?"":e.join(",")),"X-CB-Platform":A.platform||"unknown","X-CB-Project-Name":A.projectName||"unknown","X-CB-Session-UUID":oe.sessionUUID||"unknown","X-CB-Version-Name":A.version?String(A.version):"unknown"};var e}})(),r})()}));',script.type="text/javascript",document.head.appendChild(script),initCCA(),document.head.removeChild(script),resolve()}catch(_a){initCCA_console.error("Failed to execute inlined telemetry script"),reject()}}),initCCA=()=>{var _a,_b,_c;if("undefined"!=typeof window){const deviceId=null!==(_c=null!==(_a=store.config.get().deviceId)&&void 0!==_a?_a:null===(_b=window.crypto)||void 0===_b?void 0:_b.randomUUID())&&void 0!==_c?_c:"";if(window.ClientAnalytics){const{init,identify,PlatformName}=window.ClientAnalytics;init({isProd:!0,amplitudeApiKey:"c66737ad47ec354ced777935b0af822e",platform:PlatformName.web,projectName:"base_account_sdk",showDebugLogging:!1,version:"1.0.0",apiEndpoint:"https://cca-lite.coinbase.com"}),identify({deviceId}),store.config.set({deviceId})}}},abi=[{inputs:[],stateMutability:"nonpayable",type:"constructor"},{inputs:[{name:"owner",type:"bytes"}],name:"AlreadyOwner",type:"error"},{inputs:[],name:"Initialized",type:"error"},{inputs:[{name:"owner",type:"bytes"}],name:"InvalidEthereumAddressOwner",type:"error"},{inputs:[{name:"key",type:"uint256"}],name:"InvalidNonceKey",type:"error"},{inputs:[{name:"owner",type:"bytes"}],name:"InvalidOwnerBytesLength",type:"error"},{inputs:[],name:"LastOwner",type:"error"},{inputs:[{name:"index",type:"uint256"}],name:"NoOwnerAtIndex",type:"error"},{inputs:[{name:"ownersRemaining",type:"uint256"}],name:"NotLastOwner",type:"error"},{inputs:[{name:"selector",type:"bytes4"}],name:"SelectorNotAllowed",type:"error"},{inputs:[],name:"Unauthorized",type:"error"},{inputs:[],name:"UnauthorizedCallContext",type:"error"},{inputs:[],name:"UpgradeFailed",type:"error"},{inputs:[{name:"index",type:"uint256"},{name:"expectedOwner",type:"bytes"},{name:"actualOwner",type:"bytes"}],name:"WrongOwnerAtIndex",type:"error"},{anonymous:!1,inputs:[{indexed:!0,name:"index",type:"uint256"},{indexed:!1,name:"owner",type:"bytes"}],name:"AddOwner",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"index",type:"uint256"},{indexed:!1,name:"owner",type:"bytes"}],name:"RemoveOwner",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"implementation",type:"address"}],name:"Upgraded",type:"event"},{stateMutability:"payable",type:"fallback"},{inputs:[],name:"REPLAYABLE_NONCE_KEY",outputs:[{name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{name:"owner",type:"address"}],name:"addOwnerAddress",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{name:"x",type:"bytes32"},{name:"y",type:"bytes32"}],name:"addOwnerPublicKey",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{name:"functionSelector",type:"bytes4"}],name:"canSkipChainIdValidation",outputs:[{name:"",type:"bool"}],stateMutability:"pure",type:"function"},{inputs:[],name:"domainSeparator",outputs:[{name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[],name:"eip712Domain",outputs:[{name:"fields",type:"bytes1"},{name:"name",type:"string"},{name:"version",type:"string"},{name:"chainId",type:"uint256"},{name:"verifyingContract",type:"address"},{name:"salt",type:"bytes32"},{name:"extensions",type:"uint256[]"}],stateMutability:"view",type:"function"},{inputs:[],name:"entryPoint",outputs:[{name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{name:"target",type:"address"},{name:"value",type:"uint256"},{name:"data",type:"bytes"}],name:"execute",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{components:[{name:"target",type:"address"},{name:"value",type:"uint256"},{name:"data",type:"bytes"}],name:"calls",type:"tuple[]"}],name:"executeBatch",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{name:"calls",type:"bytes[]"}],name:"executeWithoutChainIdValidation",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{components:[{name:"sender",type:"address"},{name:"nonce",type:"uint256"},{name:"initCode",type:"bytes"},{name:"callData",type:"bytes"},{name:"callGasLimit",type:"uint256"},{name:"verificationGasLimit",type:"uint256"},{name:"preVerificationGas",type:"uint256"},{name:"maxFeePerGas",type:"uint256"},{name:"maxPriorityFeePerGas",type:"uint256"},{name:"paymasterAndData",type:"bytes"},{name:"signature",type:"bytes"}],name:"userOp",type:"tuple"}],name:"getUserOpHashWithoutChainId",outputs:[{name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[],name:"implementation",outputs:[{name:"$",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{name:"owners",type:"bytes[]"}],name:"initialize",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{name:"account",type:"address"}],name:"isOwnerAddress",outputs:[{name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{name:"account",type:"bytes"}],name:"isOwnerBytes",outputs:[{name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{name:"x",type:"bytes32"},{name:"y",type:"bytes32"}],name:"isOwnerPublicKey",outputs:[{name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{name:"hash",type:"bytes32"},{name:"signature",type:"bytes"}],name:"isValidSignature",outputs:[{name:"result",type:"bytes4"}],stateMutability:"view",type:"function"},{inputs:[],name:"nextOwnerIndex",outputs:[{name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{name:"index",type:"uint256"}],name:"ownerAtIndex",outputs:[{name:"",type:"bytes"}],stateMutability:"view",type:"function"},{inputs:[],name:"ownerCount",outputs:[{name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"proxiableUUID",outputs:[{name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[{name:"index",type:"uint256"},{name:"owner",type:"bytes"}],name:"removeLastOwner",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{name:"index",type:"uint256"},{name:"owner",type:"bytes"}],name:"removeOwnerAtIndex",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"removedOwnersCount",outputs:[{name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{name:"hash",type:"bytes32"}],name:"replaySafeHash",outputs:[{name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[{name:"newImplementation",type:"address"},{name:"data",type:"bytes"}],name:"upgradeToAndCall",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{components:[{name:"sender",type:"address"},{name:"nonce",type:"uint256"},{name:"initCode",type:"bytes"},{name:"callData",type:"bytes"},{name:"callGasLimit",type:"uint256"},{name:"verificationGasLimit",type:"uint256"},{name:"preVerificationGas",type:"uint256"},{name:"maxFeePerGas",type:"uint256"},{name:"maxPriorityFeePerGas",type:"uint256"},{name:"paymasterAndData",type:"bytes"},{name:"signature",type:"bytes"}],name:"userOp",type:"tuple"},{name:"userOpHash",type:"bytes32"},{name:"missingAccountFunds",type:"uint256"}],name:"validateUserOp",outputs:[{name:"validationData",type:"uint256"}],stateMutability:"nonpayable",type:"function"},{stateMutability:"payable",type:"receive"}],factoryAbi=[{inputs:[{name:"implementation_",type:"address"}],stateMutability:"payable",type:"constructor"},{inputs:[],name:"OwnerRequired",type:"error"},{inputs:[{name:"owners",type:"bytes[]"},{name:"nonce",type:"uint256"}],name:"createAccount",outputs:[{name:"account",type:"address"}],stateMutability:"payable",type:"function"},{inputs:[{name:"owners",type:"bytes[]"},{name:"nonce",type:"uint256"}],name:"getAddress",outputs:[{name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"implementation",outputs:[{name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"initCodeHash",outputs:[{name:"",type:"bytes32"}],stateMutability:"view",type:"function"}],standardErrorCodes_rpc={invalidInput:-32e3,resourceNotFound:-32001,resourceUnavailable:-32002,transactionRejected:-32003,methodNotSupported:-32004,limitExceeded:-32005,parse:-32700,invalidRequest:-32600,methodNotFound:-32601,invalidParams:-32602,internal:-32603},standardErrorCodes_provider={userRejectedRequest:4001,unauthorized:4100,unsupportedMethod:4200,disconnected:4900,chainDisconnected:4901,unsupportedChain:4902},errorValues={"-32700":{standard:"JSON RPC 2.0",message:"Invalid JSON was received by the server. An error occurred on the server while parsing the JSON text."},"-32600":{standard:"JSON RPC 2.0",message:"The JSON sent is not a valid Request object."},"-32601":{standard:"JSON RPC 2.0",message:"The method does not exist / is not available."},"-32602":{standard:"JSON RPC 2.0",message:"Invalid method parameter(s)."},"-32603":{standard:"JSON RPC 2.0",message:"Internal JSON-RPC error."},"-32000":{standard:"EIP-1474",message:"Invalid input."},"-32001":{standard:"EIP-1474",message:"Resource not found."},"-32002":{standard:"EIP-1474",message:"Resource unavailable."},"-32003":{standard:"EIP-1474",message:"Transaction rejected."},"-32004":{standard:"EIP-1474",message:"Method not supported."},"-32005":{standard:"EIP-1474",message:"Request limit exceeded."},4001:{standard:"EIP-1193",message:"User rejected the request."},4100:{standard:"EIP-1193",message:"The requested account and/or method has not been authorized by the user."},4200:{standard:"EIP-1193",message:"The requested method is not supported by this Ethereum provider."},4900:{standard:"EIP-1193",message:"The provider is disconnected from all chains."},4901:{standard:"EIP-1193",message:"The provider is disconnected from the specified chain."},4902:{standard:"EIP-3085",message:"Unrecognized chain ID."}};function getMessageFromCode(code,fallbackMessage="Unspecified error message."){if(code&&Number.isInteger(code)){const codeString=code.toString();if(hasKey(errorValues,codeString))return errorValues[codeString].message;if(isJsonRpcServerError(code))return"Unspecified server error."}return fallbackMessage}function serialize(error,{shouldIncludeStack=!1}={}){const serialized={};if(error&&"object"==typeof error&&!Array.isArray(error)&&hasKey(error,"code")&&function isValidCode(code){if(!Number.isInteger(code))return!1;const codeString=code.toString();return!!errorValues[codeString]||!!isJsonRpcServerError(code)}(error.code)){const _error=error;serialized.code=_error.code,_error.message&&"string"==typeof _error.message?(serialized.message=_error.message,hasKey(_error,"data")&&(serialized.data=_error.data)):(serialized.message=getMessageFromCode(serialized.code),serialized.data={originalError:assignOriginalError(error)})}else serialized.code=standardErrorCodes_rpc.internal,serialized.message=hasStringProperty(error,"message")?error.message:"Unspecified error message.",serialized.data={originalError:assignOriginalError(error)};return shouldIncludeStack&&(serialized.stack=hasStringProperty(error,"stack")?error.stack:void 0),serialized}function isJsonRpcServerError(code){return code>=-32099&&code<=-32e3}function assignOriginalError(error){return error&&"object"==typeof error&&!Array.isArray(error)?Object.assign({},error):error}function hasKey(obj,key){return Object.prototype.hasOwnProperty.call(obj,key)}function hasStringProperty(obj,prop){return"object"==typeof obj&&null!==obj&&prop in obj&&"string"==typeof obj[prop]}const errors_standardErrors={rpc:{parse:arg=>getEthJsonRpcError(standardErrorCodes_rpc.parse,arg),invalidRequest:arg=>getEthJsonRpcError(standardErrorCodes_rpc.invalidRequest,arg),invalidParams:arg=>getEthJsonRpcError(standardErrorCodes_rpc.invalidParams,arg),methodNotFound:arg=>getEthJsonRpcError(standardErrorCodes_rpc.methodNotFound,arg),internal:arg=>getEthJsonRpcError(standardErrorCodes_rpc.internal,arg),server:opts=>{if(!opts||"object"!=typeof opts||Array.isArray(opts))throw new Error("Ethereum RPC Server errors must provide single object argument.");const{code}=opts;if(!Number.isInteger(code)||code>-32005||code<-32099)throw new Error('"code" must be an integer such that: -32099 <= code <= -32005');return getEthJsonRpcError(code,opts)},invalidInput:arg=>getEthJsonRpcError(standardErrorCodes_rpc.invalidInput,arg),resourceNotFound:arg=>getEthJsonRpcError(standardErrorCodes_rpc.resourceNotFound,arg),resourceUnavailable:arg=>getEthJsonRpcError(standardErrorCodes_rpc.resourceUnavailable,arg),transactionRejected:arg=>getEthJsonRpcError(standardErrorCodes_rpc.transactionRejected,arg),methodNotSupported:arg=>getEthJsonRpcError(standardErrorCodes_rpc.methodNotSupported,arg),limitExceeded:arg=>getEthJsonRpcError(standardErrorCodes_rpc.limitExceeded,arg)},provider:{userRejectedRequest:arg=>getEthProviderError(standardErrorCodes_provider.userRejectedRequest,arg),unauthorized:arg=>getEthProviderError(standardErrorCodes_provider.unauthorized,arg),unsupportedMethod:arg=>getEthProviderError(standardErrorCodes_provider.unsupportedMethod,arg),disconnected:arg=>getEthProviderError(standardErrorCodes_provider.disconnected,arg),chainDisconnected:arg=>getEthProviderError(standardErrorCodes_provider.chainDisconnected,arg),unsupportedChain:arg=>getEthProviderError(standardErrorCodes_provider.unsupportedChain,arg),custom:opts=>{if(!opts||"object"!=typeof opts||Array.isArray(opts))throw new Error("Ethereum Provider custom errors must provide single object argument.");const{code,message,data}=opts;if(!message||"string"!=typeof message)throw new Error('"message" must be a nonempty string');return new EthereumProviderError(code,message,data)}}};function getEthJsonRpcError(code,arg){const[message,data]=parseOpts(arg);return new EthereumRpcError(code,message||getMessageFromCode(code),data)}function getEthProviderError(code,arg){const[message,data]=parseOpts(arg);return new EthereumProviderError(code,message||getMessageFromCode(code),data)}function parseOpts(arg){if(arg){if("string"==typeof arg)return[arg];if("object"==typeof arg&&!Array.isArray(arg)){const{message,data}=arg;if(message&&"string"!=typeof message)throw new Error("Must specify string message.");return[message||void 0,data]}}return[]}class EthereumRpcError extends Error{constructor(code,message,data){if(!Number.isInteger(code))throw new Error('"code" must be an integer.');if(!message||"string"!=typeof message)throw new Error('"message" must be a nonempty string.');super(message),this.code=code,void 0!==data&&(this.data=data)}}class EthereumProviderError extends EthereumRpcError{constructor(code,message,data){if(!function isValidEthProviderCode(code){return Number.isInteger(code)&&code>=1e3&&code<=4999}(code))throw new Error('"code" must be an integer such that: 1000 <= code <= 4999');super(code,message,data)}}function isActionableHttpRequestError(errorObject){return"object"==typeof errorObject&&null!==errorObject&&"code"in errorObject&&"data"in errorObject&&-32090===errorObject.code&&"object"==typeof errorObject.data&&null!==errorObject.data&&"type"in errorObject.data&&"INSUFFICIENT_FUNDS"===errorObject.data.type}function isViemError(error){return"object"==typeof error&&null!==error&&"details"in error}function assertPresence(value,error,message){if(null==value)throw null!=error?error:errors_standardErrors.rpc.invalidParams({message:null!=message?message:"value must be present",data:value})}function assertArrayPresence(value,message){if(!Array.isArray(value))throw errors_standardErrors.rpc.invalidParams({message:null!=message?message:"value must be an array",data:value})}var checkCrossOriginOpenerPolicy_console=__webpack_require__("./node_modules/console-browserify/index.js");const{checkCrossOriginOpenerPolicy,getCrossOriginOpenerPolicy}=(()=>{let crossOriginOpenerPolicy;return{getCrossOriginOpenerPolicy:()=>void 0===crossOriginOpenerPolicy?"undefined":crossOriginOpenerPolicy,checkCrossOriginOpenerPolicy:async()=>{if("undefined"!=typeof window)try{const url=`${window.location.origin}${window.location.pathname}`,response=await fetch(url,{method:"HEAD"});if(!response.ok)throw new Error(`HTTP error! status: ${response.status}`);const result=response.headers.get("Cross-Origin-Opener-Policy");crossOriginOpenerPolicy=null!=result?result:"null","same-origin"===crossOriginOpenerPolicy&&checkCrossOriginOpenerPolicy_console.error("Coinbase Wallet SDK requires the Cross-Origin-Opener-Policy header to not be set to 'same-origin'. This is to ensure that the SDK can communicate with the Coinbase Smart Wallet app.\n\nPlease see https://www.smartwallet.dev/guides/tips/popup-tips#cross-origin-opener-policy for more information.")}catch(error){checkCrossOriginOpenerPolicy_console.error("Error checking Cross-Origin-Opener-Policy:",error.message),crossOriginOpenerPolicy="error"}else crossOriginOpenerPolicy="non-browser-env"}}})();function validateSubAccount(toAccount){if("function"!=typeof toAccount)throw new Error("toAccount is not a function")}async function fetchRPCRequest(request,rpcUrl){const requestBody=Object.assign(Object.assign({},request),{jsonrpc:"2.0",id:crypto.randomUUID()}),res=await window.fetch(rpcUrl,{method:"POST",body:JSON.stringify(requestBody),mode:"cors",headers:{"Content-Type":"application/json","X-Cbw-Sdk-Version":"4.3.6","X-Cbw-Sdk-Platform":NAME}}),{result,error}=await res.json();if(error)throw error;return result}function getCoinbaseInjectedProvider({metadata,preference}){var _a,_b;const{appName,appLogoUrl,appChainIds}=metadata;if("smartWalletOnly"!==preference.options){const extension=function getCoinbaseInjectedLegacyProvider(){return globalThis.coinbaseWalletExtension}();if(extension)return null===(_a=extension.setAppInfo)||void 0===_a||_a.call(extension,appName,appLogoUrl,appChainIds,preference),extension}const ethereum=function getInjectedEthereum(){var _a,_b;try{const window=globalThis;return null!==(_a=window.ethereum)&&void 0!==_a?_a:null===(_b=window.top)||void 0===_b?void 0:_b.ethereum}catch(_c){return}}();if(null==ethereum?void 0:ethereum.isCoinbaseBrowser)return null===(_b=ethereum.setAppInfo)||void 0===_b||_b.call(ethereum,appName,appLogoUrl,appChainIds,preference),ethereum}var ComponentType,ActionType,AnalyticsEventImportance;function logEvent(name,event,importance){var _a,_b,_c,_d;window.ClientAnalytics&&(null===(_a=window.ClientAnalytics)||void 0===_a||_a.logEvent(name,Object.assign(Object.assign({},event),{sdkVersion:"4.3.6",appName:null!==(_c=null===(_b=store.config.get().metadata)||void 0===_b?void 0:_b.appName)&&void 0!==_c?_c:"",appOrigin:window.location.origin,appPreferredSigner:null===(_d=store.config.get().preference)||void 0===_d?void 0:_d.options}),importance))}!function(ComponentType){ComponentType.unknown="unknown",ComponentType.banner="banner",ComponentType.button="button",ComponentType.card="card",ComponentType.chart="chart",ComponentType.content_script="content_script",ComponentType.dropdown="dropdown",ComponentType.link="link",ComponentType.page="page",ComponentType.modal="modal",ComponentType.table="table",ComponentType.search_bar="search_bar",ComponentType.service_worker="service_worker",ComponentType.text="text",ComponentType.text_input="text_input",ComponentType.tray="tray",ComponentType.checkbox="checkbox",ComponentType.icon="icon"}(ComponentType||(ComponentType={})),function(ActionType){ActionType.unknown="unknown",ActionType.blur="blur",ActionType.click="click",ActionType.change="change",ActionType.dismiss="dismiss",ActionType.focus="focus",ActionType.hover="hover",ActionType.select="select",ActionType.measurement="measurement",ActionType.move="move",ActionType.process="process",ActionType.render="render",ActionType.scroll="scroll",ActionType.view="view",ActionType.search="search",ActionType.keyPress="keyPress",ActionType.error="error"}(ActionType||(ActionType={})),function(AnalyticsEventImportance){AnalyticsEventImportance.low="low",AnalyticsEventImportance.high="high"}(AnalyticsEventImportance||(AnalyticsEventImportance={}));const logSnackbarShown=({snackbarContext})=>{logEvent(`snackbar.${snackbarContext}.shown`,{action:ActionType.render,componentType:ComponentType.modal,snackbarContext},AnalyticsEventImportance.high)},logSnackbarActionClicked=({snackbarContext,snackbarAction})=>{logEvent(`snackbar.${snackbarContext}.action_clicked`,{action:ActionType.click,componentType:ComponentType.button,snackbarContext,snackbarAction},AnalyticsEventImportance.high)};function injectCssReset(){const styleEl=document.createElement("style");styleEl.type="text/css",styleEl.appendChild(document.createTextNode('@namespace svg "http://www.w3.org/2000/svg";.-cbwsdk-css-reset,.-cbwsdk-css-reset *{animation:none;animation-delay:0;animation-direction:normal;animation-duration:0;animation-fill-mode:none;animation-iteration-count:1;animation-name:none;animation-play-state:running;animation-timing-function:ease;backface-visibility:visible;background:0;background-attachment:scroll;background-clip:border-box;background-color:rgba(0,0,0,0);background-image:none;background-origin:padding-box;background-position:0 0;background-position-x:0;background-position-y:0;background-repeat:repeat;background-size:auto auto;border:0;border-style:none;border-width:medium;border-color:inherit;border-bottom:0;border-bottom-color:inherit;border-bottom-left-radius:0;border-bottom-right-radius:0;border-bottom-style:none;border-bottom-width:medium;border-collapse:separate;border-image:none;border-left:0;border-left-color:inherit;border-left-style:none;border-left-width:medium;border-radius:0;border-right:0;border-right-color:inherit;border-right-style:none;border-right-width:medium;border-spacing:0;border-top:0;border-top-color:inherit;border-top-left-radius:0;border-top-right-radius:0;border-top-style:none;border-top-width:medium;box-shadow:none;box-sizing:border-box;caption-side:top;clear:none;clip:auto;color:inherit;columns:auto;column-count:auto;column-fill:balance;column-gap:normal;column-rule:medium none currentColor;column-rule-color:currentColor;column-rule-style:none;column-rule-width:none;column-span:1;column-width:auto;counter-increment:none;counter-reset:none;direction:ltr;empty-cells:show;float:none;font:normal;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI","Helvetica Neue",Arial,sans-serif;font-size:medium;font-style:normal;font-variant:normal;font-weight:normal;height:auto;hyphens:none;letter-spacing:normal;line-height:normal;list-style:none;list-style-image:none;list-style-position:outside;list-style-type:disc;margin:0;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;opacity:1;orphans:0;outline:0;outline-color:invert;outline-style:none;outline-width:medium;overflow:visible;overflow-x:visible;overflow-y:visible;padding:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;page-break-after:auto;page-break-before:auto;page-break-inside:auto;perspective:none;perspective-origin:50% 50%;pointer-events:auto;position:static;quotes:"\\201C" "\\201D" "\\2018" "\\2019";tab-size:8;table-layout:auto;text-align:inherit;text-align-last:auto;text-decoration:none;text-decoration-color:inherit;text-decoration-line:none;text-decoration-style:solid;text-indent:0;text-shadow:none;text-transform:none;transform:none;transform-style:flat;transition:none;transition-delay:0s;transition-duration:0s;transition-property:none;transition-timing-function:ease;unicode-bidi:normal;vertical-align:baseline;visibility:visible;white-space:normal;widows:0;word-spacing:normal;z-index:auto}.-cbwsdk-css-reset strong{font-weight:bold}.-cbwsdk-css-reset *{box-sizing:border-box;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI","Helvetica Neue",Arial,sans-serif;line-height:1}.-cbwsdk-css-reset [class*=container]{margin:0;padding:0}.-cbwsdk-css-reset style{display:none}')),document.documentElement.appendChild(styleEl)}function r(e){var t,f,n="";if("string"==typeof e||"number"==typeof e)n+=e;else if("object"==typeof e)if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(f=r(e[t]))&&(n&&(n+=" "),n+=f);else for(t in e)e[t]&&(n&&(n+=" "),n+=t);return n}function clsx(){for(var e,t,f=0,n="";f<arguments.length;)(e=arguments[f++])&&(t=r(e))&&(n&&(n+=" "),n+=t);return n}var n,l,u,i,o,preact_module_r,f,e,c,s,h={},v=[],p=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,y=Array.isArray;function d(n,l){for(var u in l)n[u]=l[u];return n}function w(n){n&&n.parentNode&&n.parentNode.removeChild(n)}function _(l,u,t){var i,o,r,f={};for(r in u)"key"==r?i=u[r]:"ref"==r?o=u[r]:f[r]=u[r];if(arguments.length>2&&(f.children=arguments.length>3?n.call(arguments,2):t),"function"==typeof l&&null!=l.defaultProps)for(r in l.defaultProps)void 0===f[r]&&(f[r]=l.defaultProps[r]);return g(l,f,i,o,null)}function g(n,t,i,o,r){var f={type:n,props:t,key:i,ref:o,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,constructor:void 0,__v:null==r?++u:r,__i:-1,__u:0};return null==r&&null!=l.vnode&&l.vnode(f),f}function b(n){return n.children}function k(n,l){this.props=n,this.context=l}function x(n,l){if(null==l)return n.__?x(n.__,n.__i+1):null;for(var u;l<n.__k.length;l++)if(null!=(u=n.__k[l])&&null!=u.__e)return u.__e;return"function"==typeof n.type?x(n):null}function C(n){var l,u;if(null!=(n=n.__)&&null!=n.__c){for(n.__e=n.__c.base=null,l=0;l<n.__k.length;l++)if(null!=(u=n.__k[l])&&null!=u.__e){n.__e=n.__c.base=u.__e;break}return C(n)}}function M(n){(!n.__d&&(n.__d=!0)&&i.push(n)&&!P.__r++||o!==l.debounceRendering)&&((o=l.debounceRendering)||preact_module_r)(P)}function P(){var n,u,t,o,r,e,c,s;for(i.sort(f);n=i.shift();)n.__d&&(u=i.length,o=void 0,e=(r=(t=n).__v).__e,c=[],s=[],t.__P&&((o=d({},r)).__v=r.__v+1,l.vnode&&l.vnode(o),O(t.__P,o,r,t.__n,t.__P.namespaceURI,32&r.__u?[e]:null,c,null==e?x(r):e,!!(32&r.__u),s),o.__v=r.__v,o.__.__k[o.__i]=o,j(c,o,s),o.__e!=e&&C(o)),i.length>u&&i.sort(f));P.__r=0}function S(n,l,u,t,i,o,r,f,e,c,s){var a,p,y,d,w,_=t&&t.__k||v,g=l.length;for(u.__d=e,$(u,l,_),e=u.__d,a=0;a<g;a++)null!=(y=u.__k[a])&&(p=-1===y.__i?h:_[y.__i]||h,y.__i=a,O(n,y,p,i,o,r,f,e,c,s),d=y.__e,y.ref&&p.ref!=y.ref&&(p.ref&&N(p.ref,null,y),s.push(y.ref,y.__c||d,y)),null==w&&null!=d&&(w=d),65536&y.__u||p.__k===y.__k?e=I(y,e,n):"function"==typeof y.type&&void 0!==y.__d?e=y.__d:d&&(e=d.nextSibling),y.__d=void 0,y.__u&=-196609);u.__d=e,u.__e=w}function $(n,l,u){var t,i,o,r,f,e=l.length,c=u.length,s=c,a=0;for(n.__k=[],t=0;t<e;t++)null!=(i=l[t])&&"boolean"!=typeof i&&"function"!=typeof i?(r=t+a,(i=n.__k[t]="string"==typeof i||"number"==typeof i||"bigint"==typeof i||i.constructor==String?g(null,i,null,null,null):y(i)?g(b,{children:i},null,null,null):void 0===i.constructor&&i.__b>0?g(i.type,i.props,i.key,i.ref?i.ref:null,i.__v):i).__=n,i.__b=n.__b+1,o=null,-1!==(f=i.__i=L(i,u,r,s))&&(s--,(o=u[f])&&(o.__u|=131072)),null==o||null===o.__v?(-1==f&&a--,"function"!=typeof i.type&&(i.__u|=65536)):f!==r&&(f==r-1?a--:f==r+1?a++:(f>r?a--:a++,i.__u|=65536))):i=n.__k[t]=null;if(s)for(t=0;t<c;t++)null!=(o=u[t])&&!(131072&o.__u)&&(o.__e==n.__d&&(n.__d=x(o)),V(o,o))}function I(n,l,u){var t,i;if("function"==typeof n.type){for(t=n.__k,i=0;t&&i<t.length;i++)t[i]&&(t[i].__=n,l=I(t[i],l,u));return l}n.__e!=l&&(l&&n.type&&!u.contains(l)&&(l=x(n)),u.insertBefore(n.__e,l||null),l=n.__e);do{l=l&&l.nextSibling}while(null!=l&&8===l.nodeType);return l}function L(n,l,u,t){var i=n.key,o=n.type,r=u-1,f=u+1,e=l[u];if(null===e||e&&i==e.key&&o===e.type&&!(131072&e.__u))return u;if(t>(null==e||131072&e.__u?0:1))for(;r>=0||f<l.length;){if(r>=0){if((e=l[r])&&!(131072&e.__u)&&i==e.key&&o===e.type)return r;r--}if(f<l.length){if((e=l[f])&&!(131072&e.__u)&&i==e.key&&o===e.type)return f;f++}}return-1}function T(n,l,u){"-"===l[0]?n.setProperty(l,null==u?"":u):n[l]=null==u?"":"number"!=typeof u||p.test(l)?u:u+"px"}function A(n,l,u,t,i){var o;n:if("style"===l)if("string"==typeof u)n.style.cssText=u;else{if("string"==typeof t&&(n.style.cssText=t=""),t)for(l in t)u&&l in u||T(n.style,l,"");if(u)for(l in u)t&&u[l]===t[l]||T(n.style,l,u[l])}else if("o"===l[0]&&"n"===l[1])o=l!==(l=l.replace(/(PointerCapture)$|Capture$/i,"$1")),l=l.toLowerCase()in n||"onFocusOut"===l||"onFocusIn"===l?l.toLowerCase().slice(2):l.slice(2),n.l||(n.l={}),n.l[l+o]=u,u?t?u.u=t.u:(u.u=e,n.addEventListener(l,o?s:c,o)):n.removeEventListener(l,o?s:c,o);else{if("http://www.w3.org/2000/svg"==i)l=l.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if("width"!=l&&"height"!=l&&"href"!=l&&"list"!=l&&"form"!=l&&"tabIndex"!=l&&"download"!=l&&"rowSpan"!=l&&"colSpan"!=l&&"role"!=l&&"popover"!=l&&l in n)try{n[l]=null==u?"":u;break n}catch(n){}"function"==typeof u||(null==u||!1===u&&"-"!==l[4]?n.removeAttribute(l):n.setAttribute(l,"popover"==l&&1==u?"":u))}}function F(n){return function(u){if(this.l){var t=this.l[u.type+n];if(null==u.t)u.t=e++;else if(u.t<t.u)return;return t(l.event?l.event(u):u)}}}function O(n,u,t,i,o,r,f,e,c,s){var a,h,v,p,w,_,g,m,x,C,M,P,$,I,H,L,T=u.type;if(void 0!==u.constructor)return null;128&t.__u&&(c=!!(32&t.__u),r=[e=u.__e=t.__e]),(a=l.__b)&&a(u);n:if("function"==typeof T)try{if(m=u.props,x="prototype"in T&&T.prototype.render,C=(a=T.contextType)&&i[a.__c],M=a?C?C.props.value:a.__:i,t.__c?g=(h=u.__c=t.__c).__=h.__E:(x?u.__c=h=new T(m,M):(u.__c=h=new k(m,M),h.constructor=T,h.render=q),C&&C.sub(h),h.props=m,h.state||(h.state={}),h.context=M,h.__n=i,v=h.__d=!0,h.__h=[],h._sb=[]),x&&null==h.__s&&(h.__s=h.state),x&&null!=T.getDerivedStateFromProps&&(h.__s==h.state&&(h.__s=d({},h.__s)),d(h.__s,T.getDerivedStateFromProps(m,h.__s))),p=h.props,w=h.state,h.__v=u,v)x&&null==T.getDerivedStateFromProps&&null!=h.componentWillMount&&h.componentWillMount(),x&&null!=h.componentDidMount&&h.__h.push(h.componentDidMount);else{if(x&&null==T.getDerivedStateFromProps&&m!==p&&null!=h.componentWillReceiveProps&&h.componentWillReceiveProps(m,M),!h.__e&&(null!=h.shouldComponentUpdate&&!1===h.shouldComponentUpdate(m,h.__s,M)||u.__v===t.__v)){for(u.__v!==t.__v&&(h.props=m,h.state=h.__s,h.__d=!1),u.__e=t.__e,u.__k=t.__k,u.__k.some(function(n){n&&(n.__=u)}),P=0;P<h._sb.length;P++)h.__h.push(h._sb[P]);h._sb=[],h.__h.length&&f.push(h);break n}null!=h.componentWillUpdate&&h.componentWillUpdate(m,h.__s,M),x&&null!=h.componentDidUpdate&&h.__h.push(function(){h.componentDidUpdate(p,w,_)})}if(h.context=M,h.props=m,h.__P=n,h.__e=!1,$=l.__r,I=0,x){for(h.state=h.__s,h.__d=!1,$&&$(u),a=h.render(h.props,h.state,h.context),H=0;H<h._sb.length;H++)h.__h.push(h._sb[H]);h._sb=[]}else do{h.__d=!1,$&&$(u),a=h.render(h.props,h.state,h.context),h.state=h.__s}while(h.__d&&++I<25);h.state=h.__s,null!=h.getChildContext&&(i=d(d({},i),h.getChildContext())),x&&!v&&null!=h.getSnapshotBeforeUpdate&&(_=h.getSnapshotBeforeUpdate(p,w)),S(n,y(L=null!=a&&a.type===b&&null==a.key?a.props.children:a)?L:[L],u,t,i,o,r,f,e,c,s),h.base=u.__e,u.__u&=-161,h.__h.length&&f.push(h),g&&(h.__E=h.__=null)}catch(n){if(u.__v=null,c||null!=r){for(u.__u|=c?160:32;e&&8===e.nodeType&&e.nextSibling;)e=e.nextSibling;r[r.indexOf(e)]=null,u.__e=e}else u.__e=t.__e,u.__k=t.__k;l.__e(n,u,t)}else null==r&&u.__v===t.__v?(u.__k=t.__k,u.__e=t.__e):u.__e=z(t.__e,u,t,i,o,r,f,c,s);(a=l.diffed)&&a(u)}function j(n,u,t){u.__d=void 0;for(var i=0;i<t.length;i++)N(t[i],t[++i],t[++i]);l.__c&&l.__c(u,n),n.some(function(u){try{n=u.__h,u.__h=[],n.some(function(n){n.call(u)})}catch(n){l.__e(n,u.__v)}})}function z(u,t,i,o,r,f,e,c,s){var a,v,p,d,_,g,m,b=i.props,k=t.props,C=t.type;if("svg"===C?r="http://www.w3.org/2000/svg":"math"===C?r="http://www.w3.org/1998/Math/MathML":r||(r="http://www.w3.org/1999/xhtml"),null!=f)for(a=0;a<f.length;a++)if((_=f[a])&&"setAttribute"in _==!!C&&(C?_.localName===C:3===_.nodeType)){u=_,f[a]=null;break}if(null==u){if(null===C)return document.createTextNode(k);u=document.createElementNS(r,C,k.is&&k),c&&(l.__m&&l.__m(t,f),c=!1),f=null}if(null===C)b===k||c&&u.data===k||(u.data=k);else{if(f=f&&n.call(u.childNodes),b=i.props||h,!c&&null!=f)for(b={},a=0;a<u.attributes.length;a++)b[(_=u.attributes[a]).name]=_.value;for(a in b)if(_=b[a],"children"==a);else if("dangerouslySetInnerHTML"==a)p=_;else if(!(a in k)){if("value"==a&&"defaultValue"in k||"checked"==a&&"defaultChecked"in k)continue;A(u,a,null,_,r)}for(a in k)_=k[a],"children"==a?d=_:"dangerouslySetInnerHTML"==a?v=_:"value"==a?g=_:"checked"==a?m=_:c&&"function"!=typeof _||b[a]===_||A(u,a,_,b[a],r);if(v)c||p&&(v.__html===p.__html||v.__html===u.innerHTML)||(u.innerHTML=v.__html),t.__k=[];else if(p&&(u.innerHTML=""),S(u,y(d)?d:[d],t,i,o,"foreignObject"===C?"http://www.w3.org/1999/xhtml":r,f,e,f?f[0]:i.__k&&x(i,0),c,s),null!=f)for(a=f.length;a--;)w(f[a]);c||(a="value","progress"===C&&null==g?u.removeAttribute("value"):void 0!==g&&(g!==u[a]||"progress"===C&&!g||"option"===C&&g!==b[a])&&A(u,a,g,b[a],r),a="checked",void 0!==m&&m!==u[a]&&A(u,a,m,b[a],r))}return u}function N(n,u,t){try{if("function"==typeof n){var i="function"==typeof n.__u;i&&n.__u(),i&&null==u||(n.__u=n(u))}else n.current=u}catch(n){l.__e(n,t)}}function V(n,u,t){var i,o;if(l.unmount&&l.unmount(n),(i=n.ref)&&(i.current&&i.current!==n.__e||N(i,null,u)),null!=(i=n.__c)){if(i.componentWillUnmount)try{i.componentWillUnmount()}catch(n){l.__e(n,u)}i.base=i.__P=null}if(i=n.__k)for(o=0;o<i.length;o++)i[o]&&V(i[o],u,t||"function"!=typeof n.type);t||w(n.__e),n.__c=n.__=n.__e=n.__d=void 0}function q(n,l,u){return this.constructor(n,u)}function B(u,t,i){var o,r,f,e;l.__&&l.__(u,t),r=(o="function"==typeof i)?null:i&&i.__k||t.__k,f=[],e=[],O(t,u=(!o&&i||t).__k=_(b,null,[u]),r||h,h,t.namespaceURI,!o&&i?[i]:r?null:t.firstChild?n.call(t.childNodes):null,f,!o&&i?i:r?r.__e:t.firstChild,o,e),j(f,u,e)}n=v.slice,l={__e:function(n,l,u,t){for(var i,o,r;l=l.__;)if((i=l.__c)&&!i.__)try{if((o=i.constructor)&&null!=o.getDerivedStateFromError&&(i.setState(o.getDerivedStateFromError(n)),r=i.__d),null!=i.componentDidCatch&&(i.componentDidCatch(n,t||{}),r=i.__d),r)return i.__E=i}catch(l){n=l}throw n}},u=0,k.prototype.setState=function(n,l){var u;u=null!=this.__s&&this.__s!==this.state?this.__s:this.__s=d({},this.state),"function"==typeof n&&(n=n(d({},u),this.props)),n&&d(u,n),null!=n&&this.__v&&(l&&this._sb.push(l),M(this))},k.prototype.forceUpdate=function(n){this.__v&&(this.__e=!0,n&&this.__h.push(n),M(this))},k.prototype.render=b,i=[],preact_module_r="function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,f=function(n,l){return n.__v.__b-l.__v.__b},P.__r=0,e=0,c=F(!1),s=F(!0);var hooks_module_t,hooks_module_r,hooks_module_u,hooks_module_i,hooks_module_o=0,hooks_module_f=[],hooks_module_c=l,hooks_module_e=hooks_module_c.__b,hooks_module_a=hooks_module_c.__r,hooks_module_v=hooks_module_c.diffed,hooks_module_l=hooks_module_c.__c,hooks_module_m=hooks_module_c.unmount,hooks_module_s=hooks_module_c.__;function hooks_module_d(n,t){hooks_module_c.__h&&hooks_module_c.__h(hooks_module_r,n,hooks_module_o||t),hooks_module_o=0;var u=hooks_module_r.__H||(hooks_module_r.__H={__:[],__h:[]});return n>=u.__.length&&u.__.push({}),u.__[n]}function hooks_module_h(n){return hooks_module_o=1,function hooks_module_p(n,u,i){var o=hooks_module_d(hooks_module_t++,2);if(o.t=n,!o.__c&&(o.__=[i?i(u):hooks_module_D(void 0,u),function(n){var t=o.__N?o.__N[0]:o.__[0],r=o.t(t,n);t!==r&&(o.__N=[r,o.__[1]],o.__c.setState({}))}],o.__c=hooks_module_r,!hooks_module_r.u)){var f=function(n,t,r){if(!o.__c.__H)return!0;var u=o.__c.__H.__.filter(function(n){return!!n.__c});if(u.every(function(n){return!n.__N}))return!c||c.call(this,n,t,r);var i=!1;return u.forEach(function(n){if(n.__N){var t=n.__[0];n.__=n.__N,n.__N=void 0,t!==n.__[0]&&(i=!0)}}),!(!i&&o.__c.props===n)&&(!c||c.call(this,n,t,r))};hooks_module_r.u=!0;var c=hooks_module_r.shouldComponentUpdate,e=hooks_module_r.componentWillUpdate;hooks_module_r.componentWillUpdate=function(n,t,r){if(this.__e){var u=c;c=void 0,f(n,t,r),c=u}e&&e.call(this,n,t,r)},hooks_module_r.shouldComponentUpdate=f}return o.__N||o.__}(hooks_module_D,n)}function hooks_module_j(){for(var n;n=hooks_module_f.shift();)if(n.__P&&n.__H)try{n.__H.__h.forEach(hooks_module_z),n.__H.__h.forEach(hooks_module_B),n.__H.__h=[]}catch(t){n.__H.__h=[],hooks_module_c.__e(t,n.__v)}}hooks_module_c.__b=function(n){hooks_module_r=null,hooks_module_e&&hooks_module_e(n)},hooks_module_c.__=function(n,t){n&&t.__k&&t.__k.__m&&(n.__m=t.__k.__m),hooks_module_s&&hooks_module_s(n,t)},hooks_module_c.__r=function(n){hooks_module_a&&hooks_module_a(n),hooks_module_t=0;var i=(hooks_module_r=n.__c).__H;i&&(hooks_module_u===hooks_module_r?(i.__h=[],hooks_module_r.__h=[],i.__.forEach(function(n){n.__N&&(n.__=n.__N),n.i=n.__N=void 0})):(i.__h.forEach(hooks_module_z),i.__h.forEach(hooks_module_B),i.__h=[],hooks_module_t=0)),hooks_module_u=hooks_module_r},hooks_module_c.diffed=function(n){hooks_module_v&&hooks_module_v(n);var t=n.__c;t&&t.__H&&(t.__H.__h.length&&(1!==hooks_module_f.push(t)&&hooks_module_i===hooks_module_c.requestAnimationFrame||((hooks_module_i=hooks_module_c.requestAnimationFrame)||hooks_module_w)(hooks_module_j)),t.__H.__.forEach(function(n){n.i&&(n.__H=n.i),n.i=void 0})),hooks_module_u=hooks_module_r=null},hooks_module_c.__c=function(n,t){t.some(function(n){try{n.__h.forEach(hooks_module_z),n.__h=n.__h.filter(function(n){return!n.__||hooks_module_B(n)})}catch(r){t.some(function(n){n.__h&&(n.__h=[])}),t=[],hooks_module_c.__e(r,n.__v)}}),hooks_module_l&&hooks_module_l(n,t)},hooks_module_c.unmount=function(n){hooks_module_m&&hooks_module_m(n);var t,r=n.__c;r&&r.__H&&(r.__H.__.forEach(function(n){try{hooks_module_z(n)}catch(n){t=n}}),r.__H=void 0,t&&hooks_module_c.__e(t,r.__v))};var hooks_module_k="function"==typeof requestAnimationFrame;function hooks_module_w(n){var t,r=function(){clearTimeout(u),hooks_module_k&&cancelAnimationFrame(t),setTimeout(n)},u=setTimeout(r,100);hooks_module_k&&(t=requestAnimationFrame(r))}function hooks_module_z(n){var t=hooks_module_r,u=n.__c;"function"==typeof u&&(n.__c=void 0,u()),hooks_module_r=t}function hooks_module_B(n){var t=hooks_module_r;n.__c=n.__(),hooks_module_r=t}function hooks_module_C(n,t){return!n||n.length!==t.length||t.some(function(t,r){return t!==n[r]})}function hooks_module_D(n,t){return"function"==typeof t?t(n):t}function getLocation(){try{return function isInIFrame(){try{return null!==window.frameElement}catch(_){return!1}}()&&window.top?window.top.location:window.location}catch(_){return window.location}}function isDarkMode(){var _a,_b;return null!==(_b=null===(_a=null===window||void 0===window?void 0:window.matchMedia)||void 0===_a?void 0:_a.call(window,"(prefers-color-scheme: dark)").matches)&&void 0!==_b&&_b}class Snackbar{constructor(){this.items=new Map,this.nextItemKey=0,this.root=null,this.darkMode=isDarkMode()}attach(el){this.root=document.createElement("div"),this.root.className="-cbwsdk-snackbar-root",el.appendChild(this.root),this.render()}presentItem(itemProps){const key=this.nextItemKey++;return this.items.set(key,itemProps),this.render(),()=>{this.items.delete(key),this.render()}}clear(){this.items.clear(),this.render()}render(){this.root&&B(_("div",null,_(SnackbarContainer,{darkMode:this.darkMode},Array.from(this.items.entries()).map(([key,itemProps])=>_(SnackbarInstance,Object.assign({},itemProps,{key}))))),this.root)}}const SnackbarContainer=props=>_("div",{class:clsx("-cbwsdk-snackbar-container")},_("style",null,".-cbwsdk-css-reset .-gear-container{margin-left:16px !important;margin-right:9px !important;display:flex;align-items:center;justify-content:center;width:24px;height:24px;transition:opacity .25s}.-cbwsdk-css-reset .-gear-container *{user-select:none}.-cbwsdk-css-reset .-gear-container svg{opacity:0;position:absolute}.-cbwsdk-css-reset .-gear-icon{height:12px;width:12px;z-index:10000}.-cbwsdk-css-reset .-cbwsdk-snackbar{align-items:flex-end;display:flex;flex-direction:column;position:fixed;right:0;top:0;z-index:2147483647}.-cbwsdk-css-reset .-cbwsdk-snackbar *{user-select:none}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance{display:flex;flex-direction:column;margin:8px 16px 0 16px;overflow:visible;text-align:left;transform:translateX(0);transition:opacity .25s,transform .25s}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-header:hover .-gear-container svg{opacity:1}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-header{display:flex;align-items:center;background:#fff;overflow:hidden;border:1px solid #e7ebee;box-sizing:border-box;border-radius:8px;cursor:pointer}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-header-cblogo{margin:8px 8px 8px 8px}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-header *{cursor:pointer}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-header-message{color:#000;font-size:13px;line-height:1.5;user-select:none}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-menu{background:#fff;transition:opacity .25s ease-in-out,transform .25s linear,visibility 0s;visibility:hidden;border:1px solid #e7ebee;box-sizing:border-box;border-radius:8px;opacity:0;flex-direction:column;padding-left:8px;padding-right:8px}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-menu-item:last-child{margin-bottom:8px !important}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-menu-item:hover{background:#f5f7f8;border-radius:6px;transition:background .25s}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-menu-item:hover span{color:#050f19;transition:color .25s}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-menu-item:hover svg path{fill:#000;transition:fill .25s}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-menu-item{visibility:inherit;height:35px;margin-top:8px;margin-bottom:0;display:flex;flex-direction:row;align-items:center;padding:8px;cursor:pointer}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-menu-item *{visibility:inherit;cursor:pointer}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-menu-item-is-red:hover{background:rgba(223,95,103,.2);transition:background .25s}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-menu-item-is-red:hover *{cursor:pointer}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-menu-item-is-red:hover svg path{fill:#df5f67;transition:fill .25s}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-menu-item-is-red:hover span{color:#df5f67;transition:color .25s}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-menu-item-info{color:#aaa;font-size:13px;margin:0 8px 0 32px;position:absolute}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-hidden{opacity:0;text-align:left;transform:translateX(25%);transition:opacity .5s linear}.-cbwsdk-css-reset .-cbwsdk-snackbar-instance-expanded .-cbwsdk-snackbar-instance-menu{opacity:1;display:flex;transform:translateY(8px);visibility:visible}"),_("div",{class:"-cbwsdk-snackbar"},props.children)),SnackbarInstance=({autoExpand,message,menuItems})=>{const[hidden,setHidden]=hooks_module_h(!0),[expanded,setExpanded]=hooks_module_h(null!=autoExpand&&autoExpand);!function hooks_module_y(n,u){var i=hooks_module_d(hooks_module_t++,3);!hooks_module_c.__s&&hooks_module_C(i.__H,u)&&(i.__=n,i.i=u,hooks_module_r.__H.__h.push(i))}(()=>{const timers=[window.setTimeout(()=>{setHidden(!1)},1),window.setTimeout(()=>{setExpanded(!0)},1e4)];return()=>{timers.forEach(window.clearTimeout)}});return _("div",{class:clsx("-cbwsdk-snackbar-instance",hidden&&"-cbwsdk-snackbar-instance-hidden",expanded&&"-cbwsdk-snackbar-instance-expanded")},_("div",{class:"-cbwsdk-snackbar-instance-header",onClick:()=>{setExpanded(!expanded)}},_("img",{src:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZD0iTTEuNDkyIDEwLjQxOWE4LjkzIDguOTMgMCAwMTguOTMtOC45M2gxMS4xNjNhOC45MyA4LjkzIDAgMDE4LjkzIDguOTN2MTEuMTYzYTguOTMgOC45MyAwIDAxLTguOTMgOC45M0gxMC40MjJhOC45MyA4LjkzIDAgMDEtOC45My04LjkzVjEwLjQxOXoiIGZpbGw9IiMxNjUyRjAiLz48cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTEwLjQxOSAwSDIxLjU4QzI3LjMzNSAwIDMyIDQuNjY1IDMyIDEwLjQxOVYyMS41OEMzMiAyNy4zMzUgMjcuMzM1IDMyIDIxLjU4MSAzMkgxMC40MkM0LjY2NSAzMiAwIDI3LjMzNSAwIDIxLjU4MVYxMC40MkMwIDQuNjY1IDQuNjY1IDAgMTAuNDE5IDB6bTAgMS40ODhhOC45MyA4LjkzIDAgMDAtOC45MyA4LjkzdjExLjE2M2E4LjkzIDguOTMgMCAwMDguOTMgOC45M0gyMS41OGE4LjkzIDguOTMgMCAwMDguOTMtOC45M1YxMC40MmE4LjkzIDguOTMgMCAwMC04LjkzLTguOTNIMTAuNDJ6IiBmaWxsPSIjZmZmIi8+PHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0xNS45OTggMjYuMDQ5Yy01LjU0OSAwLTEwLjA0Ny00LjQ5OC0xMC4wNDctMTAuMDQ3IDAtNS41NDggNC40OTgtMTAuMDQ2IDEwLjA0Ny0xMC4wNDYgNS41NDggMCAxMC4wNDYgNC40OTggMTAuMDQ2IDEwLjA0NiAwIDUuNTQ5LTQuNDk4IDEwLjA0Ny0xMC4wNDYgMTAuMDQ3eiIgZmlsbD0iI2ZmZiIvPjxwYXRoIGQ9Ik0xMi43NjIgMTQuMjU0YzAtLjgyMi42NjctMS40ODkgMS40ODktMS40ODloMy40OTdjLjgyMiAwIDEuNDg4LjY2NiAxLjQ4OCAxLjQ4OXYzLjQ5N2MwIC44MjItLjY2NiAxLjQ4OC0xLjQ4OCAxLjQ4OGgtMy40OTdhMS40ODggMS40ODggMCAwMS0xLjQ4OS0xLjQ4OHYtMy40OTh6IiBmaWxsPSIjMTY1MkYwIi8+PC9zdmc+",class:"-cbwsdk-snackbar-instance-header-cblogo"})," ",_("div",{class:"-cbwsdk-snackbar-instance-header-message"},message),_("div",{class:"-gear-container"},!expanded&&_("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_("circle",{cx:"12",cy:"12",r:"12",fill:"#F5F7F8"})),_("img",{src:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTIiIGhlaWdodD0iMTIiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZD0iTTEyIDYuNzV2LTEuNWwtMS43Mi0uNTdjLS4wOC0uMjctLjE5LS41Mi0uMzItLjc3bC44MS0xLjYyLTEuMDYtMS4wNi0xLjYyLjgxYy0uMjQtLjEzLS41LS4yNC0uNzctLjMyTDYuNzUgMGgtMS41bC0uNTcgMS43MmMtLjI3LjA4LS41My4xOS0uNzcuMzJsLTEuNjItLjgxLTEuMDYgMS4wNi44MSAxLjYyYy0uMTMuMjQtLjI0LjUtLjMyLjc3TDAgNS4yNXYxLjVsMS43Mi41N2MuMDguMjcuMTkuNTMuMzIuNzdsLS44MSAxLjYyIDEuMDYgMS4wNiAxLjYyLS44MWMuMjQuMTMuNS4yMy43Ny4zMkw1LjI1IDEyaDEuNWwuNTctMS43MmMuMjctLjA4LjUyLS4xOS43Ny0uMzJsMS42Mi44MSAxLjA2LTEuMDYtLjgxLTEuNjJjLjEzLS4yNC4yMy0uNS4zMi0uNzdMMTIgNi43NXpNNiA4LjVhMi41IDIuNSAwIDAxMC01IDIuNSAyLjUgMCAwMTAgNXoiIGZpbGw9IiMwNTBGMTkiLz48L3N2Zz4=",class:"-gear-icon",title:"Expand"}))),menuItems&&menuItems.length>0&&_("div",{class:"-cbwsdk-snackbar-instance-menu"},menuItems.map((action,i)=>_("div",{class:clsx("-cbwsdk-snackbar-instance-menu-item",action.isRed&&"-cbwsdk-snackbar-instance-menu-item-is-red"),onClick:action.onClick,key:i},_("svg",{width:action.svgWidth,height:action.svgHeight,viewBox:"0 0 10 11",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_("path",{"fill-rule":action.defaultFillRule,"clip-rule":action.defaultClipRule,d:action.path,fill:"#AAAAAA"})),_("span",{class:clsx("-cbwsdk-snackbar-instance-menu-item-info",action.isRed&&"-cbwsdk-snackbar-instance-menu-item-info-is-red")},action.info)))))},RETRY_SVG_PATH="M5.00008 0.96875C6.73133 0.96875 8.23758 1.94375 9.00008 3.375L10.0001 2.375V5.5H9.53133H7.96883H6.87508L7.80633 4.56875C7.41258 3.3875 6.31258 2.53125 5.00008 2.53125C3.76258 2.53125 2.70633 3.2875 2.25633 4.36875L0.812576 3.76875C1.50008 2.125 3.11258 0.96875 5.00008 0.96875ZM2.19375 6.43125C2.5875 7.6125 3.6875 8.46875 5 8.46875C6.2375 8.46875 7.29375 7.7125 7.74375 6.63125L9.1875 7.23125C8.5 8.875 6.8875 10.0312 5 10.0312C3.26875 10.0312 1.7625 9.05625 1 7.625L0 8.625V5.5H0.46875H2.03125H3.125L2.19375 6.43125Z";class WalletLinkRelayUI{constructor(){this.attached=!1,this.snackbar=new Snackbar}attach(){if(this.attached)throw new Error("Coinbase Wallet SDK UI is already attached");const el=document.documentElement,container=document.createElement("div");container.className="-cbwsdk-css-reset",el.appendChild(container),this.snackbar.attach(container),this.attached=!0,injectCssReset()}showConnecting(options){let snackbarProps;return snackbarProps=options.isUnlinkedErrorState?{autoExpand:!0,message:"Connection lost",menuItems:[{isRed:!1,info:"Reset connection",svgWidth:"10",svgHeight:"11",path:"M5.00008 0.96875C6.73133 0.96875 8.23758 1.94375 9.00008 3.375L10.0001 2.375V5.5H9.53133H7.96883H6.87508L7.80633 4.56875C7.41258 3.3875 6.31258 2.53125 5.00008 2.53125C3.76258 2.53125 2.70633 3.2875 2.25633 4.36875L0.812576 3.76875C1.50008 2.125 3.11258 0.96875 5.00008 0.96875ZM2.19375 6.43125C2.5875 7.6125 3.6875 8.46875 5 8.46875C6.2375 8.46875 7.29375 7.7125 7.74375 6.63125L9.1875 7.23125C8.5 8.875 6.8875 10.0312 5 10.0312C3.26875 10.0312 1.7625 9.05625 1 7.625L0 8.625V5.5H0.46875H2.03125H3.125L2.19375 6.43125Z",defaultFillRule:"evenodd",defaultClipRule:"evenodd",onClick:options.onResetConnection}]}:{message:"Confirm on phone",menuItems:[{isRed:!0,info:"Cancel transaction",svgWidth:"11",svgHeight:"11",path:"M10.3711 1.52346L9.21775 0.370117L5.37109 4.21022L1.52444 0.370117L0.371094 1.52346L4.2112 5.37012L0.371094 9.21677L1.52444 10.3701L5.37109 6.53001L9.21775 10.3701L10.3711 9.21677L6.53099 5.37012L10.3711 1.52346Z",defaultFillRule:"inherit",defaultClipRule:"inherit",onClick:options.onCancel},{isRed:!1,info:"Reset connection",svgWidth:"10",svgHeight:"11",path:RETRY_SVG_PATH,defaultFillRule:"evenodd",defaultClipRule:"evenodd",onClick:options.onResetConnection}]},this.snackbar.presentItem(snackbarProps)}}const RETRY_BUTTON={isRed:!1,info:"Retry",svgWidth:"10",svgHeight:"11",path:RETRY_SVG_PATH,defaultFillRule:"evenodd",defaultClipRule:"evenodd"};let snackbar=null;function openPopup(url){const left=(window.innerWidth-420)/2+window.screenX,top=(window.innerHeight-700)/2+window.screenY;function tryOpenPopup(){const popupId=`wallet_${crypto.randomUUID()}`,popup=window.open(url,popupId,`width=420, height=700, left=${left}, top=${top}`);return null==popup||popup.focus(),popup||null}!function appendAppInfoQueryParams(url){const params={sdkName:NAME,sdkVersion:"4.3.6",origin:window.location.origin,coop:getCrossOriginOpenerPolicy()};for(const[key,value]of Object.entries(params))url.searchParams.has(key)||url.searchParams.append(key,value.toString())}(url);let popup=tryOpenPopup();if(!popup){const sb=initSnackbar();return new Promise((resolve,reject)=>{logSnackbarShown({snackbarContext:"popup_blocked"}),sb.presentItem({autoExpand:!0,message:"Popup was blocked. Try again.",menuItems:[Object.assign(Object.assign({},RETRY_BUTTON),{onClick:()=>{logSnackbarActionClicked({snackbarContext:"popup_blocked",snackbarAction:"confirm"}),popup=tryOpenPopup(),popup?resolve(popup):reject(errors_standardErrors.rpc.internal("Popup window was blocked")),sb.clear()}})]})})}return Promise.resolve(popup)}function initSnackbar(){if(!snackbar){const root=document.createElement("div");root.className="-cbwsdk-css-reset",document.body.appendChild(root),snackbar=new Snackbar,snackbar.attach(root)}return snackbar}class Communicator{constructor({url="https://keys.coinbase.com/connect",metadata,preference}){this.popup=null,this.listeners=new Map,this.postMessage=async message=>{(await this.waitForPopupLoaded()).postMessage(message,this.url.origin)},this.postRequestAndWaitForResponse=async request=>{const responsePromise=this.onMessage(({requestId})=>requestId===request.id);return this.postMessage(request),await responsePromise},this.onMessage=async predicate=>new Promise((resolve,reject)=>{const listener=event=>{if(event.origin!==this.url.origin)return;const message=event.data;predicate(message)&&(resolve(message),window.removeEventListener("message",listener),this.listeners.delete(listener))};window.addEventListener("message",listener),this.listeners.set(listener,{reject})}),this.disconnect=()=>{!function closePopup(popup){popup&&!popup.closed&&popup.close()}(this.popup),this.popup=null,this.listeners.forEach(({reject},listener)=>{reject(errors_standardErrors.provider.userRejectedRequest("Request rejected")),window.removeEventListener("message",listener)}),this.listeners.clear()},this.waitForPopupLoaded=async()=>this.popup&&!this.popup.closed?(this.popup.focus(),this.popup):(logEvent("communicator.popup_setup.started",{action:ActionType.unknown,componentType:ComponentType.unknown},AnalyticsEventImportance.high),this.popup=await openPopup(this.url),this.onMessage(({event})=>"PopupUnload"===event).then(()=>{this.disconnect(),logEvent("communicator.popup_unload.received",{action:ActionType.unknown,componentType:ComponentType.unknown},AnalyticsEventImportance.high)}).catch(()=>{}),this.onMessage(({event})=>"PopupLoaded"===event).then(message=>{this.postMessage({requestId:message.id,data:{version:"4.3.6",metadata:this.metadata,preference:this.preference,location:window.location.toString()}})}).then(()=>{if(!this.popup)throw errors_standardErrors.rpc.internal();return logEvent("communicator.popup_setup.completed",{action:ActionType.unknown,componentType:ComponentType.unknown},AnalyticsEventImportance.high),this.popup})),this.url=new URL(url),this.metadata=metadata,this.preference=preference}}function isErrorResponse(response){return void 0!==response.errorMessage}function serializeError(error){const serialized=serialize(function getErrorObject(error){var _a;if("string"==typeof error)return{message:error,code:standardErrorCodes_rpc.internal};if(isErrorResponse(error)){const message=error.errorMessage,code=null!==(_a=error.errorCode)&&void 0!==_a?_a:message.match(/(denied|rejected)/i)?standardErrorCodes_provider.userRejectedRequest:void 0;return Object.assign(Object.assign({},error),{message,code,data:{method:error.method}})}return error}(error),{shouldIncludeStack:!0}),docUrl=new URL("https://docs.cloud.coinbase.com/wallet-sdk/docs/errors");return docUrl.searchParams.set("version","4.3.6"),docUrl.searchParams.set("code",serialized.code.toString()),docUrl.searchParams.set("message",serialized.message),Object.assign(Object.assign({},serialized),{docUrl:docUrl.href})}var eventemitter3=__webpack_require__("./node_modules/eventemitter3/index.mjs");class ProviderEventEmitter extends eventemitter3.b{}class ScopedLocalStorage{constructor(scope,module){this.scope=scope,this.module=module}storeObject(key,item){this.setItem(key,JSON.stringify(item))}loadObject(key){const item=this.getItem(key);return item?JSON.parse(item):void 0}setItem(key,value){localStorage.setItem(this.scopedKey(key),value)}getItem(key){return localStorage.getItem(this.scopedKey(key))}removeItem(key){localStorage.removeItem(this.scopedKey(key))}clear(){const prefix=this.scopedKey(""),keysToRemove=[];for(let i=0;i<localStorage.length;i++){const key=localStorage.key(i);"string"==typeof key&&key.startsWith(prefix)&&keysToRemove.push(key)}keysToRemove.forEach(key=>localStorage.removeItem(key))}scopedKey(key){return`-${this.scope}${this.module?`:${this.module}`:""}:${key}`}static clearAll(){new ScopedLocalStorage("CBWSDK").clear(),new ScopedLocalStorage("walletlink").clear()}}const HexString=value=>value,BigIntString=value=>value;function type_IntNumber(num){return Math.floor(num)}var Buffer=__webpack_require__("./node_modules/buffer/index.js").Buffer;const INT_STRING_REGEX=/^[0-9]*$/,HEXADECIMAL_STRING_REGEX=/^[a-f0-9]*$/;function randomBytesHex(length){return uint8ArrayToHex(crypto.getRandomValues(new Uint8Array(length)))}function uint8ArrayToHex(value){return[...value].map(b=>b.toString(16).padStart(2,"0")).join("")}function hexStringToUint8Array(hexString){return new Uint8Array(hexString.match(/.{1,2}/g).map(byte=>Number.parseInt(byte,16)))}function hexStringFromBuffer(buf,includePrefix=!1){const hex=buf.toString("hex");return HexString(includePrefix?`0x${hex}`:hex)}function encodeToHexString(str){return hexStringFromBuffer(ensureBuffer(str),!0)}function bigIntStringFromBigInt(bi){return BigIntString(bi.toString(10))}function hexStringFromNumber(num){return HexString(`0x${BigInt(num).toString(16)}`)}function has0xPrefix(str){return str.startsWith("0x")||str.startsWith("0X")}function strip0x(hex){return has0xPrefix(hex)?hex.slice(2):hex}function prepend0x(hex){return has0xPrefix(hex)?`0x${hex.slice(2)}`:`0x${hex}`}function isHexString(hex){if("string"!=typeof hex)return!1;const s=strip0x(hex).toLowerCase();return HEXADECIMAL_STRING_REGEX.test(s)}function ensureHexString(hex,includePrefix=!1){if("string"==typeof hex){const s=strip0x(hex).toLowerCase();if(HEXADECIMAL_STRING_REGEX.test(s))return HexString(includePrefix?`0x${s}`:s)}throw errors_standardErrors.rpc.invalidParams(`"${String(hex)}" is not a hexadecimal string`)}function ensureEvenLengthHexString(hex,includePrefix=!1){let h=ensureHexString(hex,!1);return h.length%2==1&&(h=HexString(`0${h}`)),includePrefix?HexString(`0x${h}`):h}function ensureAddressString(str){if("string"==typeof str){const s=strip0x(str).toLowerCase();if(isHexString(s)&&40===s.length)return prepend0x(s)}throw errors_standardErrors.rpc.invalidParams(`Invalid Ethereum address: ${String(str)}`)}function ensureBuffer(str){if(Buffer.isBuffer(str))return str;if("string"==typeof str){if(isHexString(str)){const s=ensureEvenLengthHexString(str,!1);return Buffer.from(s,"hex")}return Buffer.from(str,"utf8")}throw errors_standardErrors.rpc.invalidParams(`Not binary data: ${String(str)}`)}function ensureIntNumber(num){if("number"==typeof num&&Number.isInteger(num))return type_IntNumber(num);if("string"==typeof num){if(INT_STRING_REGEX.test(num))return type_IntNumber(Number(num));if(isHexString(num))return type_IntNumber(Number(BigInt(ensureEvenLengthHexString(num,!0))))}throw errors_standardErrors.rpc.invalidParams(`Not an integer: ${String(num)}`)}function ensureBigInt(val){if(null!==val&&("bigint"==typeof val||function isBigNumber(val){if(null==val||"function"!=typeof val.constructor)return!1;const{constructor:constructor_}=val;return"function"==typeof constructor_.config&&"number"==typeof constructor_.EUCLID}(val)))return BigInt(val.toString(10));if("number"==typeof val)return BigInt(ensureIntNumber(val));if("string"==typeof val){if(INT_STRING_REGEX.test(val))return BigInt(val);if(isHexString(val))return BigInt(ensureEvenLengthHexString(val,!0))}throw errors_standardErrors.rpc.invalidParams(`Not an integer: ${String(val)}`)}function ensureParsedJSONObject(val){if("string"==typeof val)return JSON.parse(val);if("object"==typeof val)return val;throw errors_standardErrors.rpc.invalidParams(`Not a JSON string or an object: ${String(val)}`)}const correlationIdsStore=createStore(()=>({correlationIds:new Map})),correlationIds_get=key=>correlationIdsStore.getState().correlationIds.get(key),correlationIds_set=(key,correlationId)=>{correlationIdsStore.setState(state=>{const newMap=new Map(state.correlationIds);return newMap.set(key,correlationId),{correlationIds:newMap}})},correlationIds_delete=key=>{correlationIdsStore.setState(state=>{const newMap=new Map(state.correlationIds);return newMap.delete(key),{correlationIds:newMap}})},correlationIds_clear=()=>{correlationIdsStore.setState({correlationIds:new Map})};var fromHex=__webpack_require__("./node_modules/viem/_esm/utils/encoding/fromHex.js"),isAddressEqual=__webpack_require__("./node_modules/viem/_esm/utils/address/isAddressEqual.js");const parseErrorMessageFromAny=errorOrAny=>"message"in errorOrAny&&"string"==typeof errorOrAny.message?errorOrAny.message:"";var defineChain=__webpack_require__("./node_modules/viem/_esm/utils/chain/defineChain.js"),createPublicClient=__webpack_require__("./node_modules/viem/_esm/clients/createPublicClient.js"),http=__webpack_require__("./node_modules/viem/_esm/clients/transports/http.js"),createClient=__webpack_require__("./node_modules/viem/_esm/clients/createClient.js"),public_getChainId=__webpack_require__("./node_modules/viem/_esm/actions/public/getChainId.js"),parseAccount=__webpack_require__("./node_modules/viem/_esm/accounts/utils/parseAccount.js"),errors_account=__webpack_require__("./node_modules/viem/_esm/errors/account.js"),getAction=__webpack_require__("./node_modules/viem/_esm/utils/getAction.js"),utils_stateOverride=__webpack_require__("./node_modules/viem/_esm/utils/stateOverride.js"),base=__webpack_require__("./node_modules/viem/_esm/errors/base.js"),contract=__webpack_require__("./node_modules/viem/_esm/errors/contract.js"),decodeErrorResult=__webpack_require__("./node_modules/viem/_esm/utils/abi/decodeErrorResult.js");class AccountNotDeployedError extends base.C{constructor({cause}){super("Smart Account is not deployed.",{cause,metaMessages:["This could arise when:","- No `factory`/`factoryData` or `initCode` properties are provided for Smart Account deployment.","- An incorrect `sender` address is provided."],name:"AccountNotDeployedError"})}}Object.defineProperty(AccountNotDeployedError,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa20/});class ExecutionRevertedError extends base.C{constructor({cause,data,message}={}){const reason=message?.replace("execution reverted: ","")?.replace("execution reverted","");super(`Execution reverted ${reason?`with reason: ${reason}`:"for an unknown reason"}.`,{cause,name:"ExecutionRevertedError"}),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.data=data}}Object.defineProperty(ExecutionRevertedError,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32521}),Object.defineProperty(ExecutionRevertedError,"message",{enumerable:!0,configurable:!0,writable:!0,value:/execution reverted/});class FailedToSendToBeneficiaryError extends base.C{constructor({cause}){super("Failed to send funds to beneficiary.",{cause,name:"FailedToSendToBeneficiaryError"})}}Object.defineProperty(FailedToSendToBeneficiaryError,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa91/});class GasValuesOverflowError extends base.C{constructor({cause}){super("Gas value overflowed.",{cause,metaMessages:["This could arise when:","- one of the gas values exceeded 2**120 (uint120)"].filter(Boolean),name:"GasValuesOverflowError"})}}Object.defineProperty(GasValuesOverflowError,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa94/});class HandleOpsOutOfGasError extends base.C{constructor({cause}){super("The `handleOps` function was called by the Bundler with a gas limit too low.",{cause,name:"HandleOpsOutOfGasError"})}}Object.defineProperty(HandleOpsOutOfGasError,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa95/});class InitCodeFailedError extends base.C{constructor({cause,factory,factoryData,initCode}){super("Failed to simulate deployment for Smart Account.",{cause,metaMessages:["This could arise when:","- Invalid `factory`/`factoryData` or `initCode` properties are present","- Smart Account deployment execution ran out of gas (low `verificationGasLimit` value)","- Smart Account deployment execution reverted with an error\n",factory&&`factory: ${factory}`,factoryData&&`factoryData: ${factoryData}`,initCode&&`initCode: ${initCode}`].filter(Boolean),name:"InitCodeFailedError"})}}Object.defineProperty(InitCodeFailedError,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa13/});class InitCodeMustCreateSenderError extends base.C{constructor({cause,factory,factoryData,initCode}){super("Smart Account initialization implementation did not create an account.",{cause,metaMessages:["This could arise when:","- `factory`/`factoryData` or `initCode` properties are invalid","- Smart Account initialization implementation is incorrect\n",factory&&`factory: ${factory}`,factoryData&&`factoryData: ${factoryData}`,initCode&&`initCode: ${initCode}`].filter(Boolean),name:"InitCodeMustCreateSenderError"})}}Object.defineProperty(InitCodeMustCreateSenderError,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa15/});class InitCodeMustReturnSenderError extends base.C{constructor({cause,factory,factoryData,initCode,sender}){super("Smart Account initialization implementation does not return the expected sender.",{cause,metaMessages:["This could arise when:","Smart Account initialization implementation does not return a sender address\n",factory&&`factory: ${factory}`,factoryData&&`factoryData: ${factoryData}`,initCode&&`initCode: ${initCode}`,sender&&`sender: ${sender}`].filter(Boolean),name:"InitCodeMustReturnSenderError"})}}Object.defineProperty(InitCodeMustReturnSenderError,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa14/});class InsufficientPrefundError extends base.C{constructor({cause}){super("Smart Account does not have sufficient funds to execute the User Operation.",{cause,metaMessages:["This could arise when:","- the Smart Account does not have sufficient funds to cover the required prefund, or","- a Paymaster was not provided"].filter(Boolean),name:"InsufficientPrefundError"})}}Object.defineProperty(InsufficientPrefundError,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa21/});class InternalCallOnlyError extends base.C{constructor({cause}){super("Bundler attempted to call an invalid function on the EntryPoint.",{cause,name:"InternalCallOnlyError"})}}Object.defineProperty(InternalCallOnlyError,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa92/});class InvalidAggregatorError extends base.C{constructor({cause}){super("Bundler used an invalid aggregator for handling aggregated User Operations.",{cause,name:"InvalidAggregatorError"})}}Object.defineProperty(InvalidAggregatorError,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa96/});class InvalidAccountNonceError extends base.C{constructor({cause,nonce}){super("Invalid Smart Account nonce used for User Operation.",{cause,metaMessages:[nonce&&`nonce: ${nonce}`].filter(Boolean),name:"InvalidAccountNonceError"})}}Object.defineProperty(InvalidAccountNonceError,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa25/});class InvalidBeneficiaryError extends base.C{constructor({cause}){super("Bundler has not set a beneficiary address.",{cause,name:"InvalidBeneficiaryError"})}}Object.defineProperty(InvalidBeneficiaryError,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa90/});class InvalidFieldsError extends base.C{constructor({cause}){super("Invalid fields set on User Operation.",{cause,name:"InvalidFieldsError"})}}Object.defineProperty(InvalidFieldsError,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32602});class InvalidPaymasterAndDataError extends base.C{constructor({cause,paymasterAndData}){super("Paymaster properties provided are invalid.",{cause,metaMessages:["This could arise when:","- the `paymasterAndData` property is of an incorrect length\n",paymasterAndData&&`paymasterAndData: ${paymasterAndData}`].filter(Boolean),name:"InvalidPaymasterAndDataError"})}}Object.defineProperty(InvalidPaymasterAndDataError,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa93/});class PaymasterDepositTooLowError extends base.C{constructor({cause}){super("Paymaster deposit for the User Operation is too low.",{cause,metaMessages:["This could arise when:","- the Paymaster has deposited less than the expected amount via the `deposit` function"].filter(Boolean),name:"PaymasterDepositTooLowError"})}}Object.defineProperty(PaymasterDepositTooLowError,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32508}),Object.defineProperty(PaymasterDepositTooLowError,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa31/});class PaymasterFunctionRevertedError extends base.C{constructor({cause}){super("The `validatePaymasterUserOp` function on the Paymaster reverted.",{cause,name:"PaymasterFunctionRevertedError"})}}Object.defineProperty(PaymasterFunctionRevertedError,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa33/});class PaymasterNotDeployedError extends base.C{constructor({cause}){super("The Paymaster contract has not been deployed.",{cause,name:"PaymasterNotDeployedError"})}}Object.defineProperty(PaymasterNotDeployedError,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa30/});class PaymasterRateLimitError extends base.C{constructor({cause}){super("UserOperation rejected because paymaster (or signature aggregator) is throttled/banned.",{cause,name:"PaymasterRateLimitError"})}}Object.defineProperty(PaymasterRateLimitError,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32504});class PaymasterStakeTooLowError extends base.C{constructor({cause}){super("UserOperation rejected because paymaster (or signature aggregator) is throttled/banned.",{cause,name:"PaymasterStakeTooLowError"})}}Object.defineProperty(PaymasterStakeTooLowError,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32505});class PaymasterPostOpFunctionRevertedError extends base.C{constructor({cause}){super("Paymaster `postOp` function reverted.",{cause,name:"PaymasterPostOpFunctionRevertedError"})}}Object.defineProperty(PaymasterPostOpFunctionRevertedError,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa50/});class SenderAlreadyConstructedError extends base.C{constructor({cause,factory,factoryData,initCode}){super("Smart Account has already been deployed.",{cause,metaMessages:["Remove the following properties and try again:",factory&&"`factory`",factoryData&&"`factoryData`",initCode&&"`initCode`"].filter(Boolean),name:"SenderAlreadyConstructedError"})}}Object.defineProperty(SenderAlreadyConstructedError,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa10/});class SignatureCheckFailedError extends base.C{constructor({cause}){super("UserOperation rejected because account signature check failed (or paymaster signature, if the paymaster uses its data as signature).",{cause,name:"SignatureCheckFailedError"})}}Object.defineProperty(SignatureCheckFailedError,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32507});class SmartAccountFunctionRevertedError extends base.C{constructor({cause}){super("The `validateUserOp` function on the Smart Account reverted.",{cause,name:"SmartAccountFunctionRevertedError"})}}Object.defineProperty(SmartAccountFunctionRevertedError,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa23/});class UnsupportedSignatureAggregatorError extends base.C{constructor({cause}){super("UserOperation rejected because account specified unsupported signature aggregator.",{cause,name:"UnsupportedSignatureAggregatorError"})}}Object.defineProperty(UnsupportedSignatureAggregatorError,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32506});class UserOperationExpiredError extends base.C{constructor({cause}){super("User Operation expired.",{cause,metaMessages:["This could arise when:","- the `validAfter` or `validUntil` values returned from `validateUserOp` on the Smart Account are not satisfied"].filter(Boolean),name:"UserOperationExpiredError"})}}Object.defineProperty(UserOperationExpiredError,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa22/});class UserOperationPaymasterExpiredError extends base.C{constructor({cause}){super("Paymaster for User Operation expired.",{cause,metaMessages:["This could arise when:","- the `validAfter` or `validUntil` values returned from `validatePaymasterUserOp` on the Paymaster are not satisfied"].filter(Boolean),name:"UserOperationPaymasterExpiredError"})}}Object.defineProperty(UserOperationPaymasterExpiredError,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa32/});class UserOperationSignatureError extends base.C{constructor({cause}){super("Signature provided for the User Operation is invalid.",{cause,metaMessages:["This could arise when:","- the `signature` for the User Operation is incorrectly computed, and unable to be verified by the Smart Account"].filter(Boolean),name:"UserOperationSignatureError"})}}Object.defineProperty(UserOperationSignatureError,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa24/});class UserOperationPaymasterSignatureError extends base.C{constructor({cause}){super("Signature provided for the User Operation is invalid.",{cause,metaMessages:["This could arise when:","- the `signature` for the User Operation is incorrectly computed, and unable to be verified by the Paymaster"].filter(Boolean),name:"UserOperationPaymasterSignatureError"})}}Object.defineProperty(UserOperationPaymasterSignatureError,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa34/});class UserOperationRejectedByEntryPointError extends base.C{constructor({cause}){super("User Operation rejected by EntryPoint's `simulateValidation` during account creation or validation.",{cause,name:"UserOperationRejectedByEntryPointError"})}}Object.defineProperty(UserOperationRejectedByEntryPointError,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32500});class UserOperationRejectedByPaymasterError extends base.C{constructor({cause}){super("User Operation rejected by Paymaster's `validatePaymasterUserOp`.",{cause,name:"UserOperationRejectedByPaymasterError"})}}Object.defineProperty(UserOperationRejectedByPaymasterError,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32501});class UserOperationRejectedByOpCodeError extends base.C{constructor({cause}){super("User Operation rejected with op code validation error.",{cause,name:"UserOperationRejectedByOpCodeError"})}}Object.defineProperty(UserOperationRejectedByOpCodeError,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32502});class UserOperationOutOfTimeRangeError extends base.C{constructor({cause}){super("UserOperation out of time-range: either wallet or paymaster returned a time-range, and it is already expired (or will expire soon).",{cause,name:"UserOperationOutOfTimeRangeError"})}}Object.defineProperty(UserOperationOutOfTimeRangeError,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32503});class UnknownBundlerError extends base.C{constructor({cause}){super(`An error occurred while executing user operation: ${cause?.shortMessage}`,{cause,name:"UnknownBundlerError"})}}class VerificationGasLimitExceededError extends base.C{constructor({cause}){super("User Operation verification gas limit exceeded.",{cause,metaMessages:["This could arise when:","- the gas used for verification exceeded the `verificationGasLimit`"].filter(Boolean),name:"VerificationGasLimitExceededError"})}}Object.defineProperty(VerificationGasLimitExceededError,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa40/});class VerificationGasLimitTooLowError extends base.C{constructor({cause}){super("User Operation verification gas limit is too low.",{cause,metaMessages:["This could arise when:","- the `verificationGasLimit` is too low to verify the User Operation"].filter(Boolean),name:"VerificationGasLimitTooLowError"})}}Object.defineProperty(VerificationGasLimitTooLowError,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa41/});var transaction=__webpack_require__("./node_modules/viem/_esm/errors/transaction.js"),formatGwei=__webpack_require__("./node_modules/viem/_esm/utils/unit/formatGwei.js");class UserOperationExecutionError extends base.C{constructor(cause,{callData,callGasLimit,docsPath,factory,factoryData,initCode,maxFeePerGas,maxPriorityFeePerGas,nonce,paymaster,paymasterAndData,paymasterData,paymasterPostOpGasLimit,paymasterVerificationGasLimit,preVerificationGas,sender,signature,verificationGasLimit}){const prettyArgs=(0,transaction.aO)({callData,callGasLimit,factory,factoryData,initCode,maxFeePerGas:void 0!==maxFeePerGas&&`${(0,formatGwei.Q)(maxFeePerGas)} gwei`,maxPriorityFeePerGas:void 0!==maxPriorityFeePerGas&&`${(0,formatGwei.Q)(maxPriorityFeePerGas)} gwei`,nonce,paymaster,paymasterAndData,paymasterData,paymasterPostOpGasLimit,paymasterVerificationGasLimit,preVerificationGas,sender,signature,verificationGasLimit});super(cause.shortMessage,{cause,docsPath,metaMessages:[...cause.metaMessages?[...cause.metaMessages," "]:[],"Request Arguments:",prettyArgs].filter(Boolean),name:"UserOperationExecutionError"}),Object.defineProperty(this,"cause",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.cause=cause}}class UserOperationReceiptNotFoundError extends base.C{constructor({hash}){super(`User Operation receipt with hash "${hash}" could not be found. The User Operation may not have been processed yet.`,{name:"UserOperationReceiptNotFoundError"})}}class UserOperationNotFoundError extends base.C{constructor({hash}){super(`User Operation with hash "${hash}" could not be found.`,{name:"UserOperationNotFoundError"})}}class WaitForUserOperationReceiptTimeoutError extends base.C{constructor({hash}){super(`Timed out while waiting for User Operation with hash "${hash}" to be confirmed.`,{name:"WaitForUserOperationReceiptTimeoutError"})}}const bundlerErrors=[ExecutionRevertedError,InvalidFieldsError,PaymasterDepositTooLowError,PaymasterRateLimitError,PaymasterStakeTooLowError,SignatureCheckFailedError,UnsupportedSignatureAggregatorError,UserOperationOutOfTimeRangeError,UserOperationRejectedByEntryPointError,UserOperationRejectedByPaymasterError,UserOperationRejectedByOpCodeError];function getUserOperationError(err,{calls,docsPath,...args}){const cause=(()=>{const cause=function getBundlerError(err,args){const message=(err.details||"").toLowerCase();if(AccountNotDeployedError.message.test(message))return new AccountNotDeployedError({cause:err});if(FailedToSendToBeneficiaryError.message.test(message))return new FailedToSendToBeneficiaryError({cause:err});if(GasValuesOverflowError.message.test(message))return new GasValuesOverflowError({cause:err});if(HandleOpsOutOfGasError.message.test(message))return new HandleOpsOutOfGasError({cause:err});if(InitCodeFailedError.message.test(message))return new InitCodeFailedError({cause:err,factory:args.factory,factoryData:args.factoryData,initCode:args.initCode});if(InitCodeMustCreateSenderError.message.test(message))return new InitCodeMustCreateSenderError({cause:err,factory:args.factory,factoryData:args.factoryData,initCode:args.initCode});if(InitCodeMustReturnSenderError.message.test(message))return new InitCodeMustReturnSenderError({cause:err,factory:args.factory,factoryData:args.factoryData,initCode:args.initCode,sender:args.sender});if(InsufficientPrefundError.message.test(message))return new InsufficientPrefundError({cause:err});if(InternalCallOnlyError.message.test(message))return new InternalCallOnlyError({cause:err});if(InvalidAccountNonceError.message.test(message))return new InvalidAccountNonceError({cause:err,nonce:args.nonce});if(InvalidAggregatorError.message.test(message))return new InvalidAggregatorError({cause:err});if(InvalidBeneficiaryError.message.test(message))return new InvalidBeneficiaryError({cause:err});if(InvalidPaymasterAndDataError.message.test(message))return new InvalidPaymasterAndDataError({cause:err});if(PaymasterDepositTooLowError.message.test(message))return new PaymasterDepositTooLowError({cause:err});if(PaymasterFunctionRevertedError.message.test(message))return new PaymasterFunctionRevertedError({cause:err});if(PaymasterNotDeployedError.message.test(message))return new PaymasterNotDeployedError({cause:err});if(PaymasterPostOpFunctionRevertedError.message.test(message))return new PaymasterPostOpFunctionRevertedError({cause:err});if(SmartAccountFunctionRevertedError.message.test(message))return new SmartAccountFunctionRevertedError({cause:err});if(SenderAlreadyConstructedError.message.test(message))return new SenderAlreadyConstructedError({cause:err,factory:args.factory,factoryData:args.factoryData,initCode:args.initCode});if(UserOperationExpiredError.message.test(message))return new UserOperationExpiredError({cause:err});if(UserOperationPaymasterExpiredError.message.test(message))return new UserOperationPaymasterExpiredError({cause:err});if(UserOperationPaymasterSignatureError.message.test(message))return new UserOperationPaymasterSignatureError({cause:err});if(UserOperationSignatureError.message.test(message))return new UserOperationSignatureError({cause:err});if(VerificationGasLimitExceededError.message.test(message))return new VerificationGasLimitExceededError({cause:err});if(VerificationGasLimitTooLowError.message.test(message))return new VerificationGasLimitTooLowError({cause:err});const error=err.walk(e=>bundlerErrors.some(error=>error.code===e.code));if(error){if(error.code===ExecutionRevertedError.code)return new ExecutionRevertedError({cause:err,data:error.data,message:error.details});if(error.code===InvalidFieldsError.code)return new InvalidFieldsError({cause:err});if(error.code===PaymasterDepositTooLowError.code)return new PaymasterDepositTooLowError({cause:err});if(error.code===PaymasterRateLimitError.code)return new PaymasterRateLimitError({cause:err});if(error.code===PaymasterStakeTooLowError.code)return new PaymasterStakeTooLowError({cause:err});if(error.code===SignatureCheckFailedError.code)return new SignatureCheckFailedError({cause:err});if(error.code===UnsupportedSignatureAggregatorError.code)return new UnsupportedSignatureAggregatorError({cause:err});if(error.code===UserOperationOutOfTimeRangeError.code)return new UserOperationOutOfTimeRangeError({cause:err});if(error.code===UserOperationRejectedByEntryPointError.code)return new UserOperationRejectedByEntryPointError({cause:err});if(error.code===UserOperationRejectedByPaymasterError.code)return new UserOperationRejectedByPaymasterError({cause:err});if(error.code===UserOperationRejectedByOpCodeError.code)return new UserOperationRejectedByOpCodeError({cause:err})}return new UnknownBundlerError({cause:err})}(err,args);if(calls&&cause instanceof ExecutionRevertedError){const revertData=function getRevertData(error){let revertData;return error.walk(e=>{const error=e;if("string"==typeof error.data||"string"==typeof error.data?.revertData||!(error instanceof base.C)&&"string"==typeof error.message){const match=(error.data?.revertData||error.data||error.message).match?.(/(0x[A-Za-z0-9]*)/);if(match)return revertData=match[1],!0}return!1}),revertData}(cause),contractCalls=calls?.filter(call=>call.abi);if(revertData&&contractCalls.length>0)return function getContractError(parameters){const{calls,revertData}=parameters,{abi,functionName,args,to}=(()=>{const contractCalls=calls?.filter(call=>Boolean(call.abi));if(1===contractCalls.length)return contractCalls[0];const compatContractCalls=contractCalls.filter(call=>{try{return Boolean((0,decodeErrorResult.W)({abi:call.abi,data:revertData}))}catch{return!1}});return 1===compatContractCalls.length?compatContractCalls[0]:{abi:[],functionName:contractCalls.reduce((acc,call)=>`${acc?`${acc} | `:""}${call.functionName}`,""),args:void 0,to:void 0}})(),cause="0x"===revertData?new contract.rR({functionName}):new contract.M({abi,data:revertData,functionName});return new contract.bG(cause,{abi,args,contractAddress:to,functionName})}({calls:contractCalls,revertData})}return cause})();return new UserOperationExecutionError(cause,{docsPath,...args})}var pad=__webpack_require__("./node_modules/viem/_esm/utils/data/pad.js");function formatUserOperationRequest(request){const rpcRequest={};return void 0!==request.callData&&(rpcRequest.callData=request.callData),void 0!==request.callGasLimit&&(rpcRequest.callGasLimit=(0,toHex.cK)(request.callGasLimit)),void 0!==request.factory&&(rpcRequest.factory=request.factory),void 0!==request.factoryData&&(rpcRequest.factoryData=request.factoryData),void 0!==request.initCode&&(rpcRequest.initCode=request.initCode),void 0!==request.maxFeePerGas&&(rpcRequest.maxFeePerGas=(0,toHex.cK)(request.maxFeePerGas)),void 0!==request.maxPriorityFeePerGas&&(rpcRequest.maxPriorityFeePerGas=(0,toHex.cK)(request.maxPriorityFeePerGas)),void 0!==request.nonce&&(rpcRequest.nonce=(0,toHex.cK)(request.nonce)),void 0!==request.paymaster&&(rpcRequest.paymaster=request.paymaster),void 0!==request.paymasterAndData&&(rpcRequest.paymasterAndData=request.paymasterAndData||"0x"),void 0!==request.paymasterData&&(rpcRequest.paymasterData=request.paymasterData),void 0!==request.paymasterPostOpGasLimit&&(rpcRequest.paymasterPostOpGasLimit=(0,toHex.cK)(request.paymasterPostOpGasLimit)),void 0!==request.paymasterVerificationGasLimit&&(rpcRequest.paymasterVerificationGasLimit=(0,toHex.cK)(request.paymasterVerificationGasLimit)),void 0!==request.preVerificationGas&&(rpcRequest.preVerificationGas=(0,toHex.cK)(request.preVerificationGas)),void 0!==request.sender&&(rpcRequest.sender=request.sender),void 0!==request.signature&&(rpcRequest.signature=request.signature),void 0!==request.verificationGasLimit&&(rpcRequest.verificationGasLimit=(0,toHex.cK)(request.verificationGasLimit)),void 0!==request.authorization&&(rpcRequest.eip7702Auth=function formatAuthorization(authorization){return{address:authorization.address,chainId:(0,toHex.cK)(authorization.chainId),nonce:(0,toHex.cK)(authorization.nonce),r:authorization.r?(0,toHex.cK)(BigInt(authorization.r),{size:32}):(0,pad.eV)("0x",{size:32}),s:authorization.s?(0,toHex.cK)(BigInt(authorization.s),{size:32}):(0,pad.eV)("0x",{size:32}),yParity:authorization.yParity?(0,toHex.cK)(authorization.yParity,{size:1}):(0,pad.eV)("0x",{size:32})}}(request.authorization)),rpcRequest}var prepareAuthorization=__webpack_require__("./node_modules/viem/_esm/actions/wallet/prepareAuthorization.js"),estimateFeesPerGas=__webpack_require__("./node_modules/viem/_esm/actions/public/estimateFeesPerGas.js"),concat=__webpack_require__("./node_modules/viem/_esm/utils/data/concat.js");async function getPaymasterData_getPaymasterData(client,parameters){const{chainId,entryPointAddress,context,...userOperation}=parameters,request=formatUserOperationRequest(userOperation),{paymasterPostOpGasLimit,paymasterVerificationGasLimit,...rest}=await client.request({method:"pm_getPaymasterData",params:[{...request,callGasLimit:request.callGasLimit??"0x0",verificationGasLimit:request.verificationGasLimit??"0x0",preVerificationGas:request.preVerificationGas??"0x0"},entryPointAddress,(0,toHex.cK)(chainId),context]});return{...rest,...paymasterPostOpGasLimit&&{paymasterPostOpGasLimit:(0,fromHex.uU)(paymasterPostOpGasLimit)},...paymasterVerificationGasLimit&&{paymasterVerificationGasLimit:(0,fromHex.uU)(paymasterVerificationGasLimit)}}}async function getPaymasterStubData_getPaymasterStubData(client,parameters){const{chainId,entryPointAddress,context,...userOperation}=parameters,request=formatUserOperationRequest(userOperation),{paymasterPostOpGasLimit,paymasterVerificationGasLimit,...rest}=await client.request({method:"pm_getPaymasterStubData",params:[{...request,callGasLimit:request.callGasLimit??"0x0",verificationGasLimit:request.verificationGasLimit??"0x0",preVerificationGas:request.preVerificationGas??"0x0"},entryPointAddress,(0,toHex.cK)(chainId),context]});return{...rest,...paymasterPostOpGasLimit&&{paymasterPostOpGasLimit:(0,fromHex.uU)(paymasterPostOpGasLimit)},...paymasterVerificationGasLimit&&{paymasterVerificationGasLimit:(0,fromHex.uU)(paymasterVerificationGasLimit)}}}const defaultParameters=["factory","fees","gas","paymaster","nonce","signature","authorization"];async function prepareUserOperation(client,parameters_){const parameters=parameters_,{account:account_=client.account,parameters:properties=defaultParameters,stateOverride}=parameters;if(!account_)throw new errors_account.T;const account=(0,parseAccount.J)(account_),bundlerClient=client,paymaster=parameters.paymaster??bundlerClient?.paymaster,paymasterAddress="string"==typeof paymaster?paymaster:void 0,{getPaymasterStubData,getPaymasterData}=(()=>{if(!0===paymaster)return{getPaymasterStubData:parameters=>(0,getAction.T)(bundlerClient,getPaymasterStubData_getPaymasterStubData,"getPaymasterStubData")(parameters),getPaymasterData:parameters=>(0,getAction.T)(bundlerClient,getPaymasterData_getPaymasterData,"getPaymasterData")(parameters)};if("object"==typeof paymaster){const{getPaymasterStubData,getPaymasterData}=paymaster;return{getPaymasterStubData:getPaymasterData&&getPaymasterStubData?getPaymasterStubData:getPaymasterData,getPaymasterData:getPaymasterData&&getPaymasterStubData?getPaymasterData:void 0}}return{getPaymasterStubData:void 0,getPaymasterData:void 0}})(),paymasterContext=parameters.paymasterContext?parameters.paymasterContext:bundlerClient?.paymasterContext;let request={...parameters,paymaster:paymasterAddress,sender:account.address};const[callData,factory,fees,nonce,authorization]=await Promise.all([(async()=>parameters.calls?account.encodeCalls(parameters.calls.map(call_=>{const call=call_;return call.abi?{data:(0,encodeFunctionData.p)(call),to:call.to,value:call.value}:call})):parameters.callData)(),(async()=>{if(!properties.includes("factory"))return;if(parameters.initCode)return{initCode:parameters.initCode};if(parameters.factory&&parameters.factoryData)return{factory:parameters.factory,factoryData:parameters.factoryData};const{factory,factoryData}=await account.getFactoryArgs();return"0.6"===account.entryPoint.version?{initCode:factory&&factoryData?(0,concat.xW)([factory,factoryData]):void 0}:{factory,factoryData}})(),(async()=>{if(properties.includes("fees")){if("bigint"==typeof parameters.maxFeePerGas&&"bigint"==typeof parameters.maxPriorityFeePerGas)return request;if(bundlerClient?.userOperation?.estimateFeesPerGas){const fees=await bundlerClient.userOperation.estimateFeesPerGas({account,bundlerClient,userOperation:request});return{...request,...fees}}try{const client_=bundlerClient.client??client,fees=await(0,getAction.T)(client_,estimateFeesPerGas._,"estimateFeesPerGas")({chain:client_.chain,type:"eip1559"});return{maxFeePerGas:"bigint"==typeof parameters.maxFeePerGas?parameters.maxFeePerGas:BigInt(2n*fees.maxFeePerGas),maxPriorityFeePerGas:"bigint"==typeof parameters.maxPriorityFeePerGas?parameters.maxPriorityFeePerGas:BigInt(2n*fees.maxPriorityFeePerGas)}}catch{return}}})(),(async()=>{if(properties.includes("nonce"))return"bigint"==typeof parameters.nonce?parameters.nonce:account.getNonce()})(),(async()=>{if(properties.includes("authorization")){if("object"==typeof parameters.authorization)return parameters.authorization;if(account.authorization&&!await account.isDeployed()){return{...await(0,prepareAuthorization.h)(account.client,account.authorization),r:"0xfffffffffffffffffffffffffffffff000000000000000000000000000000000",s:"0x7aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa",yParity:1}}}})()]);let chainId;async function getChainId(){if(chainId)return chainId;if(client.chain)return client.chain.id;const chainId_=await(0,getAction.T)(client,public_getChainId.T,"getChainId")({});return chainId=chainId_,chainId}void 0!==callData&&(request.callData=callData),void 0!==factory&&(request={...request,...factory}),void 0!==fees&&(request={...request,...fees}),void 0!==nonce&&(request.nonce=nonce),void 0!==authorization&&(request.authorization=authorization),properties.includes("signature")&&(void 0!==parameters.signature?request.signature=parameters.signature:request.signature=await account.getStubSignature(request)),"0.6"!==account.entryPoint.version||request.initCode||(request.initCode="0x");let isPaymasterPopulated=!1;if(properties.includes("paymaster")&&getPaymasterStubData&&!paymasterAddress&&!parameters.paymasterAndData){const{isFinal=!1,sponsor:_,...paymasterArgs}=await getPaymasterStubData({chainId:await getChainId(),entryPointAddress:account.entryPoint.address,context:paymasterContext,...request});isPaymasterPopulated=isFinal,request={...request,...paymasterArgs}}if("0.6"!==account.entryPoint.version||request.paymasterAndData||(request.paymasterAndData="0x"),properties.includes("gas")){if(account.userOperation?.estimateGas){const gas=await account.userOperation.estimateGas(request);request={...request,...gas}}if(void 0===request.callGasLimit||void 0===request.preVerificationGas||void 0===request.verificationGasLimit||request.paymaster&&void 0===request.paymasterPostOpGasLimit||request.paymaster&&void 0===request.paymasterVerificationGasLimit){const gas=await(0,getAction.T)(bundlerClient,estimateUserOperationGas,"estimateUserOperationGas")({account,callGasLimit:0n,preVerificationGas:0n,verificationGasLimit:0n,stateOverride,...request.paymaster?{paymasterPostOpGasLimit:0n,paymasterVerificationGasLimit:0n}:{},...request});request={...request,callGasLimit:request.callGasLimit??gas.callGasLimit,preVerificationGas:request.preVerificationGas??gas.preVerificationGas,verificationGasLimit:request.verificationGasLimit??gas.verificationGasLimit,paymasterPostOpGasLimit:request.paymasterPostOpGasLimit??gas.paymasterPostOpGasLimit,paymasterVerificationGasLimit:request.paymasterVerificationGasLimit??gas.paymasterVerificationGasLimit}}}if(properties.includes("paymaster")&&getPaymasterData&&!paymasterAddress&&!parameters.paymasterAndData&&!isPaymasterPopulated){const paymaster=await getPaymasterData({chainId:await getChainId(),entryPointAddress:account.entryPoint.address,context:paymasterContext,...request});request={...request,...paymaster}}return delete request.calls,delete request.parameters,delete request.paymasterContext,"string"!=typeof request.paymaster&&delete request.paymaster,request}async function estimateUserOperationGas(client,parameters){const{account:account_=client.account,entryPointAddress,stateOverride}=parameters;if(!account_&&!parameters.sender)throw new errors_account.T;const account=account_?(0,parseAccount.J)(account_):void 0,rpcStateOverride=(0,utils_stateOverride.yH)(stateOverride),request=account?await(0,getAction.T)(client,prepareUserOperation,"prepareUserOperation")({...parameters,parameters:["authorization","factory","nonce","paymaster","signature"]}):parameters;try{const params=[formatUserOperationRequest(request),entryPointAddress??account?.entryPoint?.address];return function formatUserOperationGas(parameters){const gas={};return parameters.callGasLimit&&(gas.callGasLimit=BigInt(parameters.callGasLimit)),parameters.preVerificationGas&&(gas.preVerificationGas=BigInt(parameters.preVerificationGas)),parameters.verificationGasLimit&&(gas.verificationGasLimit=BigInt(parameters.verificationGasLimit)),parameters.paymasterPostOpGasLimit&&(gas.paymasterPostOpGasLimit=BigInt(parameters.paymasterPostOpGasLimit)),parameters.paymasterVerificationGasLimit&&(gas.paymasterVerificationGasLimit=BigInt(parameters.paymasterVerificationGasLimit)),gas}(await client.request({method:"eth_estimateUserOperationGas",params:rpcStateOverride?[...params,rpcStateOverride]:[...params]}))}catch(error){const calls=parameters.calls;throw getUserOperationError(error,{...request,...calls?{calls}:{}})}}function formatUserOperation(parameters){const userOperation={...parameters};return parameters.callGasLimit&&(userOperation.callGasLimit=BigInt(parameters.callGasLimit)),parameters.maxFeePerGas&&(userOperation.maxFeePerGas=BigInt(parameters.maxFeePerGas)),parameters.maxPriorityFeePerGas&&(userOperation.maxPriorityFeePerGas=BigInt(parameters.maxPriorityFeePerGas)),parameters.nonce&&(userOperation.nonce=BigInt(parameters.nonce)),parameters.paymasterPostOpGasLimit&&(userOperation.paymasterPostOpGasLimit=BigInt(parameters.paymasterPostOpGasLimit)),parameters.paymasterVerificationGasLimit&&(userOperation.paymasterVerificationGasLimit=BigInt(parameters.paymasterVerificationGasLimit)),parameters.preVerificationGas&&(userOperation.preVerificationGas=BigInt(parameters.preVerificationGas)),parameters.verificationGasLimit&&(userOperation.verificationGasLimit=BigInt(parameters.verificationGasLimit)),userOperation}var formatters_log=__webpack_require__("./node_modules/viem/_esm/utils/formatters/log.js"),transactionReceipt=__webpack_require__("./node_modules/viem/_esm/utils/formatters/transactionReceipt.js");async function getUserOperationReceipt(client,{hash}){const receipt=await client.request({method:"eth_getUserOperationReceipt",params:[hash]},{dedupe:!0});if(!receipt)throw new UserOperationReceiptNotFoundError({hash});return function formatUserOperationReceipt(parameters){const receipt={...parameters};return parameters.actualGasCost&&(receipt.actualGasCost=BigInt(parameters.actualGasCost)),parameters.actualGasUsed&&(receipt.actualGasUsed=BigInt(parameters.actualGasUsed)),parameters.logs&&(receipt.logs=parameters.logs.map(log=>(0,formatters_log.e)(log))),parameters.receipt&&(receipt.receipt=(0,transactionReceipt.uL)(receipt.receipt)),receipt}(receipt)}var observe=__webpack_require__("./node_modules/viem/_esm/utils/observe.js"),poll=__webpack_require__("./node_modules/viem/_esm/utils/poll.js"),stringify=__webpack_require__("./node_modules/viem/_esm/utils/stringify.js");function bundlerActions(client){return{estimateUserOperationGas:parameters=>estimateUserOperationGas(client,parameters),getChainId:()=>(0,public_getChainId.T)(client),getSupportedEntryPoints:()=>function getSupportedEntryPoints(client){return client.request({method:"eth_supportedEntryPoints"})}(client),getUserOperation:parameters=>async function getUserOperation(client,{hash}){const result=await client.request({method:"eth_getUserOperationByHash",params:[hash]},{dedupe:!0});if(!result)throw new UserOperationNotFoundError({hash});const{blockHash,blockNumber,entryPoint,transactionHash,userOperation}=result;return{blockHash,blockNumber:BigInt(blockNumber),entryPoint,transactionHash,userOperation:formatUserOperation(userOperation)}}(client,parameters),getUserOperationReceipt:parameters=>getUserOperationReceipt(client,parameters),prepareUserOperation:parameters=>prepareUserOperation(client,parameters),sendUserOperation:parameters=>async function sendUserOperation(client,parameters){const{account:account_=client.account,entryPointAddress}=parameters;if(!account_&&!parameters.sender)throw new errors_account.T;const account=account_?(0,parseAccount.J)(account_):void 0,request=account?await(0,getAction.T)(client,prepareUserOperation,"prepareUserOperation")(parameters):parameters,signature=parameters.signature||await(account?.signUserOperation?.(request)),rpcParameters=formatUserOperationRequest({...request,signature});try{return await client.request({method:"eth_sendUserOperation",params:[rpcParameters,entryPointAddress??account?.entryPoint?.address]},{retryCount:0})}catch(error){const calls=parameters.calls;throw getUserOperationError(error,{...request,...calls?{calls}:{},signature})}}(client,parameters),waitForUserOperationReceipt:parameters=>function waitForUserOperationReceipt(client,parameters){const{hash,pollingInterval=client.pollingInterval,retryCount,timeout=12e4}=parameters;let count=0;const observerId=(0,stringify.A)(["waitForUserOperationReceipt",client.uid,hash]);return new Promise((resolve,reject)=>{const unobserve=(0,observe.lB)(observerId,{resolve,reject},emit=>{const done=fn=>{unpoll(),fn(),unobserve()},unpoll=(0,poll.w)(async()=>{retryCount&&count>=retryCount&&done(()=>emit.reject(new WaitForUserOperationReceiptTimeoutError({hash})));try{const receipt=await(0,getAction.T)(client,getUserOperationReceipt,"getUserOperationReceipt")({hash});done(()=>emit.resolve(receipt))}catch(err){const error=err;"UserOperationReceiptNotFoundError"!==error.name&&done(()=>emit.reject(error))}count++},{emitOnBegin:!0,interval:pollingInterval});return timeout&&setTimeout(()=>done(()=>emit.reject(new WaitForUserOperationReceiptTimeoutError({hash}))),timeout),unpoll})})}(client,parameters)}}const store_ChainClients=createStore(()=>({}));function createClients(chains){chains.forEach(c=>{var _a,_b,_c,_d,_e,_f,_g,_h;if(!c.rpcUrl)return;const viemchain=(0,defineChain.x)({id:c.id,rpcUrls:{default:{http:[c.rpcUrl]}},name:null!==(_b=null===(_a=c.nativeCurrency)||void 0===_a?void 0:_a.name)&&void 0!==_b?_b:"",nativeCurrency:{name:null!==(_d=null===(_c=c.nativeCurrency)||void 0===_c?void 0:_c.name)&&void 0!==_d?_d:"",symbol:null!==(_f=null===(_e=c.nativeCurrency)||void 0===_e?void 0:_e.symbol)&&void 0!==_f?_f:"",decimals:null!==(_h=null===(_g=c.nativeCurrency)||void 0===_g?void 0:_g.decimal)&&void 0!==_h?_h:18}}),client=(0,createPublicClient.l)({chain:viemchain,transport:(0,http.L)(c.rpcUrl)}),bundlerClient=function createBundlerClient(parameters){const{client:client_,key="bundler",name="Bundler Client",paymaster,paymasterContext,transport,userOperation}=parameters;return Object.assign((0,createClient.U)({...parameters,chain:parameters.chain??client_?.chain,key,name,transport,type:"bundlerClient"}),{client:client_,paymaster,paymasterContext,userOperation}).extend(bundlerActions)}({client,transport:(0,http.L)(c.rpcUrl)});store_ChainClients.setState({[c.id]:{client,bundlerClient}})})}function getClient(chainId){var _a;return null===(_a=store_ChainClients.getState()[chainId])||void 0===_a?void 0:_a.client}var isAddress=__webpack_require__("./node_modules/viem/_esm/utils/address/isAddress.js"),isHex=__webpack_require__("./node_modules/viem/_esm/utils/data/isHex.js");function assertSubAccount(info){if("object"!=typeof info||null===info)throw errors_standardErrors.rpc.internal("sub account info is not an object");if(!("address"in info))throw errors_standardErrors.rpc.internal("sub account is invalid");if("address"in info&&"string"==typeof info.address&&!(0,isAddress.P)(info.address))throw errors_standardErrors.rpc.internal("sub account address is invalid");if("factory"in info&&"string"==typeof info.factory&&!(0,isAddress.P)(info.factory))throw errors_standardErrors.rpc.internal("sub account factory address is invalid");if("factoryData"in info&&"string"==typeof info.factoryData&&!(0,isHex.q)(info.factoryData))throw errors_standardErrors.rpc.internal("sub account factory data is invalid")}function getFormat(keyType){switch(keyType){case"public":return"spki";case"private":return"pkcs8"}}async function exportKeyToHexString(type,key){const format=getFormat(type),exported=await crypto.subtle.exportKey(format,key);return uint8ArrayToHex(new Uint8Array(exported))}async function importKeyFromHexString(type,hexString){const format=getFormat(type),arrayBuffer=hexStringToUint8Array(hexString).buffer;return await crypto.subtle.importKey(format,new Uint8Array(arrayBuffer),{name:"ECDH",namedCurve:"P-256"},!0,"private"===type?["deriveKey"]:[])}async function encryptContent(content,sharedSecret){return async function encrypt(sharedSecret,plainText){const iv=crypto.getRandomValues(new Uint8Array(12));return{iv,cipherText:await crypto.subtle.encrypt({name:"AES-GCM",iv},sharedSecret,(new TextEncoder).encode(plainText))}}(sharedSecret,JSON.stringify(content,(_,value)=>{if(!(value instanceof Error))return value;const error=value;return Object.assign(Object.assign({},error.code?{code:error.code}:{}),{message:error.message})}))}async function decryptContent(encryptedData,sharedSecret){return JSON.parse(await async function decrypt(sharedSecret,{iv,cipherText}){const plainText=await crypto.subtle.decrypt({name:"AES-GCM",iv},sharedSecret,cipherText);return(new TextDecoder).decode(plainText)}(sharedSecret,encryptedData))}var sha2=__webpack_require__("./node_modules/@noble/hashes/esm/sha2.js"),esm_hmac=__webpack_require__("./node_modules/@noble/hashes/esm/hmac.js"),esm_utils=__webpack_require__("./node_modules/@noble/hashes/esm/utils.js");const _0n=BigInt(0),_1n=BigInt(1);function _abool2(value,title=""){if("boolean"!=typeof value){throw new Error((title&&`"${title}"`)+"expected boolean, got type="+typeof value)}return value}function _abytes2(value,length,title=""){const bytes=(0,esm_utils.aY)(value),len=value?.length,needsLen=void 0!==length;if(!bytes||needsLen&&len!==length){throw new Error((title&&`"${title}" `)+"expected Uint8Array"+(needsLen?` of length ${length}`:"")+", got "+(bytes?`length=${len}`:"type="+typeof value))}return value}function numberToHexUnpadded(num){const hex=num.toString(16);return 1&hex.length?"0"+hex:hex}function hexToNumber(hex){if("string"!=typeof hex)throw new Error("hex string expected, got "+typeof hex);return""===hex?_0n:BigInt("0x"+hex)}function utils_bytesToNumberBE(bytes){return hexToNumber((0,esm_utils.My)(bytes))}function utils_bytesToNumberLE(bytes){return(0,esm_utils.DO)(bytes),hexToNumber((0,esm_utils.My)(Uint8Array.from(bytes).reverse()))}function numberToBytesBE(n,len){return(0,esm_utils.aT)(n.toString(16).padStart(2*len,"0"))}function numberToBytesLE(n,len){return numberToBytesBE(n,len).reverse()}function utils_ensureBytes(title,hex,expectedLength){let res;if("string"==typeof hex)try{res=(0,esm_utils.aT)(hex)}catch(e){throw new Error(title+" must be hex string or Uint8Array, cause: "+e)}else{if(!(0,esm_utils.aY)(hex))throw new Error(title+" must be hex string or Uint8Array");res=Uint8Array.from(hex)}const len=res.length;if("number"==typeof expectedLength&&len!==expectedLength)throw new Error(title+" of length "+expectedLength+" expected, got "+len);return res}const isPosBig=n=>"bigint"==typeof n&&_0n<=n;function aInRange(title,n,min,max){if(!function utils_inRange(n,min,max){return isPosBig(n)&&isPosBig(min)&&isPosBig(max)&&min<=n&&n<max}(n,min,max))throw new Error("expected valid "+title+": "+min+" <= n < "+max+", got "+n)}function bitLen(n){let len;for(len=0;n>_0n;n>>=_1n,len+=1);return len}const utils_bitMask=n=>(_1n<<BigInt(n))-_1n;function _validateObject(object,fields,optFields={}){if(!object||"object"!=typeof object)throw new Error("expected valid options object");function checkField(fieldName,expectedType,isOpt){const val=object[fieldName];if(isOpt&&void 0===val)return;const current=typeof val;if(current!==expectedType||null===val)throw new Error(`param "${fieldName}" is invalid: expected ${expectedType}, got ${current}`)}Object.entries(fields).forEach(([k,v])=>checkField(k,v,!1)),Object.entries(optFields).forEach(([k,v])=>checkField(k,v,!0))}function memoized(fn){const map=new WeakMap;return(arg,...args)=>{const val=map.get(arg);if(void 0!==val)return val;const computed=fn(arg,...args);return map.set(arg,computed),computed}}const modular_0n=BigInt(0),modular_1n=BigInt(1),_2n=BigInt(2),_3n=BigInt(3),_4n=BigInt(4),_5n=BigInt(5),_7n=BigInt(7),_8n=BigInt(8),_9n=BigInt(9),_16n=BigInt(16);function mod(a,b){const result=a%b;return result>=modular_0n?result:b+result}function invert(number,modulo){if(number===modular_0n)throw new Error("invert: expected non-zero number");if(modulo<=modular_0n)throw new Error("invert: expected positive modulus, got "+modulo);let a=mod(number,modulo),b=modulo,x=modular_0n,y=modular_1n,u=modular_1n,v=modular_0n;for(;a!==modular_0n;){const q=b/a,r=b%a,m=x-u*q,n=y-v*q;b=a,a=r,x=u,y=v,u=m,v=n}if(b!==modular_1n)throw new Error("invert: does not exist");return mod(x,modulo)}function assertIsSquare(Fp,root,n){if(!Fp.eql(Fp.sqr(root),n))throw new Error("Cannot find square root")}function sqrt3mod4(Fp,n){const p1div4=(Fp.ORDER+modular_1n)/_4n,root=Fp.pow(n,p1div4);return assertIsSquare(Fp,root,n),root}function sqrt5mod8(Fp,n){const p5div8=(Fp.ORDER-_5n)/_8n,n2=Fp.mul(n,_2n),v=Fp.pow(n2,p5div8),nv=Fp.mul(n,v),i=Fp.mul(Fp.mul(nv,_2n),v),root=Fp.mul(nv,Fp.sub(i,Fp.ONE));return assertIsSquare(Fp,root,n),root}function tonelliShanks(P){if(P<_3n)throw new Error("sqrt is not defined for small field");let Q=P-modular_1n,S=0;for(;Q%_2n===modular_0n;)Q/=_2n,S++;let Z=_2n;const _Fp=Field(P);for(;1===FpLegendre(_Fp,Z);)if(Z++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(1===S)return sqrt3mod4;let cc=_Fp.pow(Z,Q);const Q1div2=(Q+modular_1n)/_2n;return function tonelliSlow(Fp,n){if(Fp.is0(n))return n;if(1!==FpLegendre(Fp,n))throw new Error("Cannot find square root");let M=S,c=Fp.mul(Fp.ONE,cc),t=Fp.pow(n,Q),R=Fp.pow(n,Q1div2);for(;!Fp.eql(t,Fp.ONE);){if(Fp.is0(t))return Fp.ZERO;let i=1,t_tmp=Fp.sqr(t);for(;!Fp.eql(t_tmp,Fp.ONE);)if(i++,t_tmp=Fp.sqr(t_tmp),i===M)throw new Error("Cannot find square root");const exponent=modular_1n<<BigInt(M-i-1),b=Fp.pow(c,exponent);M=i,c=Fp.sqr(b),t=Fp.mul(t,c),R=Fp.mul(R,b)}return R}}function FpSqrt(P){return P%_4n===_3n?sqrt3mod4:P%_8n===_5n?sqrt5mod8:P%_16n===_9n?function sqrt9mod16(P){const Fp_=Field(P),tn=tonelliShanks(P),c1=tn(Fp_,Fp_.neg(Fp_.ONE)),c2=tn(Fp_,c1),c3=tn(Fp_,Fp_.neg(c1)),c4=(P+_7n)/_16n;return(Fp,n)=>{let tv1=Fp.pow(n,c4),tv2=Fp.mul(tv1,c1);const tv3=Fp.mul(tv1,c2),tv4=Fp.mul(tv1,c3),e1=Fp.eql(Fp.sqr(tv2),n),e2=Fp.eql(Fp.sqr(tv3),n);tv1=Fp.cmov(tv1,tv2,e1),tv2=Fp.cmov(tv4,tv3,e2);const e3=Fp.eql(Fp.sqr(tv2),n),root=Fp.cmov(tv1,tv2,e3);return assertIsSquare(Fp,root,n),root}}(P):tonelliShanks(P)}const FIELD_FIELDS=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function FpPow(Fp,num,power){if(power<modular_0n)throw new Error("invalid exponent, negatives unsupported");if(power===modular_0n)return Fp.ONE;if(power===modular_1n)return num;let p=Fp.ONE,d=num;for(;power>modular_0n;)power&modular_1n&&(p=Fp.mul(p,d)),d=Fp.sqr(d),power>>=modular_1n;return p}function modular_FpInvertBatch(Fp,nums,passZero=!1){const inverted=new Array(nums.length).fill(passZero?Fp.ZERO:void 0),multipliedAcc=nums.reduce((acc,num,i)=>Fp.is0(num)?acc:(inverted[i]=acc,Fp.mul(acc,num)),Fp.ONE),invertedAcc=Fp.inv(multipliedAcc);return nums.reduceRight((acc,num,i)=>Fp.is0(num)?acc:(inverted[i]=Fp.mul(acc,inverted[i]),Fp.mul(acc,num)),invertedAcc),inverted}function FpLegendre(Fp,n){const p1mod2=(Fp.ORDER-modular_1n)/_2n,powered=Fp.pow(n,p1mod2),yes=Fp.eql(powered,Fp.ONE),zero=Fp.eql(powered,Fp.ZERO),no=Fp.eql(powered,Fp.neg(Fp.ONE));if(!yes&&!zero&&!no)throw new Error("invalid Legendre symbol result");return yes?1:zero?0:-1}function modular_nLength(n,nBitLength){void 0!==nBitLength&&(0,esm_utils.Fe)(nBitLength);const _nBitLength=void 0!==nBitLength?nBitLength:n.toString(2).length;return{nBitLength:_nBitLength,nByteLength:Math.ceil(_nBitLength/8)}}function Field(ORDER,bitLenOrOpts,isLE=!1,opts={}){if(ORDER<=modular_0n)throw new Error("invalid field: expected ORDER > 0, got "+ORDER);let _nbitLength,_sqrt,allowedLengths,modFromBytes=!1;if("object"==typeof bitLenOrOpts&&null!=bitLenOrOpts){if(opts.sqrt||isLE)throw new Error("cannot specify opts in two arguments");const _opts=bitLenOrOpts;_opts.BITS&&(_nbitLength=_opts.BITS),_opts.sqrt&&(_sqrt=_opts.sqrt),"boolean"==typeof _opts.isLE&&(isLE=_opts.isLE),"boolean"==typeof _opts.modFromBytes&&(modFromBytes=_opts.modFromBytes),allowedLengths=_opts.allowedLengths}else"number"==typeof bitLenOrOpts&&(_nbitLength=bitLenOrOpts),opts.sqrt&&(_sqrt=opts.sqrt);const{nBitLength:BITS,nByteLength:BYTES}=modular_nLength(ORDER,_nbitLength);if(BYTES>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let sqrtP;const f=Object.freeze({ORDER,isLE,BITS,BYTES,MASK:utils_bitMask(BITS),ZERO:modular_0n,ONE:modular_1n,allowedLengths,create:num=>mod(num,ORDER),isValid:num=>{if("bigint"!=typeof num)throw new Error("invalid field element: expected bigint, got "+typeof num);return modular_0n<=num&&num<ORDER},is0:num=>num===modular_0n,isValidNot0:num=>!f.is0(num)&&f.isValid(num),isOdd:num=>(num&modular_1n)===modular_1n,neg:num=>mod(-num,ORDER),eql:(lhs,rhs)=>lhs===rhs,sqr:num=>mod(num*num,ORDER),add:(lhs,rhs)=>mod(lhs+rhs,ORDER),sub:(lhs,rhs)=>mod(lhs-rhs,ORDER),mul:(lhs,rhs)=>mod(lhs*rhs,ORDER),pow:(num,power)=>FpPow(f,num,power),div:(lhs,rhs)=>mod(lhs*invert(rhs,ORDER),ORDER),sqrN:num=>num*num,addN:(lhs,rhs)=>lhs+rhs,subN:(lhs,rhs)=>lhs-rhs,mulN:(lhs,rhs)=>lhs*rhs,inv:num=>invert(num,ORDER),sqrt:_sqrt||(n=>(sqrtP||(sqrtP=FpSqrt(ORDER)),sqrtP(f,n))),toBytes:num=>isLE?numberToBytesLE(num,BYTES):numberToBytesBE(num,BYTES),fromBytes:(bytes,skipValidation=!0)=>{if(allowedLengths){if(!allowedLengths.includes(bytes.length)||bytes.length>BYTES)throw new Error("Field.fromBytes: expected "+allowedLengths+" bytes, got "+bytes.length);const padded=new Uint8Array(BYTES);padded.set(bytes,isLE?0:padded.length-bytes.length),bytes=padded}if(bytes.length!==BYTES)throw new Error("Field.fromBytes: expected "+BYTES+" bytes, got "+bytes.length);let scalar=isLE?utils_bytesToNumberLE(bytes):utils_bytesToNumberBE(bytes);if(modFromBytes&&(scalar=mod(scalar,ORDER)),!skipValidation&&!f.isValid(scalar))throw new Error("invalid field element: outside of range 0..ORDER");return scalar},invertBatch:lst=>modular_FpInvertBatch(f,lst),cmov:(a,b,c)=>c?b:a});return Object.freeze(f)}function getFieldBytesLength(fieldOrder){if("bigint"!=typeof fieldOrder)throw new Error("field order must be bigint");const bitLength=fieldOrder.toString(2).length;return Math.ceil(bitLength/8)}function getMinHashLength(fieldOrder){const length=getFieldBytesLength(fieldOrder);return length+Math.ceil(length/2)}const curve_0n=BigInt(0),curve_1n=BigInt(1);function negateCt(condition,item){const neg=item.negate();return condition?neg:item}function normalizeZ(c,points){const invertedZs=modular_FpInvertBatch(c.Fp,points.map(p=>p.Z));return points.map((p,i)=>c.fromAffine(p.toAffine(invertedZs[i])))}function validateW(W,bits){if(!Number.isSafeInteger(W)||W<=0||W>bits)throw new Error("invalid window size, expected [1.."+bits+"], got W="+W)}function calcWOpts(W,scalarBits){validateW(W,scalarBits);const maxNumber=2**W;return{windows:Math.ceil(scalarBits/W)+1,windowSize:2**(W-1),mask:utils_bitMask(W),maxNumber,shiftBy:BigInt(W)}}function calcOffsets(n,window,wOpts){const{windowSize,mask,maxNumber,shiftBy}=wOpts;let wbits=Number(n&mask),nextN=n>>shiftBy;wbits>windowSize&&(wbits-=maxNumber,nextN+=curve_1n);const offsetStart=window*windowSize;return{nextN,offset:offsetStart+Math.abs(wbits)-1,isZero:0===wbits,isNeg:wbits<0,isNegF:window%2!=0,offsetF:offsetStart}}function validateMSMPoints(points,c){if(!Array.isArray(points))throw new Error("array expected");points.forEach((p,i)=>{if(!(p instanceof c))throw new Error("invalid point at index "+i)})}function validateMSMScalars(scalars,field){if(!Array.isArray(scalars))throw new Error("array of scalars expected");scalars.forEach((s,i)=>{if(!field.isValid(s))throw new Error("invalid scalar at index "+i)})}const pointPrecomputes=new WeakMap,pointWindowSizes=new WeakMap;function getW(P){return pointWindowSizes.get(P)||1}function assert0(n){if(n!==curve_0n)throw new Error("invalid wNAF")}class wNAF{constructor(Point,bits){this.BASE=Point.BASE,this.ZERO=Point.ZERO,this.Fn=Point.Fn,this.bits=bits}_unsafeLadder(elm,n,p=this.ZERO){let d=elm;for(;n>curve_0n;)n&curve_1n&&(p=p.add(d)),d=d.double(),n>>=curve_1n;return p}precomputeWindow(point,W){const{windows,windowSize}=calcWOpts(W,this.bits),points=[];let p=point,base=p;for(let window=0;window<windows;window++){base=p,points.push(base);for(let i=1;i<windowSize;i++)base=base.add(p),points.push(base);p=base.double()}return points}wNAF(W,precomputes,n){if(!this.Fn.isValid(n))throw new Error("invalid scalar");let p=this.ZERO,f=this.BASE;const wo=calcWOpts(W,this.bits);for(let window=0;window<wo.windows;window++){const{nextN,offset,isZero,isNeg,isNegF,offsetF}=calcOffsets(n,window,wo);n=nextN,isZero?f=f.add(negateCt(isNegF,precomputes[offsetF])):p=p.add(negateCt(isNeg,precomputes[offset]))}return assert0(n),{p,f}}wNAFUnsafe(W,precomputes,n,acc=this.ZERO){const wo=calcWOpts(W,this.bits);for(let window=0;window<wo.windows&&n!==curve_0n;window++){const{nextN,offset,isZero,isNeg}=calcOffsets(n,window,wo);if(n=nextN,!isZero){const item=precomputes[offset];acc=acc.add(isNeg?item.negate():item)}}return assert0(n),acc}getPrecomputes(W,point,transform){let comp=pointPrecomputes.get(point);return comp||(comp=this.precomputeWindow(point,W),1!==W&&("function"==typeof transform&&(comp=transform(comp)),pointPrecomputes.set(point,comp))),comp}cached(point,scalar,transform){const W=getW(point);return this.wNAF(W,this.getPrecomputes(W,point,transform),scalar)}unsafe(point,scalar,transform,prev){const W=getW(point);return 1===W?this._unsafeLadder(point,scalar,prev):this.wNAFUnsafe(W,this.getPrecomputes(W,point,transform),scalar,prev)}createCache(P,W){validateW(W,this.bits),pointWindowSizes.set(P,W),pointPrecomputes.delete(P)}hasCache(elm){return 1!==getW(elm)}}function createField(order,field,isLE){if(field){if(field.ORDER!==order)throw new Error("Field.ORDER must match order: Fp == p, Fn == n");return function modular_validateField(field){return _validateObject(field,FIELD_FIELDS.reduce((map,val)=>(map[val]="function",map),{ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"})),field}(field),field}return Field(order,{isLE})}const divNearest=(num,den)=>(num+(num>=0?den:-den)/weierstrass_2n)/den;function validateSigFormat(format){if(!["compact","recovered","der"].includes(format))throw new Error('Signature format must be "compact", "recovered", or "der"');return format}function validateSigOpts(opts,def){const optsn={};for(let optName of Object.keys(def))optsn[optName]=void 0===opts[optName]?def[optName]:opts[optName];return _abool2(optsn.lowS,"lowS"),_abool2(optsn.prehash,"prehash"),void 0!==optsn.format&&validateSigFormat(optsn.format),optsn}class DERErr extends Error{constructor(m=""){super(m)}}const DER={Err:DERErr,_tlv:{encode:(tag,data)=>{const{Err:E}=DER;if(tag<0||tag>256)throw new E("tlv.encode: wrong tag");if(1&data.length)throw new E("tlv.encode: unpadded data");const dataLen=data.length/2,len=numberToHexUnpadded(dataLen);if(len.length/2&128)throw new E("tlv.encode: long form length too big");const lenLen=dataLen>127?numberToHexUnpadded(len.length/2|128):"";return numberToHexUnpadded(tag)+lenLen+len+data},decode(tag,data){const{Err:E}=DER;let pos=0;if(tag<0||tag>256)throw new E("tlv.encode: wrong tag");if(data.length<2||data[pos++]!==tag)throw new E("tlv.decode: wrong tlv");const first=data[pos++];let length=0;if(!!(128&first)){const lenLen=127&first;if(!lenLen)throw new E("tlv.decode(long): indefinite length not supported");if(lenLen>4)throw new E("tlv.decode(long): byte length is too big");const lengthBytes=data.subarray(pos,pos+lenLen);if(lengthBytes.length!==lenLen)throw new E("tlv.decode: length bytes not complete");if(0===lengthBytes[0])throw new E("tlv.decode(long): zero leftmost byte");for(const b of lengthBytes)length=length<<8|b;if(pos+=lenLen,length<128)throw new E("tlv.decode(long): not minimal encoding")}else length=first;const v=data.subarray(pos,pos+length);if(v.length!==length)throw new E("tlv.decode: wrong value length");return{v,l:data.subarray(pos+length)}}},_int:{encode(num){const{Err:E}=DER;if(num<weierstrass_0n)throw new E("integer: negative integers are not allowed");let hex=numberToHexUnpadded(num);if(8&Number.parseInt(hex[0],16)&&(hex="00"+hex),1&hex.length)throw new E("unexpected DER parsing assertion: unpadded hex");return hex},decode(data){const{Err:E}=DER;if(128&data[0])throw new E("invalid signature integer: negative");if(0===data[0]&&!(128&data[1]))throw new E("invalid signature integer: unnecessary leading zero");return utils_bytesToNumberBE(data)}},toSig(hex){const{Err:E,_int:int,_tlv:tlv}=DER,data=utils_ensureBytes("signature",hex),{v:seqBytes,l:seqLeftBytes}=tlv.decode(48,data);if(seqLeftBytes.length)throw new E("invalid signature: left bytes after parsing");const{v:rBytes,l:rLeftBytes}=tlv.decode(2,seqBytes),{v:sBytes,l:sLeftBytes}=tlv.decode(2,rLeftBytes);if(sLeftBytes.length)throw new E("invalid signature: left bytes after parsing");return{r:int.decode(rBytes),s:int.decode(sBytes)}},hexFromSig(sig){const{_tlv:tlv,_int:int}=DER,seq=tlv.encode(2,int.encode(sig.r))+tlv.encode(2,int.encode(sig.s));return tlv.encode(48,seq)}},weierstrass_0n=BigInt(0),weierstrass_1n=BigInt(1),weierstrass_2n=BigInt(2),weierstrass_3n=BigInt(3),weierstrass_4n=BigInt(4);function _normFnElement(Fn,key){const{BYTES:expected}=Fn;let num;if("bigint"==typeof key)num=key;else{let bytes=utils_ensureBytes("private key",key);try{num=Fn.fromBytes(bytes)}catch(error){throw new Error(`invalid private key: expected ui8a of size ${expected}, got ${typeof key}`)}}if(!Fn.isValidNot0(num))throw new Error("invalid private key: out of range [1..N-1]");return num}function weierstrassN(params,extraOpts={}){const validated=function _createCurveFields(type,CURVE,curveOpts={},FpFnLE){if(void 0===FpFnLE&&(FpFnLE="edwards"===type),!CURVE||"object"!=typeof CURVE)throw new Error(`expected valid ${type} CURVE object`);for(const p of["p","n","h"]){const val=CURVE[p];if(!("bigint"==typeof val&&val>curve_0n))throw new Error(`CURVE.${p} must be positive bigint`)}const Fp=createField(CURVE.p,curveOpts.Fp,FpFnLE),Fn=createField(CURVE.n,curveOpts.Fn,FpFnLE),params=["Gx","Gy","a","weierstrass"===type?"b":"d"];for(const p of params)if(!Fp.isValid(CURVE[p]))throw new Error(`CURVE.${p} must be valid field element of CURVE.Fp`);return{CURVE:CURVE=Object.freeze(Object.assign({},CURVE)),Fp,Fn}}("weierstrass",params,extraOpts),{Fp,Fn}=validated;let CURVE=validated.CURVE;const{h:cofactor,n:CURVE_ORDER}=CURVE;_validateObject(extraOpts,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object",wrapPrivateKey:"boolean"});const{endo}=extraOpts;if(endo&&(!Fp.is0(CURVE.a)||"bigint"!=typeof endo.beta||!Array.isArray(endo.basises)))throw new Error('invalid endo: expected "beta": bigint and "basises": array');const lengths=getWLengths(Fp,Fn);function assertCompressionIsSupported(){if(!Fp.isOdd)throw new Error("compression is not supported: Field does not have .isOdd()")}const encodePoint=extraOpts.toBytes||function pointToBytes(_c,point,isCompressed){const{x,y}=point.toAffine(),bx=Fp.toBytes(x);if(_abool2(isCompressed,"isCompressed"),isCompressed){assertCompressionIsSupported();const hasEvenY=!Fp.isOdd(y);return(0,esm_utils.Id)(pprefix(hasEvenY),bx)}return(0,esm_utils.Id)(Uint8Array.of(4),bx,Fp.toBytes(y))},decodePoint=extraOpts.fromBytes||function pointFromBytes(bytes){_abytes2(bytes,void 0,"Point");const{publicKey:comp,publicKeyUncompressed:uncomp}=lengths,length=bytes.length,head=bytes[0],tail=bytes.subarray(1);if(length!==comp||2!==head&&3!==head){if(length===uncomp&&4===head){const L=Fp.BYTES,x=Fp.fromBytes(tail.subarray(0,L)),y=Fp.fromBytes(tail.subarray(L,2*L));if(!isValidXY(x,y))throw new Error("bad point: is not on curve");return{x,y}}throw new Error(`bad point: got length ${length}, expected compressed=${comp} or uncompressed=${uncomp}`)}{const x=Fp.fromBytes(tail);if(!Fp.isValid(x))throw new Error("bad point: is not on curve, wrong x");const y2=weierstrassEquation(x);let y;try{y=Fp.sqrt(y2)}catch(sqrtError){const err=sqrtError instanceof Error?": "+sqrtError.message:"";throw new Error("bad point: is not on curve, sqrt error"+err)}assertCompressionIsSupported();return!(1&~head)!==Fp.isOdd(y)&&(y=Fp.neg(y)),{x,y}}};function weierstrassEquation(x){const x2=Fp.sqr(x),x3=Fp.mul(x2,x);return Fp.add(Fp.add(x3,Fp.mul(x,CURVE.a)),CURVE.b)}function isValidXY(x,y){const left=Fp.sqr(y),right=weierstrassEquation(x);return Fp.eql(left,right)}if(!isValidXY(CURVE.Gx,CURVE.Gy))throw new Error("bad curve params: generator point");const _4a3=Fp.mul(Fp.pow(CURVE.a,weierstrass_3n),weierstrass_4n),_27b2=Fp.mul(Fp.sqr(CURVE.b),BigInt(27));if(Fp.is0(Fp.add(_4a3,_27b2)))throw new Error("bad curve params: a or b");function acoord(title,n,banZero=!1){if(!Fp.isValid(n)||banZero&&Fp.is0(n))throw new Error(`bad point coordinate ${title}`);return n}function aprjpoint(other){if(!(other instanceof Point))throw new Error("ProjectivePoint expected")}function splitEndoScalarN(k){if(!endo||!endo.basises)throw new Error("no endo");return function _splitEndoScalar(k,basis,n){const[[a1,b1],[a2,b2]]=basis,c1=divNearest(b2*k,n),c2=divNearest(-b1*k,n);let k1=k-c1*a1-c2*a2,k2=-c1*b1-c2*b2;const k1neg=k1<weierstrass_0n,k2neg=k2<weierstrass_0n;k1neg&&(k1=-k1),k2neg&&(k2=-k2);const MAX_NUM=utils_bitMask(Math.ceil(bitLen(n)/2))+weierstrass_1n;if(k1<weierstrass_0n||k1>=MAX_NUM||k2<weierstrass_0n||k2>=MAX_NUM)throw new Error("splitScalar (endomorphism): failed, k="+k);return{k1neg,k1,k2neg,k2}}(k,endo.basises,Fn.ORDER)}const toAffineMemo=memoized((p,iz)=>{const{X,Y,Z}=p;if(Fp.eql(Z,Fp.ONE))return{x:X,y:Y};const is0=p.is0();null==iz&&(iz=is0?Fp.ONE:Fp.inv(Z));const x=Fp.mul(X,iz),y=Fp.mul(Y,iz),zz=Fp.mul(Z,iz);if(is0)return{x:Fp.ZERO,y:Fp.ZERO};if(!Fp.eql(zz,Fp.ONE))throw new Error("invZ was invalid");return{x,y}}),assertValidMemo=memoized(p=>{if(p.is0()){if(extraOpts.allowInfinityPoint&&!Fp.is0(p.Y))return;throw new Error("bad point: ZERO")}const{x,y}=p.toAffine();if(!Fp.isValid(x)||!Fp.isValid(y))throw new Error("bad point: x or y not field elements");if(!isValidXY(x,y))throw new Error("bad point: equation left != right");if(!p.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});function finishEndo(endoBeta,k1p,k2p,k1neg,k2neg){return k2p=new Point(Fp.mul(k2p.X,endoBeta),k2p.Y,k2p.Z),k1p=negateCt(k1neg,k1p),k2p=negateCt(k2neg,k2p),k1p.add(k2p)}class Point{constructor(X,Y,Z){this.X=acoord("x",X),this.Y=acoord("y",Y,!0),this.Z=acoord("z",Z),Object.freeze(this)}static CURVE(){return CURVE}static fromAffine(p){const{x,y}=p||{};if(!p||!Fp.isValid(x)||!Fp.isValid(y))throw new Error("invalid affine point");if(p instanceof Point)throw new Error("projective point not allowed");return Fp.is0(x)&&Fp.is0(y)?Point.ZERO:new Point(x,y,Fp.ONE)}static fromBytes(bytes){const P=Point.fromAffine(decodePoint(_abytes2(bytes,void 0,"point")));return P.assertValidity(),P}static fromHex(hex){return Point.fromBytes(utils_ensureBytes("pointHex",hex))}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(windowSize=8,isLazy=!0){return wnaf.createCache(this,windowSize),isLazy||this.multiply(weierstrass_3n),this}assertValidity(){assertValidMemo(this)}hasEvenY(){const{y}=this.toAffine();if(!Fp.isOdd)throw new Error("Field doesn't support isOdd");return!Fp.isOdd(y)}equals(other){aprjpoint(other);const{X:X1,Y:Y1,Z:Z1}=this,{X:X2,Y:Y2,Z:Z2}=other,U1=Fp.eql(Fp.mul(X1,Z2),Fp.mul(X2,Z1)),U2=Fp.eql(Fp.mul(Y1,Z2),Fp.mul(Y2,Z1));return U1&&U2}negate(){return new Point(this.X,Fp.neg(this.Y),this.Z)}double(){const{a,b}=CURVE,b3=Fp.mul(b,weierstrass_3n),{X:X1,Y:Y1,Z:Z1}=this;let X3=Fp.ZERO,Y3=Fp.ZERO,Z3=Fp.ZERO,t0=Fp.mul(X1,X1),t1=Fp.mul(Y1,Y1),t2=Fp.mul(Z1,Z1),t3=Fp.mul(X1,Y1);return t3=Fp.add(t3,t3),Z3=Fp.mul(X1,Z1),Z3=Fp.add(Z3,Z3),X3=Fp.mul(a,Z3),Y3=Fp.mul(b3,t2),Y3=Fp.add(X3,Y3),X3=Fp.sub(t1,Y3),Y3=Fp.add(t1,Y3),Y3=Fp.mul(X3,Y3),X3=Fp.mul(t3,X3),Z3=Fp.mul(b3,Z3),t2=Fp.mul(a,t2),t3=Fp.sub(t0,t2),t3=Fp.mul(a,t3),t3=Fp.add(t3,Z3),Z3=Fp.add(t0,t0),t0=Fp.add(Z3,t0),t0=Fp.add(t0,t2),t0=Fp.mul(t0,t3),Y3=Fp.add(Y3,t0),t2=Fp.mul(Y1,Z1),t2=Fp.add(t2,t2),t0=Fp.mul(t2,t3),X3=Fp.sub(X3,t0),Z3=Fp.mul(t2,t1),Z3=Fp.add(Z3,Z3),Z3=Fp.add(Z3,Z3),new Point(X3,Y3,Z3)}add(other){aprjpoint(other);const{X:X1,Y:Y1,Z:Z1}=this,{X:X2,Y:Y2,Z:Z2}=other;let X3=Fp.ZERO,Y3=Fp.ZERO,Z3=Fp.ZERO;const a=CURVE.a,b3=Fp.mul(CURVE.b,weierstrass_3n);let t0=Fp.mul(X1,X2),t1=Fp.mul(Y1,Y2),t2=Fp.mul(Z1,Z2),t3=Fp.add(X1,Y1),t4=Fp.add(X2,Y2);t3=Fp.mul(t3,t4),t4=Fp.add(t0,t1),t3=Fp.sub(t3,t4),t4=Fp.add(X1,Z1);let t5=Fp.add(X2,Z2);return t4=Fp.mul(t4,t5),t5=Fp.add(t0,t2),t4=Fp.sub(t4,t5),t5=Fp.add(Y1,Z1),X3=Fp.add(Y2,Z2),t5=Fp.mul(t5,X3),X3=Fp.add(t1,t2),t5=Fp.sub(t5,X3),Z3=Fp.mul(a,t4),X3=Fp.mul(b3,t2),Z3=Fp.add(X3,Z3),X3=Fp.sub(t1,Z3),Z3=Fp.add(t1,Z3),Y3=Fp.mul(X3,Z3),t1=Fp.add(t0,t0),t1=Fp.add(t1,t0),t2=Fp.mul(a,t2),t4=Fp.mul(b3,t4),t1=Fp.add(t1,t2),t2=Fp.sub(t0,t2),t2=Fp.mul(a,t2),t4=Fp.add(t4,t2),t0=Fp.mul(t1,t4),Y3=Fp.add(Y3,t0),t0=Fp.mul(t5,t4),X3=Fp.mul(t3,X3),X3=Fp.sub(X3,t0),t0=Fp.mul(t3,t1),Z3=Fp.mul(t5,Z3),Z3=Fp.add(Z3,t0),new Point(X3,Y3,Z3)}subtract(other){return this.add(other.negate())}is0(){return this.equals(Point.ZERO)}multiply(scalar){const{endo}=extraOpts;if(!Fn.isValidNot0(scalar))throw new Error("invalid scalar: out of range");let point,fake;const mul=n=>wnaf.cached(this,n,p=>normalizeZ(Point,p));if(endo){const{k1neg,k1,k2neg,k2}=splitEndoScalarN(scalar),{p:k1p,f:k1f}=mul(k1),{p:k2p,f:k2f}=mul(k2);fake=k1f.add(k2f),point=finishEndo(endo.beta,k1p,k2p,k1neg,k2neg)}else{const{p,f}=mul(scalar);point=p,fake=f}return normalizeZ(Point,[point,fake])[0]}multiplyUnsafe(sc){const{endo}=extraOpts,p=this;if(!Fn.isValid(sc))throw new Error("invalid scalar: out of range");if(sc===weierstrass_0n||p.is0())return Point.ZERO;if(sc===weierstrass_1n)return p;if(wnaf.hasCache(this))return this.multiply(sc);if(endo){const{k1neg,k1,k2neg,k2}=splitEndoScalarN(sc),{p1,p2}=function mulEndoUnsafe(Point,point,k1,k2){let acc=point,p1=Point.ZERO,p2=Point.ZERO;for(;k1>curve_0n||k2>curve_0n;)k1&curve_1n&&(p1=p1.add(acc)),k2&curve_1n&&(p2=p2.add(acc)),acc=acc.double(),k1>>=curve_1n,k2>>=curve_1n;return{p1,p2}}(Point,p,k1,k2);return finishEndo(endo.beta,p1,p2,k1neg,k2neg)}return wnaf.unsafe(p,sc)}multiplyAndAddUnsafe(Q,a,b){const sum=this.multiplyUnsafe(a).add(Q.multiplyUnsafe(b));return sum.is0()?void 0:sum}toAffine(invertedZ){return toAffineMemo(this,invertedZ)}isTorsionFree(){const{isTorsionFree}=extraOpts;return cofactor===weierstrass_1n||(isTorsionFree?isTorsionFree(Point,this):wnaf.unsafe(this,CURVE_ORDER).is0())}clearCofactor(){const{clearCofactor}=extraOpts;return cofactor===weierstrass_1n?this:clearCofactor?clearCofactor(Point,this):this.multiplyUnsafe(cofactor)}isSmallOrder(){return this.multiplyUnsafe(cofactor).is0()}toBytes(isCompressed=!0){return _abool2(isCompressed,"isCompressed"),this.assertValidity(),encodePoint(Point,this,isCompressed)}toHex(isCompressed=!0){return(0,esm_utils.My)(this.toBytes(isCompressed))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}get px(){return this.X}get py(){return this.X}get pz(){return this.Z}toRawBytes(isCompressed=!0){return this.toBytes(isCompressed)}_setWindowSize(windowSize){this.precompute(windowSize)}static normalizeZ(points){return normalizeZ(Point,points)}static msm(points,scalars){return function pippenger(c,fieldN,points,scalars){validateMSMPoints(points,c),validateMSMScalars(scalars,fieldN);const plength=points.length,slength=scalars.length;if(plength!==slength)throw new Error("arrays of points and scalars must have equal length");const zero=c.ZERO,wbits=bitLen(BigInt(plength));let windowSize=1;wbits>12?windowSize=wbits-3:wbits>4?windowSize=wbits-2:wbits>0&&(windowSize=2);const MASK=utils_bitMask(windowSize),buckets=new Array(Number(MASK)+1).fill(zero);let sum=zero;for(let i=Math.floor((fieldN.BITS-1)/windowSize)*windowSize;i>=0;i-=windowSize){buckets.fill(zero);for(let j=0;j<slength;j++){const scalar=scalars[j],wbits=Number(scalar>>BigInt(i)&MASK);buckets[wbits]=buckets[wbits].add(points[j])}let resI=zero;for(let j=buckets.length-1,sumI=zero;j>0;j--)sumI=sumI.add(buckets[j]),resI=resI.add(sumI);if(sum=sum.add(resI),0!==i)for(let j=0;j<windowSize;j++)sum=sum.double()}return sum}(Point,Fn,points,scalars)}static fromPrivateKey(privateKey){return Point.BASE.multiply(_normFnElement(Fn,privateKey))}}Point.BASE=new Point(CURVE.Gx,CURVE.Gy,Fp.ONE),Point.ZERO=new Point(Fp.ZERO,Fp.ONE,Fp.ZERO),Point.Fp=Fp,Point.Fn=Fn;const bits=Fn.BITS,wnaf=new wNAF(Point,extraOpts.endo?Math.ceil(bits/2):bits);return Point.BASE.precompute(8),Point}function pprefix(hasEvenY){return Uint8Array.of(hasEvenY?2:3)}function getWLengths(Fp,Fn){return{secretKey:Fn.BYTES,publicKey:1+Fp.BYTES,publicKeyUncompressed:1+2*Fp.BYTES,publicKeyHasPrefix:!0,signature:2*Fn.BYTES}}function ecdh(Point,ecdhOpts={}){const{Fn}=Point,randomBytes_=ecdhOpts.randomBytes||esm_utils.po,lengths=Object.assign(getWLengths(Point.Fp,Fn),{seed:getMinHashLength(Fn.ORDER)});function isValidSecretKey(secretKey){try{return!!_normFnElement(Fn,secretKey)}catch(error){return!1}}function randomSecretKey(seed=randomBytes_(lengths.seed)){return function mapHashToField(key,fieldOrder,isLE=!1){const len=key.length,fieldLen=getFieldBytesLength(fieldOrder),minLen=getMinHashLength(fieldOrder);if(len<16||len<minLen||len>1024)throw new Error("expected "+minLen+"-1024 bytes of input, got "+len);const reduced=mod(isLE?utils_bytesToNumberLE(key):utils_bytesToNumberBE(key),fieldOrder-modular_1n)+modular_1n;return isLE?numberToBytesLE(reduced,fieldLen):numberToBytesBE(reduced,fieldLen)}(_abytes2(seed,lengths.seed,"seed"),Fn.ORDER)}function getPublicKey(secretKey,isCompressed=!0){return Point.BASE.multiply(_normFnElement(Fn,secretKey)).toBytes(isCompressed)}function isProbPub(item){if("bigint"==typeof item)return!1;if(item instanceof Point)return!0;const{secretKey,publicKey,publicKeyUncompressed}=lengths;if(Fn.allowedLengths||secretKey===publicKey)return;const l=utils_ensureBytes("key",item).length;return l===publicKey||l===publicKeyUncompressed}const utils={isValidSecretKey,isValidPublicKey:function isValidPublicKey(publicKey,isCompressed){const{publicKey:comp,publicKeyUncompressed}=lengths;try{const l=publicKey.length;return(!0!==isCompressed||l===comp)&&((!1!==isCompressed||l===publicKeyUncompressed)&&!!Point.fromBytes(publicKey))}catch(error){return!1}},randomSecretKey,isValidPrivateKey:isValidSecretKey,randomPrivateKey:randomSecretKey,normPrivateKeyToScalar:key=>_normFnElement(Fn,key),precompute:(windowSize=8,point=Point.BASE)=>point.precompute(windowSize,!1)};return Object.freeze({getPublicKey,getSharedSecret:function getSharedSecret(secretKeyA,publicKeyB,isCompressed=!0){if(!0===isProbPub(secretKeyA))throw new Error("first arg must be private key");if(!1===isProbPub(publicKeyB))throw new Error("second arg must be public key");const s=_normFnElement(Fn,secretKeyA);return Point.fromHex(publicKeyB).multiply(s).toBytes(isCompressed)},keygen:function keygen(seed){const secretKey=randomSecretKey(seed);return{secretKey,publicKey:getPublicKey(secretKey)}},Point,utils,lengths})}function ecdsa(Point,hash,ecdsaOpts={}){(0,esm_utils.sd)(hash),_validateObject(ecdsaOpts,{},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"});const randomBytes=ecdsaOpts.randomBytes||esm_utils.po,hmac=ecdsaOpts.hmac||((key,...msgs)=>(0,esm_hmac.w)(hash,key,(0,esm_utils.Id)(...msgs))),{Fp,Fn}=Point,{ORDER:CURVE_ORDER,BITS:fnBits}=Fn,{keygen,getPublicKey,getSharedSecret,utils,lengths}=ecdh(Point,ecdsaOpts),defaultSigOpts={prehash:!1,lowS:"boolean"==typeof ecdsaOpts.lowS&&ecdsaOpts.lowS,format:void 0,extraEntropy:!1};function isBiggerThanHalfOrder(number){return number>CURVE_ORDER>>weierstrass_1n}function validateRS(title,num){if(!Fn.isValidNot0(num))throw new Error(`invalid signature ${title}: out of range 1..Point.Fn.ORDER`);return num}class Signature{constructor(r,s,recovery){this.r=validateRS("r",r),this.s=validateRS("s",s),null!=recovery&&(this.recovery=recovery),Object.freeze(this)}static fromBytes(bytes,format="compact"){let recid;if(function validateSigLength(bytes,format){validateSigFormat(format);const size=lengths.signature;return _abytes2(bytes,"compact"===format?size:"recovered"===format?size+1:void 0,`${format} signature`)}(bytes,format),"der"===format){const{r,s}=DER.toSig(_abytes2(bytes));return new Signature(r,s)}"recovered"===format&&(recid=bytes[0],format="compact",bytes=bytes.subarray(1));const L=Fn.BYTES,r=bytes.subarray(0,L),s=bytes.subarray(L,2*L);return new Signature(Fn.fromBytes(r),Fn.fromBytes(s),recid)}static fromHex(hex,format){return this.fromBytes((0,esm_utils.aT)(hex),format)}addRecoveryBit(recovery){return new Signature(this.r,this.s,recovery)}recoverPublicKey(messageHash){const FIELD_ORDER=Fp.ORDER,{r,s,recovery:rec}=this;if(null==rec||![0,1,2,3].includes(rec))throw new Error("recovery id invalid");if(CURVE_ORDER*weierstrass_2n<FIELD_ORDER&&rec>1)throw new Error("recovery id is ambiguous for h>1 curve");const radj=2===rec||3===rec?r+CURVE_ORDER:r;if(!Fp.isValid(radj))throw new Error("recovery id 2 or 3 invalid");const x=Fp.toBytes(radj),R=Point.fromBytes((0,esm_utils.Id)(pprefix(!(1&rec)),x)),ir=Fn.inv(radj),h=bits2int_modN(utils_ensureBytes("msgHash",messageHash)),u1=Fn.create(-h*ir),u2=Fn.create(s*ir),Q=Point.BASE.multiplyUnsafe(u1).add(R.multiplyUnsafe(u2));if(Q.is0())throw new Error("point at infinify");return Q.assertValidity(),Q}hasHighS(){return isBiggerThanHalfOrder(this.s)}toBytes(format="compact"){if(validateSigFormat(format),"der"===format)return(0,esm_utils.aT)(DER.hexFromSig(this));const r=Fn.toBytes(this.r),s=Fn.toBytes(this.s);if("recovered"===format){if(null==this.recovery)throw new Error("recovery bit must be present");return(0,esm_utils.Id)(Uint8Array.of(this.recovery),r,s)}return(0,esm_utils.Id)(r,s)}toHex(format){return(0,esm_utils.My)(this.toBytes(format))}assertValidity(){}static fromCompact(hex){return Signature.fromBytes(utils_ensureBytes("sig",hex),"compact")}static fromDER(hex){return Signature.fromBytes(utils_ensureBytes("sig",hex),"der")}normalizeS(){return this.hasHighS()?new Signature(this.r,Fn.neg(this.s),this.recovery):this}toDERRawBytes(){return this.toBytes("der")}toDERHex(){return(0,esm_utils.My)(this.toBytes("der"))}toCompactRawBytes(){return this.toBytes("compact")}toCompactHex(){return(0,esm_utils.My)(this.toBytes("compact"))}}const bits2int=ecdsaOpts.bits2int||function bits2int_def(bytes){if(bytes.length>8192)throw new Error("input is too large");const num=utils_bytesToNumberBE(bytes),delta=8*bytes.length-fnBits;return delta>0?num>>BigInt(delta):num},bits2int_modN=ecdsaOpts.bits2int_modN||function bits2int_modN_def(bytes){return Fn.create(bits2int(bytes))},ORDER_MASK=utils_bitMask(fnBits);function int2octets(num){return aInRange("num < 2^"+fnBits,num,weierstrass_0n,ORDER_MASK),Fn.toBytes(num)}function validateMsgAndHash(message,prehash){return _abytes2(message,void 0,"message"),prehash?_abytes2(hash(message),void 0,"prehashed message"):message}return Object.freeze({keygen,getPublicKey,getSharedSecret,utils,lengths,Point,sign:function sign(message,secretKey,opts={}){message=utils_ensureBytes("message",message);const{seed,k2sig}=function prepSig(message,privateKey,opts){if(["recovered","canonical"].some(k=>k in opts))throw new Error("sign() legacy options not supported");const{lowS,prehash,extraEntropy}=validateSigOpts(opts,defaultSigOpts);message=validateMsgAndHash(message,prehash);const h1int=bits2int_modN(message),d=_normFnElement(Fn,privateKey),seedArgs=[int2octets(d),int2octets(h1int)];if(null!=extraEntropy&&!1!==extraEntropy){const e=!0===extraEntropy?randomBytes(lengths.secretKey):extraEntropy;seedArgs.push(utils_ensureBytes("extraEntropy",e))}const seed=(0,esm_utils.Id)(...seedArgs),m=h1int;return{seed,k2sig:function k2sig(kBytes){const k=bits2int(kBytes);if(!Fn.isValidNot0(k))return;const ik=Fn.inv(k),q=Point.BASE.multiply(k).toAffine(),r=Fn.create(q.x);if(r===weierstrass_0n)return;const s=Fn.create(ik*Fn.create(m+r*d));if(s===weierstrass_0n)return;let recovery=(q.x===r?0:2)|Number(q.y&weierstrass_1n),normS=s;return lowS&&isBiggerThanHalfOrder(s)&&(normS=Fn.neg(s),recovery^=1),new Signature(r,normS,recovery)}}}(message,secretKey,opts),drbg=function createHmacDrbg(hashLen,qByteLen,hmacFn){if("number"!=typeof hashLen||hashLen<2)throw new Error("hashLen must be a number");if("number"!=typeof qByteLen||qByteLen<2)throw new Error("qByteLen must be a number");if("function"!=typeof hmacFn)throw new Error("hmacFn must be a function");const u8n=len=>new Uint8Array(len),u8of=byte=>Uint8Array.of(byte);let v=u8n(hashLen),k=u8n(hashLen),i=0;const reset=()=>{v.fill(1),k.fill(0),i=0},h=(...b)=>hmacFn(k,v,...b),reseed=(seed=u8n(0))=>{k=h(u8of(0),seed),v=h(),0!==seed.length&&(k=h(u8of(1),seed),v=h())},gen=()=>{if(i++>=1e3)throw new Error("drbg: tried 1000 values");let len=0;const out=[];for(;len<qByteLen;){v=h();const sl=v.slice();out.push(sl),len+=v.length}return(0,esm_utils.Id)(...out)};return(seed,pred)=>{let res;for(reset(),reseed(seed);!(res=pred(gen()));)reseed();return reset(),res}}(hash.outputLen,Fn.BYTES,hmac);return drbg(seed,k2sig)},verify:function verify(signature,message,publicKey,opts={}){const{lowS,prehash,format}=validateSigOpts(opts,defaultSigOpts);if(publicKey=utils_ensureBytes("publicKey",publicKey),message=validateMsgAndHash(utils_ensureBytes("message",message),prehash),"strict"in opts)throw new Error("options.strict was renamed to lowS");const sig=void 0===format?function tryParsingSig(sg){let sig;const isHex="string"==typeof sg||(0,esm_utils.aY)(sg),isObj=!isHex&&null!==sg&&"object"==typeof sg&&"bigint"==typeof sg.r&&"bigint"==typeof sg.s;if(!isHex&&!isObj)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");if(isObj)sig=new Signature(sg.r,sg.s);else if(isHex){try{sig=Signature.fromBytes(utils_ensureBytes("sig",sg),"der")}catch(derError){if(!(derError instanceof DER.Err))throw derError}if(!sig)try{sig=Signature.fromBytes(utils_ensureBytes("sig",sg),"compact")}catch(error){return!1}}return sig||!1}(signature):Signature.fromBytes(utils_ensureBytes("sig",signature),format);if(!1===sig)return!1;try{const P=Point.fromBytes(publicKey);if(lowS&&sig.hasHighS())return!1;const{r,s}=sig,h=bits2int_modN(message),is=Fn.inv(s),u1=Fn.create(h*is),u2=Fn.create(r*is),R=Point.BASE.multiplyUnsafe(u1).add(P.multiplyUnsafe(u2));if(R.is0())return!1;return Fn.create(R.x)===r}catch(e){return!1}},recoverPublicKey:function recoverPublicKey(signature,message,opts={}){const{prehash}=validateSigOpts(opts,defaultSigOpts);return message=validateMsgAndHash(message,prehash),Signature.fromBytes(signature,"recovered").recoverPublicKey(message).toBytes()},Signature,hash})}function _weierstrass_legacy_opts_to_new(c){const CURVE={a:c.a,b:c.b,p:c.Fp.ORDER,n:c.n,h:c.h,Gx:c.Gx,Gy:c.Gy},Fp=c.Fp;let allowedLengths=c.allowedPrivateKeyLengths?Array.from(new Set(c.allowedPrivateKeyLengths.map(l=>Math.ceil(l/2)))):void 0;return{CURVE,curveOpts:{Fp,Fn:Field(CURVE.n,{BITS:c.nBitLength,allowedLengths,modFromBytes:c.wrapPrivateKey}),allowInfinityPoint:c.allowInfinityPoint,endo:c.endo,isTorsionFree:c.isTorsionFree,clearCofactor:c.clearCofactor,fromBytes:c.fromBytes,toBytes:c.toBytes}}}function weierstrass(c){const{CURVE,curveOpts,hash,ecdsaOpts}=function _ecdsa_legacy_opts_to_new(c){const{CURVE,curveOpts}=_weierstrass_legacy_opts_to_new(c),ecdsaOpts={hmac:c.hmac,randomBytes:c.randomBytes,lowS:c.lowS,bits2int:c.bits2int,bits2int_modN:c.bits2int_modN};return{CURVE,curveOpts,hash:c.hash,ecdsaOpts}}(c);return function _ecdsa_new_output_to_legacy(c,_ecdsa){const Point=_ecdsa.Point;return Object.assign({},_ecdsa,{ProjectivePoint:Point,CURVE:Object.assign({},c,modular_nLength(Point.Fn.ORDER,Point.Fn.BITS))})}(c,ecdsa(weierstrassN(CURVE,curveOpts),hash,ecdsaOpts))}function createCurve(curveDef,defHash){const create=hash=>weierstrass({...curveDef,hash});return{...create(defHash),create}}const p256_CURVE={p:BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff"),n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),h:BigInt(1),a:BigInt("0xffffffff00000001000000000000000000000000fffffffffffffffffffffffc"),b:BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5")},p384_CURVE={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000ffffffff"),n:BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffc7634d81f4372ddf581a0db248b0a77aecec196accc52973"),h:BigInt(1),a:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000fffffffc"),b:BigInt("0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef"),Gx:BigInt("0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7"),Gy:BigInt("0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f")},p521_CURVE={p:BigInt("0x1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),n:BigInt("0x01fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffa51868783bf2f966b7fcc0148f709a5d03bb5c9b8899c47aebb6fb71e91386409"),h:BigInt(1),a:BigInt("0x1fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc"),b:BigInt("0x0051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00"),Gx:BigInt("0x00c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66"),Gy:BigInt("0x011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650")},Fp256=Field(p256_CURVE.p),Fp384=Field(p384_CURVE.p),Fp521=Field(p521_CURVE.p);const p256=createCurve({...p256_CURVE,Fp:Fp256,lowS:!1},sha2.sc),p256_p256=(createCurve({...p384_CURVE,Fp:Fp384,lowS:!1},sha2.qt),createCurve({...p521_CURVE,Fp:Fp521,lowS:!1,allowedPrivateKeyLengths:[130,131,132]},sha2.Zf),p256);class BaseError extends Error{constructor(shortMessage,options={}){const details=(()=>{if(options.cause instanceof BaseError){if(options.cause.details)return options.cause.details;if(options.cause.shortMessage)return options.cause.shortMessage}return options.cause?.message?options.cause.message:options.details})(),docsPath=options.cause instanceof BaseError&&options.cause.docsPath||options.docsPath,docs=`https://oxlib.sh${docsPath??""}`,message=[shortMessage||"An error occurred.",...options.metaMessages?["",...options.metaMessages]:[],...details||docsPath?["",details?`Details: ${details}`:void 0,docsPath?`See: ${docs}`:void 0]:[]].filter(x=>"string"==typeof x).join("\n");super(message,options.cause?{cause:options.cause}:void 0),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"cause",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:"ox@0.1.1"}),this.cause=options.cause,this.details=details,this.docs=docs,this.docsPath=docsPath,this.shortMessage=shortMessage}walk(fn){return walk(this,fn)}}function walk(err,fn){return fn?.(err)?err:err&&"object"==typeof err&&"cause"in err&&err.cause?walk(err.cause,fn):fn?null:err}function Json_stringify(value,replacer,space){return JSON.stringify(value,(key,value)=>"function"==typeof replacer?replacer(key,value):"bigint"==typeof value?value.toString()+"#__bigint":value,space)}function assertSize(hex,size_){if(size(hex)>size_)throw new SizeOverflowError({givenSize:size(hex),maxSize:size_})}function hex_pad(hex_,options={}){const{dir,size=32}=options;if(0===size)return hex_;const hex=hex_.replace("0x","");if(hex.length>2*size)throw new SizeExceedsPaddingSizeError({size:Math.ceil(hex.length/2),targetSize:size,type:"Hex"});return`0x${hex["right"===dir?"padEnd":"padStart"](2*size,"0")}`}const encoder=new TextEncoder,hexes=Array.from({length:256},(_v,i)=>i.toString(16).padStart(2,"0"));function Hex_concat(...values){return`0x${values.reduce((acc,x)=>acc+x.replace("0x",""),"")}`}function from(value){return value instanceof Uint8Array?fromBytes(value):Array.isArray(value)?fromBytes(new Uint8Array(value)):value}function fromBytes(value,options={}){let string="";for(let i=0;i<value.length;i++)string+=hexes[value[i]];const hex=`0x${string}`;return"number"==typeof options.size?(assertSize(hex,options.size),padRight(hex,options.size)):hex}function fromNumber(value,options={}){const{signed,size}=options,value_=BigInt(value);let maxValue;size?maxValue=signed?(1n<<8n*BigInt(size)-1n)-1n:2n**(8n*BigInt(size))-1n:"number"==typeof value&&(maxValue=BigInt(Number.MAX_SAFE_INTEGER));const minValue="bigint"==typeof maxValue&&signed?-maxValue-1n:0;if(maxValue&&value_>maxValue||value_<minValue){const suffix="bigint"==typeof value?"n":"";throw new IntegerOutOfRangeError({max:maxValue?`${maxValue}${suffix}`:void 0,min:`${minValue}${suffix}`,signed,size,value:`${value}${suffix}`})}const hex=`0x${(signed&&value_<0?(1n<<BigInt(8*size))+BigInt(value_):value_).toString(16)}`;return size?padLeft(hex,size):hex}function fromString(value,options={}){return fromBytes(encoder.encode(value),options)}function padLeft(value,size){return hex_pad(value,{dir:"left",size})}function padRight(value,size){return hex_pad(value,{dir:"right",size})}function slice(value,start,end,options={}){const{strict}=options;!function assertStartOffset(value,start){if("number"==typeof start&&start>0&&start>size(value)-1)throw new SliceOffsetOutOfBoundsError({offset:start,position:"start",size:size(value)})}(value,start);const value_=`0x${value.replace("0x","").slice(2*(start??0),2*(end??value.length))}`;return strict&&function assertEndOffset(value,start,end){if("number"==typeof start&&"number"==typeof end&&size(value)!==end-start)throw new SliceOffsetOutOfBoundsError({offset:end,position:"end",size:size(value)})}(value_,start,end),value_}function size(value){return Math.ceil((value.length-2)/2)}function toBigInt(hex,options={}){const{signed}=options;options.size&&assertSize(hex,options.size);const value=BigInt(hex);if(!signed)return value;const size=(hex.length-2)/2,max_unsigned=(1n<<8n*BigInt(size))-1n;return value<=max_unsigned>>1n?value:value-max_unsigned-1n}function validate(value,options={}){const{strict=!1}=options;try{return function assert(value,options={}){const{strict=!1}=options;if(!value)throw new InvalidHexTypeError(value);if("string"!=typeof value)throw new InvalidHexTypeError(value);if(strict&&!/^0x[0-9a-fA-F]*$/.test(value))throw new InvalidHexValueError(value);if(!value.startsWith("0x"))throw new InvalidHexValueError(value)}(value,{strict}),!0}catch{return!1}}class IntegerOutOfRangeError extends BaseError{constructor({max,min,signed,size,value}){super(`Number \`${value}\` is not in safe${size?` ${8*size}-bit`:""}${signed?" signed":" unsigned"} integer range ${max?`(\`${min}\` to \`${max}\`)`:`(above \`${min}\`)`}`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.IntegerOutOfRangeError"})}}class InvalidHexTypeError extends BaseError{constructor(value){super(`Value \`${"object"==typeof value?Json_stringify(value):value}\` of type \`${typeof value}\` is an invalid hex type.`,{metaMessages:['Hex types must be represented as `"0x${string}"`.']}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.InvalidHexTypeError"})}}class InvalidHexValueError extends BaseError{constructor(value){super(`Value \`${value}\` is an invalid hex value.`,{metaMessages:['Hex values must start with `"0x"` and contain only hexadecimal characters (0-9, a-f, A-F).']}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.InvalidHexValueError"})}}class SizeOverflowError extends BaseError{constructor({givenSize,maxSize}){super(`Size cannot exceed \`${maxSize}\` bytes. Given size: \`${givenSize}\` bytes.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.SizeOverflowError"})}}class SliceOffsetOutOfBoundsError extends BaseError{constructor({offset,position,size}){super(`Slice ${"start"===position?"starting":"ending"} at offset \`${offset}\` is out-of-bounds (size: \`${size}\`).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.SliceOffsetOutOfBoundsError"})}}class SizeExceedsPaddingSizeError extends BaseError{constructor({size,targetSize,type}){super(`${type.charAt(0).toUpperCase()}${type.slice(1).toLowerCase()} size (\`${size}\`) exceeds padding size (\`${targetSize}\`).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.SizeExceedsPaddingSizeError"})}}const charCodeMap_zero=48,charCodeMap_nine=57,charCodeMap_A=65,charCodeMap_F=70,charCodeMap_a=97,charCodeMap_f=102;function charCodeToBase16(char){return char>=charCodeMap_zero&&char<=charCodeMap_nine?char-charCodeMap_zero:char>=charCodeMap_A&&char<=charCodeMap_F?char-(charCodeMap_A-10):char>=charCodeMap_a&&char<=charCodeMap_f?char-(charCodeMap_a-10):void 0}function Bytes_from(value){return value instanceof Uint8Array?value:"string"==typeof value?Bytes_fromHex(value):fromArray(value)}function fromArray(value){return value instanceof Uint8Array?value:new Uint8Array(value)}function Bytes_fromHex(value,options={}){const{size}=options;let hex=value;size&&(assertSize(value,size),hex=padRight(value,size));let hexString=hex.slice(2);hexString.length%2&&(hexString=`0${hexString}`);const length=hexString.length/2,bytes=new Uint8Array(length);for(let index=0,j=0;index<length;index++){const nibbleLeft=charCodeToBase16(hexString.charCodeAt(j++)),nibbleRight=charCodeToBase16(hexString.charCodeAt(j++));if(void 0===nibbleLeft||void 0===nibbleRight)throw new BaseError(`Invalid byte sequence ("${hexString[j-2]}${hexString[j-1]}" in "${hexString}").`);bytes[index]=16*nibbleLeft+nibbleRight}return bytes}function Bytes_size(value){return value.length}function Bytes_slice(value,start,end,options={}){const{strict}=options;!function bytes_assertStartOffset(value,start){if("number"==typeof start&&start>0&&start>Bytes_size(value)-1)throw new Bytes_SliceOffsetOutOfBoundsError({offset:start,position:"start",size:Bytes_size(value)})}(value,start);const value_=value.slice(start,end);return strict&&function bytes_assertEndOffset(value,start,end){if("number"==typeof start&&"number"==typeof end&&Bytes_size(value)!==end-start)throw new Bytes_SliceOffsetOutOfBoundsError({offset:end,position:"end",size:Bytes_size(value)})}(value_,start,end),value_}function Bytes_toBigInt(bytes,options={}){const{size}=options;void 0!==size&&function bytes_assertSize(bytes,size_){if(Bytes_size(bytes)>size_)throw new Bytes_SizeOverflowError({givenSize:Bytes_size(bytes),maxSize:size_})}(bytes,size);return toBigInt(fromBytes(bytes,options),options)}function Bytes_validate(value){try{return function Bytes_assert(value){if(!(value instanceof Uint8Array)){if(!value)throw new InvalidBytesTypeError(value);if("object"!=typeof value)throw new InvalidBytesTypeError(value);if(!("BYTES_PER_ELEMENT"in value))throw new InvalidBytesTypeError(value);if(1!==value.BYTES_PER_ELEMENT||"Uint8Array"!==value.constructor.name)throw new InvalidBytesTypeError(value)}}(value),!0}catch{return!1}}class InvalidBytesTypeError extends BaseError{constructor(value){super(`Value \`${"object"==typeof value?Json_stringify(value):value}\` of type \`${typeof value}\` is an invalid Bytes value.`,{metaMessages:["Bytes values must be of type `Bytes`."]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Bytes.InvalidBytesTypeError"})}}class Bytes_SizeOverflowError extends BaseError{constructor({givenSize,maxSize}){super(`Size cannot exceed \`${maxSize}\` bytes. Given size: \`${givenSize}\` bytes.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Bytes.SizeOverflowError"})}}class Bytes_SliceOffsetOutOfBoundsError extends BaseError{constructor({offset,position,size}){super(`Slice ${"start"===position?"starting":"ending"} at offset \`${offset}\` is out-of-bounds (size: \`${size}\`).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Bytes.SliceOffsetOutOfBoundsError"})}}function PublicKey_assert(publicKey,options={}){const{compressed}=options,{prefix,x,y}=publicKey;if(!1===compressed||"bigint"==typeof x&&"bigint"==typeof y){if(4!==prefix)throw new InvalidPrefixError({prefix,cause:new InvalidUncompressedPrefixError})}else{if(!0!==compressed&&("bigint"!=typeof x||void 0!==y))throw new InvalidError({publicKey});if(3!==prefix&&2!==prefix)throw new InvalidPrefixError({prefix,cause:new InvalidCompressedPrefixError})}}function PublicKey_from(value){const publicKey=(()=>{if(validate(value))return PublicKey_fromHex(value);if(Bytes_validate(value))return function PublicKey_fromBytes(publicKey){return PublicKey_fromHex(fromBytes(publicKey))}(value);const{prefix,x,y}=value;return"bigint"==typeof x&&"bigint"==typeof y?{prefix:prefix??4,x,y}:{prefix,x}})();return PublicKey_assert(publicKey),publicKey}function PublicKey_fromHex(publicKey){if(132!==publicKey.length&&130!==publicKey.length&&68!==publicKey.length)throw new InvalidSerializedSizeError({publicKey});if(130===publicKey.length){return{prefix:4,x:BigInt(slice(publicKey,0,32)),y:BigInt(slice(publicKey,32,64))}}if(132===publicKey.length){return{prefix:Number(slice(publicKey,0,1)),x:BigInt(slice(publicKey,1,33)),y:BigInt(slice(publicKey,33,65))}}return{prefix:Number(slice(publicKey,0,1)),x:BigInt(slice(publicKey,1,33))}}function PublicKey_toHex(publicKey,options={}){PublicKey_assert(publicKey);const{prefix,x,y}=publicKey,{includePrefix=!0}=options;return Hex_concat(includePrefix?fromNumber(prefix,{size:1}):"0x",fromNumber(x,{size:32}),"bigint"==typeof y?fromNumber(y,{size:32}):"0x")}class InvalidError extends BaseError{constructor({publicKey}){super(`Value \`${Json_stringify(publicKey)}\` is not a valid public key.`,{metaMessages:["Public key must contain:","- an `x` and `prefix` value (compressed)","- an `x`, `y`, and `prefix` value (uncompressed)"]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidError"})}}class InvalidPrefixError extends BaseError{constructor({prefix,cause}){super(`Prefix "${prefix}" is invalid.`,{cause}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidPrefixError"})}}class InvalidCompressedPrefixError extends BaseError{constructor(){super("Prefix must be 2 or 3 for compressed public keys."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidCompressedPrefixError"})}}class InvalidUncompressedPrefixError extends BaseError{constructor(){super("Prefix must be 4 for uncompressed public keys."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidUncompressedPrefixError"})}}class InvalidSerializedSizeError extends BaseError{constructor({publicKey}){super(`Value \`${publicKey}\` is an invalid public key size.`,{metaMessages:["Expected: 33 bytes (compressed + prefix), 64 bytes (uncompressed) or 65 bytes (uncompressed + prefix).",`Received ${size(from(publicKey))} bytes.`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidSerializedSizeError"})}}const Base64_decoder=new TextDecoder,integerToCharacter=Object.fromEntries(Array.from("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/").map((a,i)=>[i,a.charCodeAt(0)]));Object.fromEntries(Array.from("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/").map((a,i)=>[a.charCodeAt(0),i])),"=".charCodeAt(0),"-".charCodeAt(0),"_".charCodeAt(0);function Base64_fromBytes(value,options={}){const{pad=!0,url=!1}=options,encoded=new Uint8Array(4*Math.ceil(value.length/3));for(let i=0,j=0;j<value.length;i+=4,j+=3){const y=(value[j]<<16)+(value[j+1]<<8)+(0|value[j+2]);encoded[i]=integerToCharacter[y>>18],encoded[i+1]=integerToCharacter[y>>12&63],encoded[i+2]=integerToCharacter[y>>6&63],encoded[i+3]=integerToCharacter[63&y]}const k=value.length%3,end=4*Math.floor(value.length/3)+(k&&k+1);let base64=Base64_decoder.decode(new Uint8Array(encoded.buffer,0,end));return pad&&1===k&&(base64+="=="),pad&&2===k&&(base64+="="),url&&(base64=base64.replaceAll("+","-").replaceAll("/","_")),base64}function Base64_fromHex(value,options={}){return Base64_fromBytes(Bytes_fromHex(value),options)}var esm_sha256=__webpack_require__("./node_modules/@noble/hashes/esm/sha256.js");function Hash_sha256(value,options={}){const{as="string"==typeof value?"Hex":"Bytes"}=options,bytes=(0,esm_sha256.sc)(Bytes_from(value));return"Bytes"===as?bytes:fromBytes(bytes)}Uint8Array.from([105,171,180,181,160,222,75,198,42,42,32,31,141,37,186,233]);function getSignPayload(options){const{challenge,crossOrigin,extraClientData,flag,origin,rpId,signCount,userVerification="required"}=options,authenticatorData=function getAuthenticatorData(options={}){const{flag=5,rpId=window.location.hostname,signCount=0}=options;return Hex_concat(Hash_sha256(fromString(rpId)),fromNumber(flag,{size:1}),fromNumber(signCount,{size:4}))}({flag,rpId,signCount}),clientDataJSON=function getClientDataJSON(options){const{challenge,crossOrigin=!1,extraClientData,origin=window.location.origin}=options;return JSON.stringify({type:"webauthn.get",challenge:Base64_fromHex(challenge,{url:!0,pad:!1}),origin,crossOrigin,...extraClientData})}({challenge,crossOrigin,extraClientData,origin}),clientDataJSONHash=Hash_sha256(fromString(clientDataJSON)),challengeIndex=clientDataJSON.indexOf('"challenge"'),typeIndex=clientDataJSON.indexOf('"type"');return{metadata:{authenticatorData,clientDataJSON,challengeIndex,typeIndex,userVerificationRequired:"required"===userVerification},payload:Hex_concat(authenticatorData,clientDataJSONHash)}}const maxUint256=2n**256n-1n;function Signature_assert(signature,options={}){const{recovered}=options;if(void 0===signature.r)throw new MissingPropertiesError({signature});if(void 0===signature.s)throw new MissingPropertiesError({signature});if(recovered&&void 0===signature.yParity)throw new MissingPropertiesError({signature});if(signature.r<0n||signature.r>maxUint256)throw new InvalidRError({value:signature.r});if(signature.s<0n||signature.s>maxUint256)throw new InvalidSError({value:signature.s});if("number"==typeof signature.yParity&&0!==signature.yParity&&1!==signature.yParity)throw new InvalidYParityError({value:signature.yParity})}function Signature_fromHex(signature){if(130!==signature.length&&132!==signature.length)throw new Signature_InvalidSerializedSizeError({signature});const r=BigInt(slice(signature,0,32)),s=BigInt(slice(signature,32,64)),yParity=(()=>{const yParity=Number(`0x${signature.slice(130)}`);if(!Number.isNaN(yParity))try{return vToYParity(yParity)}catch{throw new InvalidYParityError({value:yParity})}})();return void 0===yParity?{r,s}:{r,s,yParity}}function Signature_toHex(signature){Signature_assert(signature);const r=signature.r,s=signature.s;return Hex_concat(fromNumber(r,{size:32}),fromNumber(s,{size:32}),"number"==typeof signature.yParity?fromNumber(yParityToV(signature.yParity),{size:1}):"0x")}function vToYParity(v){if(0===v||27===v)return 0;if(1===v||28===v)return 1;if(v>=35)return v%2==0?1:0;throw new InvalidVError({value:v})}function yParityToV(yParity){if(0===yParity)return 27;if(1===yParity)return 28;throw new InvalidYParityError({value:yParity})}class Signature_InvalidSerializedSizeError extends BaseError{constructor({signature}){super(`Value \`${signature}\` is an invalid signature size.`,{metaMessages:["Expected: 64 bytes or 65 bytes.",`Received ${size(from(signature))} bytes.`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Signature.InvalidSerializedSizeError"})}}class MissingPropertiesError extends BaseError{constructor({signature}){super(`Signature \`${Json_stringify(signature)}\` is missing either an \`r\`, \`s\`, or \`yParity\` property.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Signature.MissingPropertiesError"})}}class InvalidRError extends BaseError{constructor({value}){super(`Value \`${value}\` is an invalid r value. r must be a positive integer less than 2^256.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Signature.InvalidRError"})}}class InvalidSError extends BaseError{constructor({value}){super(`Value \`${value}\` is an invalid s value. s must be a positive integer less than 2^256.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Signature.InvalidSError"})}}class InvalidYParityError extends BaseError{constructor({value}){super(`Value \`${value}\` is an invalid y-parity value. Y-parity must be 0 or 1.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Signature.InvalidYParityError"})}}class InvalidVError extends BaseError{constructor({value}){super(`Value \`${value}\` is an invalid v value. v must be 27, 28 or >=35.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Signature.InvalidVError"})}}var hashMessage=__webpack_require__("./node_modules/viem/_esm/utils/signature/hashMessage.js"),hashTypedData=__webpack_require__("./node_modules/viem/_esm/utils/signature/hashTypedData.js");function promisifyRequest(request){return new Promise((resolve,reject)=>{request.oncomplete=request.onsuccess=()=>resolve(request.result),request.onabort=request.onerror=()=>reject(request.error)})}function dist_createStore(dbName,storeName){const request=indexedDB.open(dbName);request.onupgradeneeded=()=>request.result.createObjectStore(storeName);const dbp=promisifyRequest(request);return(txMode,callback)=>dbp.then(db=>callback(db.transaction(storeName,txMode).objectStore(storeName)))}let defaultGetStoreFunc;function defaultGetStore(){return defaultGetStoreFunc||(defaultGetStoreFunc=dist_createStore("keyval-store","keyval")),defaultGetStoreFunc}const storage=function createStorage(scope,name){const store="undefined"!=typeof indexedDB?dist_createStore(scope,name):void 0;return{getItem:async key=>{const value=await function get(key,customStore=defaultGetStore()){return customStore("readonly",store=>promisifyRequest(store.get(key)))}(key,store);return value||null},removeItem:async key=>function del(key,customStore=defaultGetStore()){return customStore("readwrite",store=>(store.delete(key),promisifyRequest(store.transaction)))}(key,store),setItem:async(key,value)=>function set(key,value,customStore=defaultGetStore()){return customStore("readwrite",store=>(store.put(value,key),promisifyRequest(store.transaction)))}(key,value,store)}}("cbwsdk","keys");async function crypto_key_generateKeyPair(){const keypair=await async function createKeyPair(options={}){const{extractable=!1}=options,keypair=await globalThis.crypto.subtle.generateKey({name:"ECDSA",namedCurve:"P-256"},extractable,["sign","verify"]),publicKey_raw=await globalThis.crypto.subtle.exportKey("raw",keypair.publicKey),publicKey=PublicKey_from(new Uint8Array(publicKey_raw));return{privateKey:keypair.privateKey,publicKey}}({extractable:!1}),publicKey=slice(PublicKey_toHex(keypair.publicKey),1);return await storage.setItem(publicKey,keypair),await storage.setItem("activeId",publicKey),keypair}async function getKeypair(){const id=await storage.getItem("activeId");if(!id)return null;const keypair=await storage.getItem(id);return keypair||null}async function getAccount(){const keypair=await async function getOrCreateKeypair(){const keypair=await getKeypair();if(!keypair){const kp=await crypto_key_generateKeyPair(),pubKey=slice(PublicKey_toHex(kp.publicKey),1);return await storage.setItem(pubKey,kp),await storage.setItem("activeId",pubKey),kp}return keypair}(),publicKey=slice(PublicKey_toHex(keypair.publicKey),1),sign=async payload=>{const{payload:message,metadata}=getSignPayload({challenge:payload,origin:"https://keys.coinbase.com",userVerification:"preferred"}),signature=await async function WebCryptoP256_sign(options){const{payload,privateKey}=options,signature=await globalThis.crypto.subtle.sign({name:"ECDSA",hash:"SHA-256"},privateKey,Bytes_from(payload)),signature_bytes=fromArray(new Uint8Array(signature)),r=Bytes_toBigInt(Bytes_slice(signature_bytes,0,32));let s=Bytes_toBigInt(Bytes_slice(signature_bytes,32,64));return s>p256_p256.CURVE.n/2n&&(s=p256_p256.CURVE.n-s),{r,s}}({payload:message,privateKey:keypair.privateKey});return{signature:Signature_toHex(signature),raw:{},webauthn:metadata}};return{id:publicKey,publicKey,sign:async({hash})=>sign(hash),signMessage:async({message})=>sign((0,hashMessage.A)(message)),signTypedData:async parameters=>sign((0,hashTypedData.Zh)(parameters)),type:"webAuthn"}}async function getCryptoKeyAccount(){return{account:await getAccount()}}const OWN_PRIVATE_KEY={storageKey:"ownPrivateKey",keyType:"private"},OWN_PUBLIC_KEY={storageKey:"ownPublicKey",keyType:"public"},PEER_PUBLIC_KEY={storageKey:"peerPublicKey",keyType:"public"};class SCWKeyManager{constructor(){this.ownPrivateKey=null,this.ownPublicKey=null,this.peerPublicKey=null,this.sharedSecret=null}async getOwnPublicKey(){return await this.loadKeysIfNeeded(),this.ownPublicKey}async getSharedSecret(){return await this.loadKeysIfNeeded(),this.sharedSecret}async setPeerPublicKey(key){this.sharedSecret=null,this.peerPublicKey=key,await this.storeKey(PEER_PUBLIC_KEY,key),await this.loadKeysIfNeeded()}async clear(){this.ownPrivateKey=null,this.ownPublicKey=null,this.peerPublicKey=null,this.sharedSecret=null,store.keys.clear()}async generateKeyPair(){const newKeyPair=await async function generateKeyPair(){return crypto.subtle.generateKey({name:"ECDH",namedCurve:"P-256"},!0,["deriveKey"])}();this.ownPrivateKey=newKeyPair.privateKey,this.ownPublicKey=newKeyPair.publicKey,await this.storeKey(OWN_PRIVATE_KEY,newKeyPair.privateKey),await this.storeKey(OWN_PUBLIC_KEY,newKeyPair.publicKey)}async loadKeysIfNeeded(){if(null===this.ownPrivateKey&&(this.ownPrivateKey=await this.loadKey(OWN_PRIVATE_KEY)),null===this.ownPublicKey&&(this.ownPublicKey=await this.loadKey(OWN_PUBLIC_KEY)),null!==this.ownPrivateKey&&null!==this.ownPublicKey||await this.generateKeyPair(),null===this.peerPublicKey&&(this.peerPublicKey=await this.loadKey(PEER_PUBLIC_KEY)),null===this.sharedSecret){if(null===this.ownPrivateKey||null===this.peerPublicKey)return;this.sharedSecret=await async function deriveSharedSecret(ownPrivateKey,peerPublicKey){return crypto.subtle.deriveKey({name:"ECDH",public:peerPublicKey},ownPrivateKey,{name:"AES-GCM",length:256},!1,["encrypt","decrypt"])}(this.ownPrivateKey,this.peerPublicKey)}}async loadKey(item){const key=store.keys.get(item.storageKey);return key?importKeyFromHexString(item.keyType,key):null}async storeKey(item,key){const hexString=await exportKeyToHexString(item.keyType,key);store.keys.set(item.storageKey,hexString)}}var data_slice=__webpack_require__("./node_modules/viem/_esm/utils/data/slice.js"),hash_keccak256=__webpack_require__("./node_modules/viem/_esm/utils/hash/keccak256.js");function get_get(obj,path){if("object"==typeof obj&&null!==obj)return path.split(/[.[\]]+/).filter(Boolean).reduce((value,key)=>{if("object"==typeof value&&null!==value)return value[key]},obj)}var waitForCallsStatus=__webpack_require__("./node_modules/viem/_esm/actions/wallet/waitForCallsStatus.js");function getSenderFromRequest(request){var _a;if(!Array.isArray(request.params))return null;switch(request.method){case"personal_sign":return request.params[1];case"eth_signTypedData_v4":return request.params[0];case"eth_signTransaction":case"eth_sendTransaction":case"wallet_sendCalls":return null===(_a=request.params[0])||void 0===_a?void 0:_a.from;default:return null}}function assertParamsChainId(params){var _a;if(!params||!Array.isArray(params)||!(null===(_a=params[0])||void 0===_a?void 0:_a.chainId))throw errors_standardErrors.rpc.invalidParams();if("string"!=typeof params[0].chainId&&"number"!=typeof params[0].chainId)throw errors_standardErrors.rpc.invalidParams()}function injectRequestCapabilities(request,capabilities){const modifiedRequest=Object.assign({},request);if(capabilities&&request.method.startsWith("wallet_")){let requestCapabilities=get_get(modifiedRequest,"params.0.capabilities");if(void 0===requestCapabilities&&(requestCapabilities={}),"object"!=typeof requestCapabilities)throw errors_standardErrors.rpc.invalidParams();requestCapabilities=Object.assign(Object.assign({},capabilities),requestCapabilities),modifiedRequest.params&&Array.isArray(modifiedRequest.params)&&(modifiedRequest.params[0]=Object.assign(Object.assign({},modifiedRequest.params[0]),{capabilities:requestCapabilities}))}return modifiedRequest}async function initSubAccountConfig(){var _a;const config=null!==(_a=store.subAccountsConfig.get())&&void 0!==_a?_a:{},capabilities={};if(config.enableAutoSubAccounts){const{account:owner}=config.toOwnerAccount?await config.toOwnerAccount():await getCryptoKeyAccount();if(!owner)throw errors_standardErrors.provider.unauthorized("No owner account found");capabilities.addSubAccount={account:{type:"create",keys:[{type:owner.address?"address":"webauthn-p256",publicKey:owner.address||owner.publicKey}]}}}store.subAccountsConfig.set({capabilities})}async function waitForCallsTransactionHash({client,id}){var _a;const result=await(0,waitForCallsStatus.c)(client,{id});if("success"===result.status)return null===(_a=result.receipts)||void 0===_a?void 0:_a[0].transactionHash;throw errors_standardErrors.rpc.internal("failed to send transaction")}function createWalletSendCallsRequest({calls,from,chainId,capabilities}){const paymasterUrls=config.get().paymasterUrls;let request={method:"wallet_sendCalls",params:[{version:"1.0",calls,chainId:(0,toHex.cK)(chainId),from,atomicRequired:!0,capabilities}]};return(null==paymasterUrls?void 0:paymasterUrls[chainId])&&(request=injectRequestCapabilities(request,{paymasterService:{url:null==paymasterUrls?void 0:paymasterUrls[chainId]}})),request}function makeDataSuffix({attribution,dappOrigin}){if(attribution)return"auto"in attribution&&attribution.auto&&dappOrigin?function compute16ByteHash(input){return(0,data_slice.di)((0,hash_keccak256.S)((0,toHex.nj)(input)),0,16)}(dappOrigin):"dataSuffix"in attribution?attribution.dataSuffix:void 0}function prependWithoutDuplicates(array,item){const filtered=array.filter(i=>i!==item);return[item,...filtered]}function appendWithoutDuplicates(array,item){const filtered=array.filter(i=>i!==item);return[...filtered,item]}var encoding_toBytes=__webpack_require__("./node_modules/viem/_esm/utils/encoding/toBytes.js"),data_trim=__webpack_require__("./node_modules/viem/_esm/utils/data/trim.js");function arrayBufferToBase64Url(buffer){return function base64ToBase64Url(base64){return base64.replaceAll("+","-").replaceAll("/","_").replace(/=+$/,"")}(btoa(String.fromCharCode(...new Uint8Array(buffer))))}function convertCredentialToJSON({webauthn,signature,id}){const signatureRaw=Signature_fromHex(signature);return{id,rawId:arrayBufferToBase64Url((0,encoding_toBytes.Af)(id)),response:{authenticatorData:arrayBufferToBase64Url((0,encoding_toBytes.aT)(webauthn.authenticatorData)),clientDataJSON:arrayBufferToBase64Url((0,encoding_toBytes.Af)(webauthn.clientDataJSON)),signature:arrayBufferToBase64Url(asn1EncodeSignature(signatureRaw.r,signatureRaw.s))},type:JSON.parse(webauthn.clientDataJSON).type}}function asn1EncodeSignature(r,s){const rBytes=(0,encoding_toBytes.aT)((0,data_trim.B)((0,toHex.cK)(r))),sBytes=(0,encoding_toBytes.aT)((0,data_trim.B)((0,toHex.cK)(s))),rLength=rBytes.length,sLength=sBytes.length,totalLength=rLength+sLength+4,signature=new Uint8Array(totalLength+2);return signature[0]=48,signature[1]=totalLength,signature[2]=2,signature[3]=rLength,signature.set(rBytes,4),signature[rLength+4]=2,signature[rLength+5]=sLength,signature.set(sBytes,rLength+6),signature}var decodeFunctionData=__webpack_require__("./node_modules/viem/_esm/utils/abi/decodeFunctionData.js"),encodeAbiParameters=__webpack_require__("./node_modules/viem/_esm/utils/abi/encodeAbiParameters.js"),data_size=__webpack_require__("./node_modules/viem/_esm/utils/data/size.js"),esm_secp256k1=__webpack_require__("./node_modules/viem/node_modules/@noble/curves/esm/secp256k1.js");var errors_abi=__webpack_require__("./node_modules/viem/_esm/errors/abi.js"),errors_address=__webpack_require__("./node_modules/viem/_esm/errors/address.js"),regex=__webpack_require__("./node_modules/viem/_esm/utils/regex.js");function encode(type,value,isArray=!1){if("address"===type){const address=value;if(!(0,isAddress.P)(address))throw new errors_address.M({address});return(0,pad.eV)(address.toLowerCase(),{size:isArray?32:null})}if("string"===type)return(0,toHex.i3)(value);if("bytes"===type)return value;if("bool"===type)return(0,pad.eV)((0,toHex.$P)(value),{size:isArray?32:1});const intMatch=type.match(regex.Ge);if(intMatch){const[_type,baseType,bits="256"]=intMatch,size=Number.parseInt(bits,10)/8;return(0,toHex.cK)(value,{size:isArray?32:size,signed:"int"===baseType})}const bytesMatch=type.match(regex.BD);if(bytesMatch){const[_type,size]=bytesMatch;if(Number.parseInt(size,10)!==(value.length-2)/2)throw new errors_abi.BI({expectedSize:Number.parseInt(size,10),givenSize:(value.length-2)/2});return(0,pad.eV)(value,{dir:"right",size:isArray?32:null})}const arrayMatch=type.match(regex.D5);if(arrayMatch&&Array.isArray(value)){const[_type,childType]=arrayMatch,data=[];for(let i=0;i<value.length;i++)data.push(encode(childType,value[i],!0));return 0===data.length?"0x":(0,concat.aP)(data)}throw new errors_abi.Wl(type)}const entryPoint06Abi=[{inputs:[{name:"preOpGas",type:"uint256"},{name:"paid",type:"uint256"},{name:"validAfter",type:"uint48"},{name:"validUntil",type:"uint48"},{name:"targetSuccess",type:"bool"},{name:"targetResult",type:"bytes"}],name:"ExecutionResult",type:"error"},{inputs:[{name:"opIndex",type:"uint256"},{name:"reason",type:"string"}],name:"FailedOp",type:"error"},{inputs:[{name:"sender",type:"address"}],name:"SenderAddressResult",type:"error"},{inputs:[{name:"aggregator",type:"address"}],name:"SignatureValidationFailed",type:"error"},{inputs:[{components:[{name:"preOpGas",type:"uint256"},{name:"prefund",type:"uint256"},{name:"sigFailed",type:"bool"},{name:"validAfter",type:"uint48"},{name:"validUntil",type:"uint48"},{name:"paymasterContext",type:"bytes"}],name:"returnInfo",type:"tuple"},{components:[{name:"stake",type:"uint256"},{name:"unstakeDelaySec",type:"uint256"}],name:"senderInfo",type:"tuple"},{components:[{name:"stake",type:"uint256"},{name:"unstakeDelaySec",type:"uint256"}],name:"factoryInfo",type:"tuple"},{components:[{name:"stake",type:"uint256"},{name:"unstakeDelaySec",type:"uint256"}],name:"paymasterInfo",type:"tuple"}],name:"ValidationResult",type:"error"},{inputs:[{components:[{name:"preOpGas",type:"uint256"},{name:"prefund",type:"uint256"},{name:"sigFailed",type:"bool"},{name:"validAfter",type:"uint48"},{name:"validUntil",type:"uint48"},{name:"paymasterContext",type:"bytes"}],name:"returnInfo",type:"tuple"},{components:[{name:"stake",type:"uint256"},{name:"unstakeDelaySec",type:"uint256"}],name:"senderInfo",type:"tuple"},{components:[{name:"stake",type:"uint256"},{name:"unstakeDelaySec",type:"uint256"}],name:"factoryInfo",type:"tuple"},{components:[{name:"stake",type:"uint256"},{name:"unstakeDelaySec",type:"uint256"}],name:"paymasterInfo",type:"tuple"},{components:[{name:"aggregator",type:"address"},{components:[{name:"stake",type:"uint256"},{name:"unstakeDelaySec",type:"uint256"}],name:"stakeInfo",type:"tuple"}],name:"aggregatorInfo",type:"tuple"}],name:"ValidationResultWithAggregation",type:"error"},{anonymous:!1,inputs:[{indexed:!0,name:"userOpHash",type:"bytes32"},{indexed:!0,name:"sender",type:"address"},{indexed:!1,name:"factory",type:"address"},{indexed:!1,name:"paymaster",type:"address"}],name:"AccountDeployed",type:"event"},{anonymous:!1,inputs:[],name:"BeforeExecution",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"account",type:"address"},{indexed:!1,name:"totalDeposit",type:"uint256"}],name:"Deposited",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"aggregator",type:"address"}],name:"SignatureAggregatorChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"account",type:"address"},{indexed:!1,name:"totalStaked",type:"uint256"},{indexed:!1,name:"unstakeDelaySec",type:"uint256"}],name:"StakeLocked",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"account",type:"address"},{indexed:!1,name:"withdrawTime",type:"uint256"}],name:"StakeUnlocked",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"account",type:"address"},{indexed:!1,name:"withdrawAddress",type:"address"},{indexed:!1,name:"amount",type:"uint256"}],name:"StakeWithdrawn",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"userOpHash",type:"bytes32"},{indexed:!0,name:"sender",type:"address"},{indexed:!0,name:"paymaster",type:"address"},{indexed:!1,name:"nonce",type:"uint256"},{indexed:!1,name:"success",type:"bool"},{indexed:!1,name:"actualGasCost",type:"uint256"},{indexed:!1,name:"actualGasUsed",type:"uint256"}],name:"UserOperationEvent",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"userOpHash",type:"bytes32"},{indexed:!0,name:"sender",type:"address"},{indexed:!1,name:"nonce",type:"uint256"},{indexed:!1,name:"revertReason",type:"bytes"}],name:"UserOperationRevertReason",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"account",type:"address"},{indexed:!1,name:"withdrawAddress",type:"address"},{indexed:!1,name:"amount",type:"uint256"}],name:"Withdrawn",type:"event"},{inputs:[],name:"SIG_VALIDATION_FAILED",outputs:[{name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{name:"initCode",type:"bytes"},{name:"sender",type:"address"},{name:"paymasterAndData",type:"bytes"}],name:"_validateSenderAndPaymaster",outputs:[],stateMutability:"view",type:"function"},{inputs:[{name:"unstakeDelaySec",type:"uint32"}],name:"addStake",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{name:"account",type:"address"}],name:"balanceOf",outputs:[{name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{name:"account",type:"address"}],name:"depositTo",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{name:"",type:"address"}],name:"deposits",outputs:[{name:"deposit",type:"uint112"},{name:"staked",type:"bool"},{name:"stake",type:"uint112"},{name:"unstakeDelaySec",type:"uint32"},{name:"withdrawTime",type:"uint48"}],stateMutability:"view",type:"function"},{inputs:[{name:"account",type:"address"}],name:"getDepositInfo",outputs:[{components:[{name:"deposit",type:"uint112"},{name:"staked",type:"bool"},{name:"stake",type:"uint112"},{name:"unstakeDelaySec",type:"uint32"},{name:"withdrawTime",type:"uint48"}],name:"info",type:"tuple"}],stateMutability:"view",type:"function"},{inputs:[{name:"sender",type:"address"},{name:"key",type:"uint192"}],name:"getNonce",outputs:[{name:"nonce",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{name:"initCode",type:"bytes"}],name:"getSenderAddress",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{components:[{name:"sender",type:"address"},{name:"nonce",type:"uint256"},{name:"initCode",type:"bytes"},{name:"callData",type:"bytes"},{name:"callGasLimit",type:"uint256"},{name:"verificationGasLimit",type:"uint256"},{name:"preVerificationGas",type:"uint256"},{name:"maxFeePerGas",type:"uint256"},{name:"maxPriorityFeePerGas",type:"uint256"},{name:"paymasterAndData",type:"bytes"},{name:"signature",type:"bytes"}],name:"userOp",type:"tuple"}],name:"getUserOpHash",outputs:[{name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[{components:[{components:[{name:"sender",type:"address"},{name:"nonce",type:"uint256"},{name:"initCode",type:"bytes"},{name:"callData",type:"bytes"},{name:"callGasLimit",type:"uint256"},{name:"verificationGasLimit",type:"uint256"},{name:"preVerificationGas",type:"uint256"},{name:"maxFeePerGas",type:"uint256"},{name:"maxPriorityFeePerGas",type:"uint256"},{name:"paymasterAndData",type:"bytes"},{name:"signature",type:"bytes"}],name:"userOps",type:"tuple[]"},{name:"aggregator",type:"address"},{name:"signature",type:"bytes"}],name:"opsPerAggregator",type:"tuple[]"},{name:"beneficiary",type:"address"}],name:"handleAggregatedOps",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{components:[{name:"sender",type:"address"},{name:"nonce",type:"uint256"},{name:"initCode",type:"bytes"},{name:"callData",type:"bytes"},{name:"callGasLimit",type:"uint256"},{name:"verificationGasLimit",type:"uint256"},{name:"preVerificationGas",type:"uint256"},{name:"maxFeePerGas",type:"uint256"},{name:"maxPriorityFeePerGas",type:"uint256"},{name:"paymasterAndData",type:"bytes"},{name:"signature",type:"bytes"}],name:"ops",type:"tuple[]"},{name:"beneficiary",type:"address"}],name:"handleOps",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{name:"key",type:"uint192"}],name:"incrementNonce",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{name:"callData",type:"bytes"},{components:[{components:[{name:"sender",type:"address"},{name:"nonce",type:"uint256"},{name:"callGasLimit",type:"uint256"},{name:"verificationGasLimit",type:"uint256"},{name:"preVerificationGas",type:"uint256"},{name:"paymaster",type:"address"},{name:"maxFeePerGas",type:"uint256"},{name:"maxPriorityFeePerGas",type:"uint256"}],name:"mUserOp",type:"tuple"},{name:"userOpHash",type:"bytes32"},{name:"prefund",type:"uint256"},{name:"contextOffset",type:"uint256"},{name:"preOpGas",type:"uint256"}],name:"opInfo",type:"tuple"},{name:"context",type:"bytes"}],name:"innerHandleOp",outputs:[{name:"actualGasCost",type:"uint256"}],stateMutability:"nonpayable",type:"function"},{inputs:[{name:"",type:"address"},{name:"",type:"uint192"}],name:"nonceSequenceNumber",outputs:[{name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{components:[{name:"sender",type:"address"},{name:"nonce",type:"uint256"},{name:"initCode",type:"bytes"},{name:"callData",type:"bytes"},{name:"callGasLimit",type:"uint256"},{name:"verificationGasLimit",type:"uint256"},{name:"preVerificationGas",type:"uint256"},{name:"maxFeePerGas",type:"uint256"},{name:"maxPriorityFeePerGas",type:"uint256"},{name:"paymasterAndData",type:"bytes"},{name:"signature",type:"bytes"}],name:"op",type:"tuple"},{name:"target",type:"address"},{name:"targetCallData",type:"bytes"}],name:"simulateHandleOp",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{components:[{name:"sender",type:"address"},{name:"nonce",type:"uint256"},{name:"initCode",type:"bytes"},{name:"callData",type:"bytes"},{name:"callGasLimit",type:"uint256"},{name:"verificationGasLimit",type:"uint256"},{name:"preVerificationGas",type:"uint256"},{name:"maxFeePerGas",type:"uint256"},{name:"maxPriorityFeePerGas",type:"uint256"},{name:"paymasterAndData",type:"bytes"},{name:"signature",type:"bytes"}],name:"userOp",type:"tuple"}],name:"simulateValidation",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"unlockStake",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{name:"withdrawAddress",type:"address"}],name:"withdrawStake",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{name:"withdrawAddress",type:"address"},{name:"withdrawAmount",type:"uint256"}],name:"withdrawTo",outputs:[],stateMutability:"nonpayable",type:"function"},{stateMutability:"payable",type:"receive"}];var parseAbi=__webpack_require__("./node_modules/viem/node_modules/abitype/dist/esm/human-readable/parseAbi.js"),getCode=__webpack_require__("./node_modules/viem/_esm/actions/public/getCode.js"),readContract=__webpack_require__("./node_modules/viem/_esm/actions/public/readContract.js"),getTransactionCount=__webpack_require__("./node_modules/viem/_esm/actions/public/getTransactionCount.js"),lru=__webpack_require__("./node_modules/viem/_esm/utils/lru.js");function createNonceManager(parameters){const{source}=parameters,deltaMap=new Map,nonceMap=new lru.A(8192),promiseMap=new Map,getKey=({address,chainId})=>`${address}.${chainId}`;return{async consume({address,chainId,client}){const key=getKey({address,chainId}),promise=this.get({address,chainId,client});this.increment({address,chainId});const nonce=await promise;return await source.set({address,chainId},nonce),nonceMap.set(key,nonce),nonce},async increment({address,chainId}){const key=getKey({address,chainId}),delta=deltaMap.get(key)??0;deltaMap.set(key,delta+1)},async get({address,chainId,client}){const key=getKey({address,chainId});let promise=promiseMap.get(key);promise||(promise=(async()=>{try{const nonce=await source.get({address,chainId,client}),previousNonce=nonceMap.get(key)??0;return previousNonce>0&&nonce<=previousNonce?previousNonce+1:(nonceMap.delete(key),nonce)}finally{this.reset({address,chainId})}})(),promiseMap.set(key,promise));return(deltaMap.get(key)??0)+await promise},reset({address,chainId}){const key=getKey({address,chainId});deltaMap.delete(key),promiseMap.delete(key)}}}(function jsonRpc(){return{async get(parameters){const{address,client}=parameters;return(0,getTransactionCount.y)(client,{address,blockTag:"pending"})},set(){}}})();var serializeErc6492Signature=__webpack_require__("./node_modules/viem/_esm/utils/signature/serializeErc6492Signature.js");function getInitCode(userOperation){const{authorization,factory,factoryData}=userOperation;if("0x7702"===factory||"0x7702000000000000000000000000000000000000"===factory){if(!authorization)return"0x7702000000000000000000000000000000000000";const delegation=authorization.address;return(0,concat.xW)([delegation,factoryData??"0x"])}return factory?(0,concat.xW)([factory,factoryData??"0x"]):"0x"}function toPackedUserOperation(userOperation){const{callGasLimit,callData,maxPriorityFeePerGas,maxFeePerGas,paymaster,paymasterData,paymasterPostOpGasLimit,paymasterVerificationGasLimit,sender,signature="0x",verificationGasLimit}=userOperation;return{accountGasLimits:(0,concat.xW)([(0,pad.eV)((0,toHex.cK)(verificationGasLimit||0n),{size:16}),(0,pad.eV)((0,toHex.cK)(callGasLimit||0n),{size:16})]),callData,initCode:getInitCode(userOperation),gasFees:(0,concat.xW)([(0,pad.eV)((0,toHex.cK)(maxPriorityFeePerGas||0n),{size:16}),(0,pad.eV)((0,toHex.cK)(maxFeePerGas||0n),{size:16})]),nonce:userOperation.nonce??0n,paymasterAndData:paymaster?(0,concat.xW)([paymaster,(0,pad.eV)((0,toHex.cK)(paymasterVerificationGasLimit||0n),{size:16}),(0,pad.eV)((0,toHex.cK)(paymasterPostOpGasLimit||0n),{size:16}),paymasterData||"0x"]):"0x",preVerificationGas:userOperation.preVerificationGas??0n,sender,signature}}const types={PackedUserOperation:[{type:"address",name:"sender"},{type:"uint256",name:"nonce"},{type:"bytes",name:"initCode"},{type:"bytes",name:"callData"},{type:"bytes32",name:"accountGasLimits"},{type:"uint256",name:"preVerificationGas"},{type:"bytes32",name:"gasFees"},{type:"bytes",name:"paymasterAndData"}]};function getUserOperationHash(parameters){const{chainId,entryPointAddress,entryPointVersion}=parameters,userOperation=parameters.userOperation,{authorization,callData="0x",callGasLimit,maxFeePerGas,maxPriorityFeePerGas,nonce,paymasterAndData="0x",preVerificationGas,sender,verificationGasLimit}=userOperation;if("0.8"===entryPointVersion)return(0,hashTypedData.Zh)(function getUserOperationTypedData(parameters){const{chainId,entryPointAddress,userOperation}=parameters,packedUserOp=toPackedUserOperation(userOperation);return{types,primaryType:"PackedUserOperation",domain:{name:"ERC4337",version:"1",chainId,verifyingContract:entryPointAddress},message:packedUserOp}}({chainId,entryPointAddress,userOperation}));const packedUserOp=(()=>{if("0.6"===entryPointVersion){const factory=userOperation.initCode?.slice(0,42),factoryData=userOperation.initCode?.slice(42),initCode=getInitCode({authorization,factory,factoryData});return(0,encodeAbiParameters.h)([{type:"address"},{type:"uint256"},{type:"bytes32"},{type:"bytes32"},{type:"uint256"},{type:"uint256"},{type:"uint256"},{type:"uint256"},{type:"uint256"},{type:"bytes32"}],[sender,nonce,(0,hash_keccak256.S)(initCode),(0,hash_keccak256.S)(callData),callGasLimit,verificationGasLimit,preVerificationGas,maxFeePerGas,maxPriorityFeePerGas,(0,hash_keccak256.S)(paymasterAndData)])}if("0.7"===entryPointVersion){const packedUserOp=toPackedUserOperation(userOperation);return(0,encodeAbiParameters.h)([{type:"address"},{type:"uint256"},{type:"bytes32"},{type:"bytes32"},{type:"bytes32"},{type:"uint256"},{type:"bytes32"},{type:"bytes32"}],[packedUserOp.sender,packedUserOp.nonce,(0,hash_keccak256.S)(packedUserOp.initCode),(0,hash_keccak256.S)(packedUserOp.callData),packedUserOp.accountGasLimits,packedUserOp.preVerificationGas,packedUserOp.gasFees,(0,hash_keccak256.S)(packedUserOp.paymasterAndData)])}throw new Error(`entryPointVersion "${entryPointVersion}" not supported.`)})();return(0,hash_keccak256.S)((0,encodeAbiParameters.h)([{type:"bytes32"},{type:"address"},{type:"uint256"}],[(0,hash_keccak256.S)(packedUserOp),entryPointAddress,BigInt(chainId)]))}var __rest=function(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(p=Object.getOwnPropertySymbols(s);i<p.length;i++)e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(t[p[i]]=s[p[i]])}return t};async function createSmartAccount(parameters){const{owner,ownerIndex,address,client,factoryData}=parameters,entryPoint={abi:entryPoint06Abi,address:"0x5FF137D4b0FDCD49DcA30c7CF57E578a026d2789",version:"0.6"},factory={abi:factoryAbi,address:"0x0ba5ed0c6aa8c49038f819e587e2633c4a9f428a"};return async function toSmartAccount(implementation){const{extend,nonceKeyManager=createNonceManager({source:{get:()=>Date.now(),set(){}}}),...rest}=implementation;let deployed=!1;const address=await implementation.getAddress();return{...extend,...rest,address,async getFactoryArgs(){return"isDeployed"in this&&await this.isDeployed()?{factory:void 0,factoryData:void 0}:implementation.getFactoryArgs()},async getNonce(parameters){const key=parameters?.key??BigInt(await nonceKeyManager.consume({address,chainId:implementation.client.chain.id,client:implementation.client}));return implementation.getNonce?await implementation.getNonce({...parameters,key}):await(0,readContract.J)(implementation.client,{abi:(0,parseAbi.U)(["function getNonce(address, uint192) pure returns (uint256)"]),address:implementation.entryPoint.address,functionName:"getNonce",args:[address,key]})},async isDeployed(){if(deployed)return!0;const code=await(0,getAction.T)(implementation.client,getCode.Q,"getCode")({address});return deployed=Boolean(code),deployed},...implementation.sign?{async sign(parameters){const[{factory,factoryData},signature]=await Promise.all([this.getFactoryArgs(),implementation.sign(parameters)]);return factory&&factoryData?(0,serializeErc6492Signature.E)({address:factory,data:factoryData,signature}):signature}}:{},async signMessage(parameters){const[{factory,factoryData},signature]=await Promise.all([this.getFactoryArgs(),implementation.signMessage(parameters)]);return factory&&factoryData&&"0x7702"!==factory?(0,serializeErc6492Signature.E)({address:factory,data:factoryData,signature}):signature},async signTypedData(parameters){const[{factory,factoryData},signature]=await Promise.all([this.getFactoryArgs(),implementation.signTypedData(parameters)]);return factory&&factoryData&&"0x7702"!==factory?(0,serializeErc6492Signature.E)({address:factory,data:factoryData,signature}):signature},type:"smart"}}({client,entryPoint,extend:{abi,factory},async decodeCalls(data){const result=(0,decodeFunctionData.J)({abi,data});if("execute"===result.functionName)return[{to:result.args[0],value:result.args[1],data:result.args[2]}];if("executeBatch"===result.functionName)return result.args[0].map(arg=>({to:arg.target,value:arg.value,data:arg.data}));throw new base.C(`unable to decode calls for "${result.functionName}"`)},async encodeCalls(calls){var _a,_b;return 1===calls.length?(0,encodeFunctionData.p)({abi,functionName:"execute",args:[calls[0].to,null!==(_a=calls[0].value)&&void 0!==_a?_a:BigInt(0),null!==(_b=calls[0].data)&&void 0!==_b?_b:"0x"]}):(0,encodeFunctionData.p)({abi,functionName:"executeBatch",args:[calls.map(call=>{var _a,_b;return{data:null!==(_a=call.data)&&void 0!==_a?_a:"0x",target:call.to,value:null!==(_b=call.value)&&void 0!==_b?_b:BigInt(0)}})]})},getAddress:async()=>address,getFactoryArgs:async()=>({factory:factory.address,factoryData}),getStubSignature:async()=>"webAuthn"===owner.type?"0x0000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000c0000000000000000000000000000000000000000000000000000000000000012000000000000000000000000000000000000000000000000000000000000000170000000000000000000000000000000000000000000000000000000000000001949fc7c88032b9fcb5f6efc7a7b8c63668eae9871b765e23123bb473ff57aa831a7c0d9276168ebcc29f2875a0239cffdf2a9cd1c2007c5c77c071db9264df1d000000000000000000000000000000000000000000000000000000000000002549960de5880e8c687434170f6476605b8fe4aeb9a28632c7995cf3ba831d97630500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000008a7b2274797065223a22776562617574686e2e676574222c226368616c6c656e6765223a2273496a396e6164474850596759334b7156384f7a4a666c726275504b474f716d59576f4d57516869467773222c226f726967696e223a2268747470733a2f2f7369676e2e636f696e626173652e636f6d222c2263726f73734f726967696e223a66616c73657d00000000000000000000000000000000000000000000":wrapSignature({ownerIndex,signature:"0xfffffffffffffffffffffffffffffff0000000000000000000000000000000007aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa1c"}),async sign(parameters){const hash=toReplaySafeHash({address:await this.getAddress(),chainId:client.chain.id,hash:parameters.hash}),signature=await createSmartAccount_sign({hash,owner});return wrapSignature({ownerIndex,signature})},async signMessage(parameters){const{message}=parameters,hash=toReplaySafeHash({address:await this.getAddress(),chainId:client.chain.id,hash:(0,hashMessage.A)(message)}),signature=await createSmartAccount_sign({hash,owner});return wrapSignature({ownerIndex,signature})},async signTypedData(parameters){const{domain,types,primaryType,message}=parameters,hash=toReplaySafeHash({address:await this.getAddress(),chainId:client.chain.id,hash:(0,hashTypedData.Zh)({domain,message,primaryType,types})}),signature=await createSmartAccount_sign({hash,owner});return wrapSignature({ownerIndex,signature})},async signUserOperation(parameters){const{chainId=client.chain.id}=parameters,userOperation=__rest(parameters,["chainId"]),address=await this.getAddress(),hash=getUserOperationHash({chainId,entryPointAddress:entryPoint.address,entryPointVersion:entryPoint.version,userOperation:Object.assign(Object.assign({},userOperation),{sender:address})}),signature=await createSmartAccount_sign({hash,owner});return wrapSignature({ownerIndex,signature})},userOperation:{async estimateGas(userOperation){var _a;if("webAuthn"===owner.type)return{verificationGasLimit:BigInt(Math.max(Number(null!==(_a=userOperation.verificationGasLimit)&&void 0!==_a?_a:BigInt(0)),8e5))}}}})}async function createSmartAccount_sign({hash,owner}){if("webAuthn"===owner.type){const{signature,webauthn}=await owner.sign({hash});return function toWebAuthnSignature({webauthn,signature}){const{r,s}=Signature_fromHex(signature);return(0,encodeAbiParameters.h)([{components:[{name:"authenticatorData",type:"bytes"},{name:"clientDataJSON",type:"bytes"},{name:"challengeIndex",type:"uint256"},{name:"typeIndex",type:"uint256"},{name:"r",type:"uint256"},{name:"s",type:"uint256"}],type:"tuple"}],[{authenticatorData:webauthn.authenticatorData,clientDataJSON:(0,toHex.i3)(webauthn.clientDataJSON),challengeIndex:BigInt(webauthn.challengeIndex),typeIndex:BigInt(webauthn.typeIndex),r,s}])}({signature,webauthn})}if(owner.sign)return owner.sign({hash});throw new base.C("`owner` does not support raw sign.")}function toReplaySafeHash({address,chainId,hash}){return(0,hashTypedData.Zh)({domain:{chainId,name:"Coinbase Smart Wallet",verifyingContract:address,version:"1"},types:{CoinbaseSmartWalletMessage:[{name:"hash",type:"bytes32"}]},primaryType:"CoinbaseSmartWalletMessage",message:{hash}})}function wrapSignature(parameters){const{ownerIndex=0}=parameters,signatureData=(()=>{if(65!==(0,data_size.E)(parameters.signature))return parameters.signature;const signature=function parseSignature(signatureHex){const{r,s}=esm_secp256k1.secp256k1.Signature.fromCompact(signatureHex.slice(2,130)),yParityOrV=Number(`0x${signatureHex.slice(130)}`),[v,yParity]=(()=>{if(0===yParityOrV||1===yParityOrV)return[void 0,yParityOrV];if(27===yParityOrV)return[BigInt(yParityOrV),0];if(28===yParityOrV)return[BigInt(yParityOrV),1];throw new Error("Invalid yParityOrV value")})();return void 0!==v?{r:(0,toHex.cK)(r,{size:32}),s:(0,toHex.cK)(s,{size:32}),v,yParity}:{r:(0,toHex.cK)(r,{size:32}),s:(0,toHex.cK)(s,{size:32}),yParity}}(parameters.signature);return function encodePacked(types,values){if(types.length!==values.length)throw new errors_abi.YE({expectedLength:types.length,givenLength:values.length});const data=[];for(let i=0;i<types.length;i++){const type=types[i],value=values[i];data.push(encode(type,value))}return(0,concat.aP)(data)}(["bytes32","bytes32","uint8"],[signature.r,signature.s,0===signature.yParity?27:28])})();return(0,encodeAbiParameters.h)([{components:[{name:"ownerIndex",type:"uint8"},{name:"signatureData",type:"bytes"}],type:"tuple"}],[{ownerIndex,signatureData}])}async function createSubAccountSigner({address,client,factory,factoryData,owner,ownerIndex,parentAddress,attribution}){var _a;const subAccount={address,factory,factoryData},chainId=null===(_a=client.chain)||void 0===_a?void 0:_a.id;if(!chainId)throw errors_standardErrors.rpc.internal("chainId not found");const account=await createSmartAccount({owner,ownerIndex:null!=ownerIndex?ownerIndex:1,address,client,factoryData}),request=async args=>{var _a,_b,_c,_d,_e,_f;try{switch(args.method){case"wallet_addSubAccount":return subAccount;case"eth_accounts":return[subAccount.address];case"eth_coinbase":return subAccount.address;case"net_version":return chainId.toString();case"eth_chainId":return(0,toHex.cK)(chainId);case"eth_sendTransaction":{assertArrayPresence(args.params);const rawParams=args.params[0];assertPresence(rawParams.to,errors_standardErrors.rpc.invalidParams("to is required"));const params={to:rawParams.to,data:ensureHexString(null!==(_a=rawParams.data)&&void 0!==_a?_a:"0x",!0),value:ensureHexString(null!==(_b=rawParams.value)&&void 0!==_b?_b:"0x",!0),from:null!==(_c=rawParams.from)&&void 0!==_c?_c:subAccount.address},sendCallsRequest=createWalletSendCallsRequest({calls:[params],chainId,from:params.from}),response=await request(sendCallsRequest);return waitForCallsTransactionHash({client,id:response})}case"wallet_sendCalls":{assertArrayPresence(args.params);const chainId=get_get(args.params[0],"chainId");if(!chainId)throw errors_standardErrors.rpc.invalidParams("chainId is required");if(!(0,isHex.q)(chainId))throw errors_standardErrors.rpc.invalidParams("chainId must be a hex encoded integer");if(!args.params[0])throw errors_standardErrors.rpc.invalidParams("params are required");if(!("calls"in args.params[0]))throw errors_standardErrors.rpc.invalidParams("calls are required");let prepareCallsRequest={method:"wallet_prepareCalls",params:[{version:"1.0",calls:args.params[0].calls,chainId,from:subAccount.address,capabilities:"capabilities"in args.params[0]?args.params[0].capabilities:{}}]};parentAddress&&(prepareCallsRequest=injectRequestCapabilities(prepareCallsRequest,{funding:[{type:"spendPermission",data:{autoApply:!0,sources:[parentAddress],preference:"PREFER_DIRECT_BALANCE"}}]}));let prepareCallsResponse=await request(prepareCallsRequest);const signResponse=await(null===(_e=(_d=owner).sign)||void 0===_e?void 0:_e.call(_d,{hash:(0,fromHex.IQ)(prepareCallsResponse.signatureRequest.hash)}));let signatureData;if(!signResponse)throw errors_standardErrors.rpc.internal("signature not found");signatureData=(0,isHex.q)(signResponse)?{type:"secp256k1",data:{address:owner.address,signature:signResponse}}:{type:"webauthn",data:{signature:JSON.stringify(convertCredentialToJSON(Object.assign({id:null!==(_f=owner.id)&&void 0!==_f?_f:"1"},signResponse))),publicKey:owner.publicKey}};return(await request({method:"wallet_sendPreparedCalls",params:[{version:"1.0",type:prepareCallsResponse.type,data:prepareCallsResponse.userOp,chainId:prepareCallsResponse.chainId,signature:signatureData}]}))[0]}case"wallet_sendPreparedCalls":{assertArrayPresence(args.params);const chainId=get_get(args.params[0],"chainId");if(!chainId)throw errors_standardErrors.rpc.invalidParams("chainId is required");if(!(0,isHex.q)(chainId))throw errors_standardErrors.rpc.invalidParams("chainId must be a hex encoded integer");return await client.request({method:"wallet_sendPreparedCalls",params:args.params})}case"wallet_prepareCalls":{assertArrayPresence(args.params);const chainId=get_get(args.params[0],"chainId");if(!chainId)throw errors_standardErrors.rpc.invalidParams("chainId is required");if(!(0,isHex.q)(chainId))throw errors_standardErrors.rpc.invalidParams("chainId must be a hex encoded integer");if(!args.params[0])throw errors_standardErrors.rpc.invalidParams("params are required");if(!get_get(args.params[0],"calls"))throw errors_standardErrors.rpc.invalidParams("calls are required");const prepareCallsParams=args.params[0];attribution&&prepareCallsParams.capabilities&&!("attribution"in prepareCallsParams.capabilities)&&(prepareCallsParams.capabilities.attribution=attribution);return await client.request({method:"wallet_prepareCalls",params:[Object.assign(Object.assign({},args.params[0]),{chainId})]})}case"personal_sign":{if(assertArrayPresence(args.params),!(0,isHex.q)(args.params[0]))throw errors_standardErrors.rpc.invalidParams("message must be a hex encoded string");const message=(0,fromHex.IQ)(args.params[0]);return account.signMessage({message})}case"eth_signTypedData_v4":{assertArrayPresence(args.params);const typedData="string"==typeof args.params[1]?JSON.parse(args.params[1]):args.params[1];return account.signTypedData(typedData)}default:throw errors_standardErrors.rpc.methodNotSupported()}}catch(error){if(isViemError(error)){const newError=function viemHttpErrorToProviderError(error){try{const details=JSON.parse(error.details);return new EthereumRpcError(details.code,details.message,details.data)}catch(_){return null}}(error);if(newError)throw newError}throw error}};return{request}}var getAddress=__webpack_require__("./node_modules/viem/_esm/utils/address/getAddress.js");async function findOwnerIndex({address,client,publicKey,factory,factoryData}){if(!await(0,getCode.Q)(client,{address})&&factory&&factoryData){if((0,getAddress.b)(factory)!==(0,getAddress.b)("0x0ba5ed0c6aa8c49038f819e587e2633c4a9f428a"))throw errors_standardErrors.rpc.internal("unknown factory address");const initData=(0,decodeFunctionData.J)({abi:factoryAbi,data:factoryData});if("createAccount"!==initData.functionName)throw errors_standardErrors.rpc.internal("unknown factory function");const[owners]=initData.args;return owners.findIndex(owner=>owner.toLowerCase()===formatPublicKey(publicKey).toLowerCase())}const ownerCount=await(0,readContract.J)(client,{address,abi,functionName:"ownerCount"});for(let i=Number(ownerCount)-1;i>=0;i--){const owner=await(0,readContract.J)(client,{address,abi,functionName:"ownerAtIndex",args:[BigInt(i)]}),formatted=formatPublicKey(publicKey);if(owner.toLowerCase()===formatted.toLowerCase())return i}return-1}function formatPublicKey(publicKey){return(0,isAddress.P)(publicKey)?(0,pad.eV)(publicKey):publicKey}async function handleAddSubAccountOwner({ownerAccount,globalAccountRequest}){var _a,_b;const account=store.account.get(),subAccount=store.subAccounts.get(),globalAccount=null===(_a=account.accounts)||void 0===_a?void 0:_a.find(account=>account.toLowerCase()!==(null==subAccount?void 0:subAccount.address.toLowerCase()));assertPresence(globalAccount,errors_standardErrors.provider.unauthorized("no global account")),assertPresence(null===(_b=account.chain)||void 0===_b?void 0:_b.id,errors_standardErrors.provider.unauthorized("no chain id")),assertPresence(null==subAccount?void 0:subAccount.address,errors_standardErrors.provider.unauthorized("no sub account"));const calls=[];if("local"===ownerAccount.type&&ownerAccount.address&&calls.push({to:subAccount.address,data:(0,encodeFunctionData.p)({abi,functionName:"addOwnerAddress",args:[ownerAccount.address]}),value:(0,toHex.nj)(0)}),ownerAccount.publicKey){const[x,y]=(0,decodeAbiParameters.n)([{type:"bytes32"},{type:"bytes32"}],ownerAccount.publicKey);calls.push({to:subAccount.address,data:(0,encodeFunctionData.p)({abi,functionName:"addOwnerPublicKey",args:[x,y]}),value:(0,toHex.nj)(0)})}const request={method:"wallet_sendCalls",params:[{version:"1",calls,chainId:(0,toHex.cK)(84532),from:globalAccount}]},selection=await async function presentAddOwnerDialog(){const snackbar=initSnackbar();return new Promise(resolve=>{logSnackbarShown({snackbarContext:"sub_account_add_owner"}),snackbar.presentItem({autoExpand:!0,message:"App requires a signer update",menuItems:[{isRed:!1,info:"Confirm",svgWidth:"10",svgHeight:"11",path:"",defaultFillRule:"evenodd",defaultClipRule:"evenodd",onClick:()=>{logSnackbarActionClicked({snackbarContext:"sub_account_add_owner",snackbarAction:"confirm"}),snackbar.clear(),resolve("authenticate")}},{isRed:!0,info:"Cancel",svgWidth:"10",svgHeight:"11",path:"",defaultFillRule:"evenodd",defaultClipRule:"evenodd",onClick:()=>{logSnackbarActionClicked({snackbarContext:"sub_account_add_owner",snackbarAction:"cancel"}),snackbar.clear(),resolve("cancel")}}]})})}();if("cancel"===selection)throw errors_standardErrors.provider.unauthorized("user cancelled");const callsId=await globalAccountRequest(request),client=getClient(account.chain.id);assertPresence(client,errors_standardErrors.rpc.internal(`client not found for chainId ${account.chain.id}`));if("success"!==(await(0,waitForCallsStatus.c)(client,{id:callsId})).status)throw errors_standardErrors.rpc.internal("add owner call failed");const ownerIndex=await findOwnerIndex({address:subAccount.address,publicKey:"local"===ownerAccount.type&&ownerAccount.address?ownerAccount.address:ownerAccount.publicKey,client});if(-1===ownerIndex)throw errors_standardErrors.rpc.internal("failed to find owner index");return ownerIndex}var abis=__webpack_require__("./node_modules/viem/_esm/constants/abis.js"),handleInsufficientBalance_console=__webpack_require__("./node_modules/console-browserify/index.js");async function handleInsufficientBalanceError({errorData,globalAccountAddress,subAccountAddress,client,request,subAccountRequest,globalAccountRequest}){var _a;const chainId=null===(_a=client.chain)||void 0===_a?void 0:_a.id;assertPresence(chainId,errors_standardErrors.rpc.internal("invalid chainId"));const spendPermissionRequests=function parseFundingOptions({errorData,sourceAddress}){var _a;const spendPermissionRequests=[];for(const[token,{amount,sources}]of Object.entries(null!==(_a=null==errorData?void 0:errorData.required)&&void 0!==_a?_a:{})){if(0===sources.filter(source=>(0,fromHex.uU)(source.balance)>=(0,fromHex.uU)(amount)&&source.address.toLowerCase()===(null==sourceAddress?void 0:sourceAddress.toLowerCase())).length)throw new Error("Source address has insufficient balance for a token");spendPermissionRequests.push({token,requiredAmount:(0,fromHex.uU)(amount)})}return spendPermissionRequests}({errorData,sourceAddress:globalAccountAddress}),userChoice=await async function presentSubAccountFundingDialog(){const snackbar=initSnackbar();return await new Promise(resolve=>{logSnackbarShown({snackbarContext:"sub_account_insufficient_balance"}),snackbar.presentItem({autoExpand:!0,message:"Insufficient spend permission. Choose how to proceed:",menuItems:[{isRed:!1,info:"Create new Spend Permission",svgWidth:"10",svgHeight:"11",path:"",defaultFillRule:"evenodd",defaultClipRule:"evenodd",onClick:()=>{logSnackbarActionClicked({snackbarContext:"sub_account_insufficient_balance",snackbarAction:"create_permission"}),snackbar.clear(),resolve("update_permission")}},{isRed:!1,info:"Continue in Popup",svgWidth:"10",svgHeight:"11",path:"",defaultFillRule:"evenodd",defaultClipRule:"evenodd",onClick:()=>{logSnackbarActionClicked({snackbarContext:"sub_account_insufficient_balance",snackbarAction:"continue_in_popup"}),snackbar.clear(),resolve("continue_popup")}},{isRed:!0,info:"Cancel",svgWidth:"10",svgHeight:"11",path:"",defaultFillRule:"evenodd",defaultClipRule:"evenodd",onClick:()=>{logSnackbarActionClicked({snackbarContext:"sub_account_insufficient_balance",snackbarAction:"cancel"}),snackbar.clear(),resolve("cancel")}}]})})}();if("cancel"===userChoice)throw new Error("User cancelled funding");let signatureRequest;if("update_permission"===userChoice){if(1===spendPermissionRequests.length){const spendPermission=spendPermissionRequests[0],message=function createSpendPermissionMessage({spendPermission,chainId}){return{domain:{name:"Spend Permission Manager",version:"1",chainId,verifyingContract:"0xf85210B21cC50302F477BA56686d2019dC9b67Ad"},types:{SpendPermission:[{name:"account",type:"address"},{name:"spender",type:"address"},{name:"token",type:"address"},{name:"allowance",type:"uint160"},{name:"period",type:"uint48"},{name:"start",type:"uint48"},{name:"end",type:"uint48"},{name:"salt",type:"uint256"},{name:"extraData",type:"bytes"}]},primaryType:"SpendPermission",message:{account:spendPermission.account,spender:spendPermission.spender,token:spendPermission.token,allowance:spendPermission.allowance,period:spendPermission.period,start:spendPermission.start,end:spendPermission.end,salt:spendPermission.salt,extraData:spendPermission.extraData}}}({spendPermission:{token:spendPermission.token,allowance:(0,toHex.cK)(spendPermission.requiredAmount*BigInt(3)),period:86400,account:globalAccountAddress,spender:subAccountAddress,start:0,end:0xffffffffffff,salt:(0,toHex.cK)(BigInt(Math.floor(Math.random()*Number.MAX_SAFE_INTEGER))),extraData:"0x"},chainId});signatureRequest={method:"eth_signTypedData_v4",params:[globalAccountAddress,message]}}else{const message=function createSpendPermissionBatchMessage({spendPermissionBatch,chainId}){return{domain:{name:"Spend Permission Manager",version:"1",chainId,verifyingContract:"0xf85210B21cC50302F477BA56686d2019dC9b67Ad"},types:{SpendPermissionBatch:[{name:"account",type:"address"},{name:"period",type:"uint48"},{name:"start",type:"uint48"},{name:"end",type:"uint48"},{name:"permissions",type:"PermissionDetails[]"}],PermissionDetails:[{name:"spender",type:"address"},{name:"token",type:"address"},{name:"allowance",type:"uint160"},{name:"salt",type:"uint256"},{name:"extraData",type:"bytes"}]},primaryType:"SpendPermissionBatch",message:{account:spendPermissionBatch.account,period:spendPermissionBatch.period,start:spendPermissionBatch.start,end:spendPermissionBatch.end,permissions:spendPermissionBatch.permissions.map(p=>({spender:p.spender,token:p.token,allowance:p.allowance,salt:p.salt,extraData:p.extraData}))}}}({spendPermissionBatch:{account:globalAccountAddress,period:86400,start:0,end:0xffffffffffff,permissions:spendPermissionRequests.map(spendPermission=>({token:spendPermission.token,allowance:(0,toHex.cK)(spendPermission.requiredAmount*BigInt(3)),period:86400,account:globalAccountAddress,spender:subAccountAddress,salt:"0x0",extraData:"0x"}))},chainId});signatureRequest={method:"eth_signTypedData_v4",params:[globalAccountAddress,message]}}try{await globalAccountRequest(signatureRequest)}catch(error){throw handleInsufficientBalance_console.error(error),new Error("User denied spend permission request")}return subAccountRequest(request)}const transferCalls=spendPermissionRequests.map(spendPermission=>spendPermission.token.toLowerCase()==="0xEeeeeEeeeEeEeeEeEeEeeEEEeeeeEeeeeeeeEEeE".toLowerCase()?{to:subAccountAddress,value:(0,toHex.cK)(spendPermission.requiredAmount),data:"0x"}:{to:spendPermission.token,value:"0x0",data:(0,encodeFunctionData.p)({abi:abis.xw,functionName:"transfer",args:[subAccountAddress,spendPermission.requiredAmount]})});let originalSendCallsParams;if("wallet_sendCalls"===request.method&&function isSendCallsParams(params){return"object"==typeof params&&null!==params&&"calls"in params}(request.params))originalSendCallsParams=request.params[0];else{if("eth_sendTransaction"!==request.method||!function isEthSendTransactionParams(params){return Array.isArray(params)&&1===params.length&&"object"==typeof params[0]&&null!==params[0]&&"to"in params[0]}(request.params))throw new Error("Could not get original call");originalSendCallsParams=createWalletSendCallsRequest({calls:[request.params[0]],chainId,from:request.params[0].from}).params[0]}const subAccountCallData=(0,encodeFunctionData.p)({abi,functionName:"executeBatch",args:[originalSendCallsParams.calls.map(call=>{var _a,_b;return{target:call.to,value:(0,fromHex.uU)(null!==(_a=call.value)&&void 0!==_a?_a:"0x0"),data:null!==(_b=call.data)&&void 0!==_b?_b:"0x"}})]}),calls=[...transferCalls,{data:subAccountCallData,to:subAccountAddress,value:"0x0"}],result=await globalAccountRequest({method:"wallet_sendCalls",params:[Object.assign(Object.assign({},originalSendCallsParams),{calls,from:globalAccountAddress})]});return"eth_sendTransaction"===request.method?waitForCallsTransactionHash({client,id:result}):result}var SCWSigner_console=__webpack_require__("./node_modules/console-browserify/index.js");class SCWSigner{constructor(params){var _a,_b,_c,_d;this.communicator=params.communicator,this.callback=params.callback,this.keyManager=new SCWKeyManager;const{account,chains}=store.getState();this.accounts=null!==(_a=account.accounts)&&void 0!==_a?_a:[],this.chain=null!==(_b=account.chain)&&void 0!==_b?_b:{id:null!==(_d=null===(_c=params.metadata.appChainIds)||void 0===_c?void 0:_c[0])&&void 0!==_d?_d:1},chains&&createClients(chains)}async handshake(args){var _a,_b,_c;const correlationId=correlationIds_get(args);(({method,correlationId})=>{var _a;logEvent("scw_signer.handshake.started",{action:ActionType.unknown,componentType:ComponentType.unknown,method,correlationId,enableAutoSubAccounts:null===(_a=store.subAccountsConfig.get())||void 0===_a?void 0:_a.enableAutoSubAccounts},AnalyticsEventImportance.high)})({method:args.method,correlationId});try{await(null===(_b=(_a=this.communicator).waitForPopupLoaded)||void 0===_b?void 0:_b.call(_a));const handshakeMessage=await this.createRequestMessage({handshake:{method:args.method,params:null!==(_c=args.params)&&void 0!==_c?_c:[]}},correlationId),response=await this.communicator.postRequestAndWaitForResponse(handshakeMessage);if("failure"in response.content)throw response.content.failure;const peerPublicKey=await importKeyFromHexString("public",response.sender);await this.keyManager.setPeerPublicKey(peerPublicKey);const decrypted=await this.decryptResponseMessage(response);this.handleResponse(args,decrypted),(({method,correlationId})=>{var _a;logEvent("scw_signer.handshake.completed",{action:ActionType.unknown,componentType:ComponentType.unknown,method,correlationId,enableAutoSubAccounts:null===(_a=store.subAccountsConfig.get())||void 0===_a?void 0:_a.enableAutoSubAccounts},AnalyticsEventImportance.high)})({method:args.method,correlationId})}catch(error){throw(({method,correlationId,errorMessage})=>{var _a;logEvent("scw_signer.handshake.error",{action:ActionType.error,componentType:ComponentType.unknown,method,correlationId,errorMessage,enableAutoSubAccounts:null===(_a=store.subAccountsConfig.get())||void 0===_a?void 0:_a.enableAutoSubAccounts},AnalyticsEventImportance.high)})({method:args.method,correlationId,errorMessage:parseErrorMessageFromAny(error)}),error}}async request(request){const correlationId=correlationIds_get(request);(({method,correlationId})=>{var _a;logEvent("scw_signer.request.started",{action:ActionType.unknown,componentType:ComponentType.unknown,method,correlationId,enableAutoSubAccounts:null===(_a=store.subAccountsConfig.get())||void 0===_a?void 0:_a.enableAutoSubAccounts},AnalyticsEventImportance.high)})({method:request.method,correlationId});try{const result=await this._request(request);return(({method,correlationId})=>{var _a;logEvent("scw_signer.request.completed",{action:ActionType.unknown,componentType:ComponentType.unknown,method,correlationId,enableAutoSubAccounts:null===(_a=store.subAccountsConfig.get())||void 0===_a?void 0:_a.enableAutoSubAccounts},AnalyticsEventImportance.high)})({method:request.method,correlationId}),result}catch(error){throw(({method,correlationId,errorMessage})=>{var _a;logEvent("scw_signer.request.error",{action:ActionType.error,componentType:ComponentType.unknown,method,correlationId,errorMessage,enableAutoSubAccounts:null===(_a=store.subAccountsConfig.get())||void 0===_a?void 0:_a.enableAutoSubAccounts},AnalyticsEventImportance.high)})({method:request.method,correlationId,errorMessage:parseErrorMessageFromAny(error)}),error}}async _request(request){var _a,_b,_c,_d,_e,_f,_g,_h,_j,_k,_l,_m,_o,_p;if(0===this.accounts.length)switch(request.method){case"eth_requestAccounts":return await(null===(_b=(_a=this.communicator).waitForPopupLoaded)||void 0===_b?void 0:_b.call(_a)),await initSubAccountConfig(),await this.request({method:"wallet_connect",params:[{version:"1",capabilities:Object.assign({},null!==(_d=null===(_c=store.subAccountsConfig.get())||void 0===_c?void 0:_c.capabilities)&&void 0!==_d?_d:{})}]}),this.accounts;case"wallet_switchEthereumChain":return assertParamsChainId(request.params),void(this.chain.id=Number(request.params[0].chainId));case"wallet_connect":{await(null===(_f=(_e=this.communicator).waitForPopupLoaded)||void 0===_f?void 0:_f.call(_e)),await initSubAccountConfig();let capabilitiesToInject={};(function requestHasCapability(request,capabilityName){var _a;if(!Array.isArray(null==request?void 0:request.params))return!1;const capabilities=null===(_a=request.params[0])||void 0===_a?void 0:_a.capabilities;return!(!capabilities||"object"!=typeof capabilities)&&capabilityName in capabilities})(request,"addSubAccount")&&(capabilitiesToInject=null!==(_h=null===(_g=store.subAccountsConfig.get())||void 0===_g?void 0:_g.capabilities)&&void 0!==_h?_h:{});const modifiedRequest=injectRequestCapabilities(request,capabilitiesToInject);return this.sendRequestToPopup(modifiedRequest)}case"wallet_sendCalls":case"wallet_sign":return this.sendRequestToPopup(request);default:throw errors_standardErrors.provider.unauthorized()}if(this.shouldRequestUseSubAccountSigner(request)){const correlationId=correlationIds_get(request);(({method,correlationId})=>{var _a;logEvent("scw_sub_account.request.started",{action:ActionType.unknown,componentType:ComponentType.unknown,method,correlationId,enableAutoSubAccounts:null===(_a=store.subAccountsConfig.get())||void 0===_a?void 0:_a.enableAutoSubAccounts},AnalyticsEventImportance.high)})({method:request.method,correlationId});try{const result=await this.sendRequestToSubAccountSigner(request);return(({method,correlationId})=>{var _a;logEvent("scw_sub_account.request.completed",{action:ActionType.unknown,componentType:ComponentType.unknown,method,correlationId,enableAutoSubAccounts:null===(_a=store.subAccountsConfig.get())||void 0===_a?void 0:_a.enableAutoSubAccounts},AnalyticsEventImportance.high)})({method:request.method,correlationId}),result}catch(error){throw(({method,correlationId,errorMessage})=>{var _a;logEvent("scw_sub_account.request.error",{action:ActionType.error,componentType:ComponentType.unknown,method,correlationId,errorMessage,enableAutoSubAccounts:null===(_a=store.subAccountsConfig.get())||void 0===_a?void 0:_a.enableAutoSubAccounts},AnalyticsEventImportance.high)})({method:request.method,correlationId,errorMessage:parseErrorMessageFromAny(error)}),error}}switch(request.method){case"eth_requestAccounts":case"eth_accounts":{const subAccount=store.subAccounts.get(),subAccountsConfig=store.subAccountsConfig.get();return(null==subAccount?void 0:subAccount.address)&&(this.accounts=(null==subAccountsConfig?void 0:subAccountsConfig.enableAutoSubAccounts)?prependWithoutDuplicates(this.accounts,subAccount.address):appendWithoutDuplicates(this.accounts,subAccount.address)),null===(_j=this.callback)||void 0===_j||_j.call(this,"connect",{chainId:(0,toHex.cK)(this.chain.id)}),this.accounts}case"eth_coinbase":return this.accounts[0];case"net_version":return this.chain.id;case"eth_chainId":return(0,toHex.cK)(this.chain.id);case"wallet_getCapabilities":return this.handleGetCapabilitiesRequest(request);case"wallet_switchEthereumChain":return this.handleSwitchChainRequest(request);case"eth_ecRecover":case"personal_sign":case"wallet_sign":case"personal_ecRecover":case"eth_signTransaction":case"eth_sendTransaction":case"eth_signTypedData_v1":case"eth_signTypedData_v3":case"eth_signTypedData_v4":case"eth_signTypedData":case"wallet_addEthereumChain":case"wallet_watchAsset":case"wallet_sendCalls":case"wallet_showCallsStatus":case"wallet_grantPermissions":return this.sendRequestToPopup(request);case"wallet_connect":{const cachedResponse=await async function getCachedWalletConnectResponse(){const spendPermissions=store.spendPermissions.get(),subAccount=store.subAccounts.get(),accounts=store.account.get().accounts;if(!accounts)return null;const walletConnectAccounts=null==accounts?void 0:accounts.map(account=>({address:account,capabilities:{subAccounts:subAccount?[subAccount]:void 0,spendPermissions:spendPermissions.length>0?{permissions:spendPermissions}:void 0}}));return{accounts:walletConnectAccounts}}();if(cachedResponse)return cachedResponse;await(null===(_l=(_k=this.communicator).waitForPopupLoaded)||void 0===_l?void 0:_l.call(_k)),await initSubAccountConfig();const subAccountsConfig=store.subAccountsConfig.get(),modifiedRequest=injectRequestCapabilities(request,null!==(_m=null==subAccountsConfig?void 0:subAccountsConfig.capabilities)&&void 0!==_m?_m:{});return null===(_o=this.callback)||void 0===_o||_o.call(this,"connect",{chainId:(0,toHex.cK)(this.chain.id)}),this.sendRequestToPopup(modifiedRequest)}case"wallet_getSubAccounts":{const subAccount=store.subAccounts.get();if(null==subAccount?void 0:subAccount.address)return{subAccounts:[subAccount]};if(!this.chain.rpcUrl)throw errors_standardErrors.rpc.internal("No RPC URL set for chain");const response=await fetchRPCRequest(request,this.chain.rpcUrl);if(assertArrayPresence(response.subAccounts,"subAccounts"),response.subAccounts.length>0){assertSubAccount(response.subAccounts[0]);const subAccount=response.subAccounts[0];store.subAccounts.set({address:subAccount.address,factory:subAccount.factory,factoryData:subAccount.factoryData})}return response}case"wallet_addSubAccount":return this.addSubAccount(request);case"coinbase_fetchPermissions":{!function assertFetchPermissionsRequest(request){if("coinbase_fetchPermissions"!==request.method||void 0!==request.params){if("coinbase_fetchPermissions"!==request.method||!Array.isArray(request.params)||1!==request.params.length||"object"!=typeof request.params[0])throw errors_standardErrors.rpc.invalidParams();if("string"!=typeof request.params[0].account||!request.params[0].chainId.startsWith("0x"))throw errors_standardErrors.rpc.invalidParams("FetchPermissions - Invalid params: params[0].account must be a hex string");if("string"!=typeof request.params[0].chainId||!request.params[0].chainId.startsWith("0x"))throw errors_standardErrors.rpc.invalidParams("FetchPermissions - Invalid params: params[0].chainId must be a hex string");if("string"!=typeof request.params[0].spender||!request.params[0].spender.startsWith("0x"))throw errors_standardErrors.rpc.invalidParams("FetchPermissions - Invalid params: params[0].spender must be a hex string")}}(request);const completeRequest=function fillMissingParamsForFetchPermissions(request){var _a,_b,_c;if(void 0!==request.params)return request;const accountFromStore=null===(_a=store.getState().account.accounts)||void 0===_a?void 0:_a[0],chainId=null===(_b=store.getState().account.chain)||void 0===_b?void 0:_b.id,subAccountFromStore=null===(_c=store.getState().subAccount)||void 0===_c?void 0:_c.address;if(!accountFromStore||!subAccountFromStore||!chainId)throw errors_standardErrors.rpc.invalidParams("FetchPermissions - one or more of account, sub account, or chain id is missing, connect to sub account via wallet_connect first");return{method:"coinbase_fetchPermissions",params:[{account:accountFromStore,chainId:(0,toHex.cK)(chainId),spender:subAccountFromStore}]}}(request),permissions=await fetchRPCRequest(completeRequest,"https://rpc.wallet.coinbase.com"),requestedChainId=(0,fromHex.ME)(null===(_p=completeRequest.params)||void 0===_p?void 0:_p[0].chainId);return store.spendPermissions.set(permissions.permissions.map(permission=>Object.assign(Object.assign({},permission),{chainId:requestedChainId}))),permissions}default:if(!this.chain.rpcUrl)throw errors_standardErrors.rpc.internal("No RPC URL set for chain");return fetchRPCRequest(request,this.chain.rpcUrl)}}async sendRequestToPopup(request){var _a,_b;await(null===(_b=(_a=this.communicator).waitForPopupLoaded)||void 0===_b?void 0:_b.call(_a));const response=await this.sendEncryptedRequest(request),decrypted=await this.decryptResponseMessage(response);return this.handleResponse(request,decrypted)}async handleResponse(request,decrypted){var _a,_b,_c,_d,_e;const result=decrypted.result;if("error"in result)throw result.error;switch(request.method){case"eth_requestAccounts":{const accounts=result.value;this.accounts=accounts,store.account.set({accounts,chain:this.chain}),null===(_a=this.callback)||void 0===_a||_a.call(this,"accountsChanged",accounts);break}case"wallet_connect":{const response=result.value,accounts=response.accounts.map(account=>account.address);this.accounts=accounts,store.account.set({accounts});const account=response.accounts.at(0),capabilities=null==account?void 0:account.capabilities;if(null==capabilities?void 0:capabilities.subAccounts){const capabilityResponse=null==capabilities?void 0:capabilities.subAccounts;assertArrayPresence(capabilityResponse,"subAccounts"),assertSubAccount(capabilityResponse[0]),store.subAccounts.set({address:capabilityResponse[0].address,factory:capabilityResponse[0].factory,factoryData:capabilityResponse[0].factoryData})}let accounts_=[this.accounts[0]];const subAccount=store.subAccounts.get(),subAccountsConfig=store.subAccountsConfig.get();(null==subAccount?void 0:subAccount.address)&&(this.accounts=(null==subAccountsConfig?void 0:subAccountsConfig.enableAutoSubAccounts)?prependWithoutDuplicates(this.accounts,subAccount.address):appendWithoutDuplicates(this.accounts,subAccount.address));const spendPermissions=null===(_c=null===(_b=null==response?void 0:response.accounts)||void 0===_b?void 0:_b[0].capabilities)||void 0===_c?void 0:_c.spendPermissions;spendPermissions&&"permissions"in spendPermissions&&store.spendPermissions.set(null==spendPermissions?void 0:spendPermissions.permissions),null===(_d=this.callback)||void 0===_d||_d.call(this,"accountsChanged",accounts_);break}case"wallet_addSubAccount":{assertSubAccount(result.value);const subAccount=result.value;store.subAccounts.set(subAccount);const subAccountsConfig=store.subAccountsConfig.get();this.accounts=(null==subAccountsConfig?void 0:subAccountsConfig.enableAutoSubAccounts)?prependWithoutDuplicates(this.accounts,subAccount.address):appendWithoutDuplicates(this.accounts,subAccount.address),null===(_e=this.callback)||void 0===_e||_e.call(this,"accountsChanged",this.accounts);break}}return result.value}async cleanup(){var _a,_b;const metadata=store.config.get().metadata;await this.keyManager.clear(),store.account.clear(),store.subAccounts.clear(),store.spendPermissions.clear(),store.chains.clear(),this.accounts=[],this.chain={id:null!==(_b=null===(_a=null==metadata?void 0:metadata.appChainIds)||void 0===_a?void 0:_a[0])&&void 0!==_b?_b:1}}async handleSwitchChainRequest(request){assertParamsChainId(request.params);const chainId=ensureIntNumber(request.params[0].chainId);if(this.updateChain(chainId))return null;const popupResult=await this.sendRequestToPopup(request);return null===popupResult&&this.updateChain(chainId),popupResult}async handleGetCapabilitiesRequest(request){!function assertGetCapabilitiesParams(params){if(!params||!Array.isArray(params)||1!==params.length&&2!==params.length)throw errors_standardErrors.rpc.invalidParams();if("string"!=typeof params[0]||!(0,isAddress.P)(params[0]))throw errors_standardErrors.rpc.invalidParams();if(2===params.length){if(!Array.isArray(params[1]))throw errors_standardErrors.rpc.invalidParams();for(const param of params[1])if("string"!=typeof param||!param.startsWith("0x"))throw errors_standardErrors.rpc.invalidParams()}}(request.params);const requestedAccount=request.params[0],filterChainIds=request.params[1];if(!this.accounts.some(account=>(0,isAddressEqual.h)(account,requestedAccount)))throw errors_standardErrors.provider.unauthorized("no active account found when getting capabilities");const capabilities=store.getState().account.capabilities;if(!capabilities)return{};if(!filterChainIds||0===filterChainIds.length)return capabilities;const filterChainNumbers=new Set(filterChainIds.map(chainId=>(0,fromHex.ME)(chainId)));return Object.fromEntries(Object.entries(capabilities).filter(([capabilityKey])=>{try{const capabilityChainNumber=(0,fromHex.ME)(capabilityKey);return filterChainNumbers.has(capabilityChainNumber)}catch(_a){return!1}}))}async sendEncryptedRequest(request){const sharedSecret=await this.keyManager.getSharedSecret();if(!sharedSecret)throw errors_standardErrors.provider.unauthorized("No shared secret found when encrypting request");const encrypted=await encryptContent({action:request,chainId:this.chain.id},sharedSecret),correlationId=correlationIds_get(request),message=await this.createRequestMessage({encrypted},correlationId);return this.communicator.postRequestAndWaitForResponse(message)}async createRequestMessage(content,correlationId){const publicKey=await exportKeyToHexString("public",await this.keyManager.getOwnPublicKey());return{id:crypto.randomUUID(),correlationId,sender:publicKey,content,timestamp:new Date}}async decryptResponseMessage(message){var _a,_b,_c;const content=message.content;if("failure"in content)throw content.failure;const sharedSecret=await this.keyManager.getSharedSecret();if(!sharedSecret)throw errors_standardErrors.provider.unauthorized("Invalid session: no shared secret found when decrypting response");const response=await decryptContent(content.encrypted,sharedSecret),availableChains=null===(_a=response.data)||void 0===_a?void 0:_a.chains;if(availableChains){const nativeCurrencies=null===(_b=response.data)||void 0===_b?void 0:_b.nativeCurrencies,chains=Object.entries(availableChains).map(([id,rpcUrl])=>{const nativeCurrency=null==nativeCurrencies?void 0:nativeCurrencies[Number(id)];return Object.assign({id:Number(id),rpcUrl},nativeCurrency?{nativeCurrency}:{})});store.chains.set(chains),this.updateChain(this.chain.id,chains),createClients(chains)}const walletCapabilities=null===(_c=response.data)||void 0===_c?void 0:_c.capabilities;return walletCapabilities&&store.account.set({capabilities:walletCapabilities}),response}updateChain(chainId,newAvailableChains){var _a;const state=store.getState(),chains=null!=newAvailableChains?newAvailableChains:state.chains,chain=null==chains?void 0:chains.find(chain=>chain.id===chainId);return!!chain&&(chain!==this.chain&&(this.chain=chain,store.account.set({chain}),null===(_a=this.callback)||void 0===_a||_a.call(this,"chainChanged",hexStringFromNumber(chain.id))),!0)}async addSubAccount(request){var _a,_b,_c,_d;const subAccount=store.getState().subAccount,subAccountsConfig=store.subAccountsConfig.get();if(null==subAccount?void 0:subAccount.address)return this.accounts=(null==subAccountsConfig?void 0:subAccountsConfig.enableAutoSubAccounts)?prependWithoutDuplicates(this.accounts,subAccount.address):appendWithoutDuplicates(this.accounts,subAccount.address),null===(_a=this.callback)||void 0===_a||_a.call(this,"accountsChanged",this.accounts),subAccount;if(await(null===(_c=(_b=this.communicator).waitForPopupLoaded)||void 0===_c?void 0:_c.call(_b)),Array.isArray(request.params)&&request.params.length>0&&request.params[0].account&&"create"===request.params[0].account.type){let keys;if(request.params[0].account.keys&&request.params[0].account.keys.length>0)keys=request.params[0].account.keys;else{const config=null!==(_d=store.subAccountsConfig.get())&&void 0!==_d?_d:{},{account:ownerAccount}=config.toOwnerAccount?await config.toOwnerAccount():await getCryptoKeyAccount();if(!ownerAccount)throw errors_standardErrors.provider.unauthorized("could not get subaccount owner account when adding sub account");keys=[{type:ownerAccount.address?"address":"webauthn-p256",publicKey:ownerAccount.address||ownerAccount.publicKey}]}request.params[0].account.keys=keys}const response=await this.sendRequestToPopup(request);return assertSubAccount(response),response}shouldRequestUseSubAccountSigner(request){const sender=getSenderFromRequest(request),subAccount=store.subAccounts.get();return!!sender&&sender.toLowerCase()===(null==subAccount?void 0:subAccount.address.toLowerCase())}async sendRequestToSubAccountSigner(request){var _a;const subAccount=store.subAccounts.get(),subAccountsConfig=store.subAccountsConfig.get(),config=store.config.get();assertPresence(null==subAccount?void 0:subAccount.address,errors_standardErrors.provider.unauthorized("no active sub account when sending request to sub account signer"));const ownerAccount=(null==subAccountsConfig?void 0:subAccountsConfig.toOwnerAccount)?await subAccountsConfig.toOwnerAccount():await getCryptoKeyAccount();assertPresence(null==ownerAccount?void 0:ownerAccount.account,errors_standardErrors.provider.unauthorized("no active sub account owner when sending request to sub account signer"));void 0===getSenderFromRequest(request)&&(request=function addSenderToRequest(request,sender){if(!Array.isArray(request.params))throw errors_standardErrors.rpc.invalidParams();const params=[...request.params];switch(request.method){case"eth_signTransaction":case"eth_sendTransaction":case"wallet_sendCalls":params[0].from=sender;break;case"eth_signTypedData_v4":params[0]=sender;break;case"personal_sign":params[1]=sender}return Object.assign(Object.assign({},request),{params})}(request,subAccount.address));const client=getClient(this.chain.id);assertPresence(client,errors_standardErrors.rpc.internal(`client not found for chainId ${this.chain.id} when sending request to sub account signer`));const globalAccountAddress=this.accounts.find(account=>account.toLowerCase()!==subAccount.address.toLowerCase());assertPresence(globalAccountAddress,errors_standardErrors.provider.unauthorized("no global account found when sending request to sub account signer"));const dataSuffix=makeDataSuffix({attribution:null===(_a=config.preference)||void 0===_a?void 0:_a.attribution,dappOrigin:window.location.origin}),publicKey="local"===ownerAccount.account.type?ownerAccount.account.address:ownerAccount.account.publicKey;let ownerIndex=await findOwnerIndex({address:subAccount.address,factory:subAccount.factory,factoryData:subAccount.factoryData,publicKey,client});if(-1===ownerIndex){const correlationId=correlationIds_get(request);(({method,correlationId})=>{var _a;logEvent("scw_sub_account.add_owner.started",{action:ActionType.unknown,componentType:ComponentType.unknown,method,correlationId,enableAutoSubAccounts:null===(_a=store.subAccountsConfig.get())||void 0===_a?void 0:_a.enableAutoSubAccounts},AnalyticsEventImportance.high)})({method:request.method,correlationId});try{ownerIndex=await handleAddSubAccountOwner({ownerAccount:ownerAccount.account,globalAccountRequest:this.sendRequestToPopup.bind(this)}),(({method,correlationId})=>{var _a;logEvent("scw_sub_account.add_owner.completed",{action:ActionType.unknown,componentType:ComponentType.unknown,method,correlationId,enableAutoSubAccounts:null===(_a=store.subAccountsConfig.get())||void 0===_a?void 0:_a.enableAutoSubAccounts},AnalyticsEventImportance.high)})({method:request.method,correlationId})}catch(error){return(({method,correlationId,errorMessage})=>{var _a;logEvent("scw_sub_account.add_owner.error",{action:ActionType.error,componentType:ComponentType.unknown,method,correlationId,errorMessage,enableAutoSubAccounts:null===(_a=store.subAccountsConfig.get())||void 0===_a?void 0:_a.enableAutoSubAccounts},AnalyticsEventImportance.high)})({method:request.method,correlationId,errorMessage:parseErrorMessageFromAny(error)}),errors_standardErrors.provider.unauthorized("failed to add sub account owner when sending request to sub account signer")}}const{request:subAccountRequest}=await createSubAccountSigner({address:subAccount.address,owner:ownerAccount.account,client,factory:subAccount.factory,factoryData:subAccount.factoryData,parentAddress:globalAccountAddress,attribution:dataSuffix?{suffix:dataSuffix}:void 0,ownerIndex});try{return await subAccountRequest(request)}catch(error){let errorObject;if(isViemError(error))errorObject=JSON.parse(error.details);else{if(!isActionableHttpRequestError(error))throw error;errorObject=error}if(!isActionableHttpRequestError(errorObject)||!errorObject.data)throw error;if(!errorObject.data)throw error;const correlationId=correlationIds_get(request);(({method,correlationId})=>{var _a;logEvent("scw_sub_account.insufficient_balance.error_handling.started",{action:ActionType.unknown,componentType:ComponentType.unknown,method,correlationId,enableAutoSubAccounts:null===(_a=store.subAccountsConfig.get())||void 0===_a?void 0:_a.enableAutoSubAccounts},AnalyticsEventImportance.high)})({method:request.method,correlationId});try{const result=await handleInsufficientBalanceError({errorData:errorObject.data,globalAccountAddress,subAccountAddress:subAccount.address,client,request,subAccountRequest,globalAccountRequest:this.request.bind(this)});return(({method,correlationId})=>{var _a;logEvent("scw_sub_account.insufficient_balance.error_handling.completed",{action:ActionType.unknown,componentType:ComponentType.unknown,method,correlationId,enableAutoSubAccounts:null===(_a=store.subAccountsConfig.get())||void 0===_a?void 0:_a.enableAutoSubAccounts},AnalyticsEventImportance.high)})({method:request.method,correlationId}),result}catch(handlingError){throw SCWSigner_console.error(handlingError),(({method,correlationId,errorMessage})=>{var _a;logEvent("scw_sub_account.insufficient_balance.error_handling.error",{action:ActionType.error,componentType:ComponentType.unknown,method,correlationId,errorMessage,enableAutoSubAccounts:null===(_a=store.subAccountsConfig.get())||void 0===_a?void 0:_a.enableAutoSubAccounts},AnalyticsEventImportance.high)})({method:request.method,correlationId,errorMessage:parseErrorMessageFromAny(handlingError)}),error}}}}const logWalletLinkConnectionConnectionFailed=()=>{logEvent("walletlink_signer.walletlink_connection.connection_failed",{action:ActionType.measurement,componentType:ComponentType.unknown},AnalyticsEventImportance.high)};var eth_eip712_util=__webpack_require__("./node_modules/@coinbase/wallet-sdk/dist/vendor-js/eth-eip712-util/index.cjs"),eth_eip712_util_default=__webpack_require__.n(eth_eip712_util);class WalletLinkCipher{constructor(secret){this.secret=secret}async encrypt(plainText){const secret=this.secret;if(64!==secret.length)throw new Error("secret must be 256 bits");const ivBytes=crypto.getRandomValues(new Uint8Array(12)),secretKey=await crypto.subtle.importKey("raw",hexStringToUint8Array(secret),{name:"aes-gcm"},!1,["encrypt","decrypt"]),enc=new TextEncoder,encryptedResult=await window.crypto.subtle.encrypt({name:"AES-GCM",iv:ivBytes},secretKey,enc.encode(plainText)),authTag=encryptedResult.slice(encryptedResult.byteLength-16),encryptedPlaintext=encryptedResult.slice(0,encryptedResult.byteLength-16),authTagBytes=new Uint8Array(authTag),encryptedPlaintextBytes=new Uint8Array(encryptedPlaintext);return uint8ArrayToHex(new Uint8Array([...ivBytes,...authTagBytes,...encryptedPlaintextBytes]))}async decrypt(cipherText){const secret=this.secret;if(64!==secret.length)throw new Error("secret must be 256 bits");return new Promise((resolve,reject)=>{(async()=>{const secretKey=await crypto.subtle.importKey("raw",hexStringToUint8Array(secret),{name:"aes-gcm"},!1,["encrypt","decrypt"]),encrypted=hexStringToUint8Array(cipherText),ivBytes=encrypted.slice(0,12),authTagBytes=encrypted.slice(12,28),encryptedPlaintextBytes=encrypted.slice(28),concatenatedBytes=new Uint8Array([...encryptedPlaintextBytes,...authTagBytes]),algo={name:"AES-GCM",iv:new Uint8Array(ivBytes)};try{const decrypted=await window.crypto.subtle.decrypt(algo,secretKey,concatenatedBytes),decoder=new TextDecoder;resolve(decoder.decode(decrypted))}catch(err){reject(err)}})()})}}var ConnectionState,WalletLinkHTTP_console=__webpack_require__("./node_modules/console-browserify/index.js");class WalletLinkHTTP{constructor(linkAPIUrl,sessionId,sessionKey){this.linkAPIUrl=linkAPIUrl,this.sessionId=sessionId;const credentials=`${sessionId}:${sessionKey}`;this.auth=`Basic ${btoa(credentials)}`}async markUnseenEventsAsSeen(events){return Promise.all(events.map(e=>fetch(`${this.linkAPIUrl}/events/${e.eventId}/seen`,{method:"POST",headers:{Authorization:this.auth}}))).catch(error=>WalletLinkHTTP_console.error("Unable to mark events as seen:",error))}async fetchUnseenEvents(){var _a;const response=await fetch(`${this.linkAPIUrl}/events?unseen=true`,{headers:{Authorization:this.auth}});if(response.ok){const{events,error}=await response.json();if(error)throw new Error(`Check unseen events failed: ${error}`);const responseEvents=null!==(_a=null==events?void 0:events.filter(e=>"Web3Response"===e.event).map(e=>({type:"Event",sessionId:this.sessionId,eventId:e.id,event:e.event,data:e.data})))&&void 0!==_a?_a:[];return this.markUnseenEventsAsSeen(responseEvents),responseEvents}throw new Error(`Check unseen events failed: ${response.status}`)}}!function(ConnectionState){ConnectionState[ConnectionState.DISCONNECTED=0]="DISCONNECTED",ConnectionState[ConnectionState.CONNECTING=1]="CONNECTING",ConnectionState[ConnectionState.CONNECTED=2]="CONNECTED"}(ConnectionState||(ConnectionState={}));class WalletLinkWebSocket{setConnectionStateListener(listener){this.connectionStateListener=listener}setIncomingDataListener(listener){this.incomingDataListener=listener}constructor(url,WebSocketClass=WebSocket){this.WebSocketClass=WebSocketClass,this.webSocket=null,this.isDisconnecting=!1,this.url=url.replace(/^http/,"ws"),this.instanceId=WalletLinkWebSocket.instanceCounter++,WalletLinkWebSocket.activeInstances.add(this.instanceId)}async connect(){if(this.webSocket)throw new Error("webSocket object is not null");if(this.isDisconnecting)throw new Error("WebSocket is disconnecting, cannot reconnect on same instance");return new Promise((resolve,reject)=>{var _a;let webSocket;try{this.webSocket=webSocket=new this.WebSocketClass(this.url)}catch(err){return void reject(err)}null===(_a=this.connectionStateListener)||void 0===_a||_a.call(this,ConnectionState.CONNECTING),webSocket.onclose=evt=>{var _a;this.clearWebSocket(),webSocket.readyState!==WebSocket.OPEN&&reject(new Error(`websocket error ${evt.code}: ${evt.reason}`)),null===(_a=this.connectionStateListener)||void 0===_a||_a.call(this,ConnectionState.DISCONNECTED)},webSocket.onopen=_=>{var _a;if(resolve(),null===(_a=this.connectionStateListener)||void 0===_a||_a.call(this,ConnectionState.CONNECTED),WalletLinkWebSocket.pendingData.length>0){[...WalletLinkWebSocket.pendingData].forEach(data=>this.sendData(data)),WalletLinkWebSocket.pendingData=[]}},webSocket.onmessage=evt=>{var _a,_b;if("h"===evt.data)null===(_a=this.incomingDataListener)||void 0===_a||_a.call(this,{type:"Heartbeat"});else try{const message=JSON.parse(evt.data);null===(_b=this.incomingDataListener)||void 0===_b||_b.call(this,message)}catch(_c){}}})}disconnect(){var _a;const{webSocket}=this;if(webSocket){this.isDisconnecting=!0,this.clearWebSocket(),null===(_a=this.connectionStateListener)||void 0===_a||_a.call(this,ConnectionState.DISCONNECTED),this.connectionStateListener=void 0,this.incomingDataListener=void 0;try{webSocket.close()}catch(_b){}}}sendData(data){const{webSocket}=this;if(!webSocket)return WalletLinkWebSocket.pendingData.push(data),void(this.isDisconnecting||this.connect());webSocket.readyState===WebSocket.OPEN?webSocket.send(data):WalletLinkWebSocket.pendingData.push(data)}clearWebSocket(){const{webSocket}=this;webSocket&&(this.webSocket=null,webSocket.onclose=null,webSocket.onerror=null,webSocket.onmessage=null,webSocket.onopen=null)}cleanup(){WalletLinkWebSocket.activeInstances.delete(this.instanceId)}}WalletLinkWebSocket.instanceCounter=0,WalletLinkWebSocket.activeInstances=new Set,WalletLinkWebSocket.pendingData=[];var WalletLinkConnection_console=__webpack_require__("./node_modules/console-browserify/index.js");class WalletLinkConnection{constructor({session,linkAPIUrl,listener}){this.destroyed=!1,this.lastHeartbeatResponse=0,this.nextReqId=type_IntNumber(1),this.reconnectAttempts=0,this.isReconnecting=!1,this._connected=!1,this._linked=!1,this.requestResolutions=new Map,this.handleSessionMetadataUpdated=metadata=>{if(!metadata)return;const handlers=new Map([["__destroyed",this.handleDestroyed],["EthereumAddress",this.handleAccountUpdated],["WalletUsername",this.handleWalletUsernameUpdated],["AppVersion",this.handleAppVersionUpdated],["ChainId",v=>metadata.JsonRpcUrl&&this.handleChainUpdated(v,metadata.JsonRpcUrl)]]);handlers.forEach((handler,key)=>{const value=metadata[key];void 0!==value&&handler(value)})},this.handleDestroyed=__destroyed=>{var _a;"1"===__destroyed&&(null===(_a=this.listener)||void 0===_a||_a.resetAndReload())},this.handleAccountUpdated=async encryptedEthereumAddress=>{var _a;try{const address=await this.cipher.decrypt(encryptedEthereumAddress);null===(_a=this.listener)||void 0===_a||_a.accountUpdated(address)}catch(_b){}},this.handleMetadataUpdated=async(key,encryptedMetadataValue)=>{var _a;try{const decryptedValue=await this.cipher.decrypt(encryptedMetadataValue);null===(_a=this.listener)||void 0===_a||_a.metadataUpdated(key,decryptedValue)}catch(_b){}},this.handleWalletUsernameUpdated=async walletUsername=>{this.handleMetadataUpdated("walletUsername",walletUsername)},this.handleAppVersionUpdated=async appVersion=>{this.handleMetadataUpdated("AppVersion",appVersion)},this.handleChainUpdated=async(encryptedChainId,encryptedJsonRpcUrl)=>{var _a;try{const chainId=await this.cipher.decrypt(encryptedChainId),jsonRpcUrl=await this.cipher.decrypt(encryptedJsonRpcUrl);null===(_a=this.listener)||void 0===_a||_a.chainUpdated(chainId,jsonRpcUrl)}catch(_b){}},this.session=session,this.cipher=new WalletLinkCipher(session.secret),this.listener=listener,this.linkAPIUrl=linkAPIUrl,this.WebSocketClass=WebSocket;const ws=this.createWebSocket();this.ws=ws,this.http=new WalletLinkHTTP(linkAPIUrl,session.id,session.key),this.setupVisibilityChangeHandler()}createWebSocket(){const ws=new WalletLinkWebSocket(`${this.linkAPIUrl}/rpc`,this.WebSocketClass);return this.activeWsInstance=ws,ws.setConnectionStateListener(async state=>{if(ws!==this.activeWsInstance)return;let connected=!1;switch(state){case ConnectionState.DISCONNECTED:if(this.heartbeatIntervalId&&(clearInterval(this.heartbeatIntervalId),this.heartbeatIntervalId=void 0),this.lastHeartbeatResponse=0,connected=!1,!this.destroyed){(async()=>{if(this.isReconnecting)return;this.isReconnecting=!0;const delay=0===this.reconnectAttempts?0:3e3;await new Promise(resolve=>setTimeout(resolve,delay)),this.destroyed||ws!==this.activeWsInstance?this.isReconnecting=!1:(this.reconnectAttempts++,"cleanup"in this.ws&&"function"==typeof this.ws.cleanup&&this.ws.cleanup(),this.ws=this.createWebSocket(),this.ws.connect().catch(()=>{logWalletLinkConnectionConnectionFailed()}).finally(()=>{this.isReconnecting=!1}))})()}break;case ConnectionState.CONNECTED:this.reconnectAttempts=0;try{connected=await this.handleConnected(),this.fetchUnseenEventsAPI().catch(()=>{})}catch(_error){break}this.connected=connected,this.updateLastHeartbeat(),this.heartbeatIntervalId&&clearInterval(this.heartbeatIntervalId),this.heartbeatIntervalId=window.setInterval(()=>{this.heartbeat()},1e4),setTimeout(()=>{this.heartbeat()},100);case ConnectionState.CONNECTING:}state!==ConnectionState.CONNECTED&&(this.connected=connected)}),ws.setIncomingDataListener(m=>{var _a;switch(m.type){case"Heartbeat":return void this.updateLastHeartbeat();case"IsLinkedOK":case"Linked":{const linked="IsLinkedOK"===m.type?m.linked:void 0;this.linked=linked||m.onlineGuests>0;break}case"GetSessionConfigOK":case"SessionConfigUpdated":this.handleSessionMetadataUpdated(m.metadata);break;case"Event":this.handleIncomingEvent(m)}void 0!==m.id&&(null===(_a=this.requestResolutions.get(m.id))||void 0===_a||_a(m))}),ws}setupVisibilityChangeHandler(){this.visibilityChangeHandler=()=>{document.hidden||this.destroyed||(this.connected?this.heartbeat():this.reconnectWithFreshWebSocket())},this.focusHandler=()=>{this.destroyed||this.connected||this.reconnectWithFreshWebSocket()},document.addEventListener("visibilitychange",this.visibilityChangeHandler),window.addEventListener("focus",this.focusHandler),window.addEventListener("pageshow",event=>{event.persisted&&this.focusHandler&&this.focusHandler()})}reconnectWithFreshWebSocket(){if(this.destroyed)return;const oldWs=this.ws;this.activeWsInstance=void 0,oldWs.disconnect(),"cleanup"in oldWs&&"function"==typeof oldWs.cleanup&&oldWs.cleanup(),this.ws=this.createWebSocket(),this.ws.connect().catch(()=>{logWalletLinkConnectionConnectionFailed()})}connect(){if(this.destroyed)throw new Error("instance is destroyed");this.ws.connect()}async destroy(){this.destroyed||(await this.makeRequest({type:"SetSessionConfig",id:type_IntNumber(this.nextReqId++),sessionId:this.session.id,metadata:{__destroyed:"1"}},{timeout:1e3}),this.destroyed=!0,this.activeWsInstance=void 0,this.heartbeatIntervalId&&(clearInterval(this.heartbeatIntervalId),this.heartbeatIntervalId=void 0),this.visibilityChangeHandler&&document.removeEventListener("visibilitychange",this.visibilityChangeHandler),this.focusHandler&&window.removeEventListener("focus",this.focusHandler),this.ws.disconnect(),"cleanup"in this.ws&&"function"==typeof this.ws.cleanup&&this.ws.cleanup(),this.listener=void 0)}get connected(){return this._connected}set connected(connected){this._connected=connected}get linked(){return this._linked}set linked(linked){var _a,_b;this._linked=linked,linked&&(null===(_a=this.onceLinked)||void 0===_a||_a.call(this)),null===(_b=this.listener)||void 0===_b||_b.linkedUpdated(linked)}setOnceLinked(callback){return new Promise(resolve=>{this.linked?callback().then(resolve):this.onceLinked=()=>{callback().then(resolve),this.onceLinked=void 0}})}async handleIncomingEvent(m){var _a;if("Event"===m.type&&"Web3Response"===m.event)try{const decryptedData=await this.cipher.decrypt(m.data),message=JSON.parse(decryptedData);if("WEB3_RESPONSE"!==message.type)return;null===(_a=this.listener)||void 0===_a||_a.handleWeb3ResponseMessage(message.id,message.response)}catch(_error){}}async checkUnseenEvents(){await new Promise(resolve=>setTimeout(resolve,250));try{await this.fetchUnseenEventsAPI()}catch(e){WalletLinkConnection_console.error("Unable to check for unseen events",e)}}async fetchUnseenEventsAPI(){try{(await this.http.fetchUnseenEvents()).forEach(e=>{this.handleIncomingEvent(e)})}catch(_error){logEvent("walletlink_signer.walletlink_connection.fetch_unseen_events_failed",{action:ActionType.measurement,componentType:ComponentType.unknown},AnalyticsEventImportance.high)}}async publishEvent(event,unencryptedData,callWebhook=!1){const data=await this.cipher.encrypt(JSON.stringify(Object.assign(Object.assign({},unencryptedData),{origin:location.origin,location:location.href,relaySource:"coinbaseWalletExtension"in window&&window.coinbaseWalletExtension?"injected_sdk":"sdk"}))),message={type:"PublishEvent",id:type_IntNumber(this.nextReqId++),sessionId:this.session.id,event,data,callWebhook};return this.setOnceLinked(async()=>{const res=await this.makeRequest(message);if("Fail"===res.type)throw new Error(res.error||"failed to publish event");return res.eventId})}sendData(message){this.ws.sendData(JSON.stringify(message))}updateLastHeartbeat(){this.lastHeartbeatResponse=Date.now()}heartbeat(){if(Date.now()-this.lastHeartbeatResponse>2e4)this.ws.disconnect();else if(this.connected)try{this.ws.sendData("h")}catch(_error){}}async makeRequest(message,options={timeout:6e4}){const reqId=message.id;let timeoutId;return this.sendData(message),Promise.race([new Promise((_,reject)=>{timeoutId=window.setTimeout(()=>{reject(new Error(`request ${reqId} timed out`))},options.timeout)}),new Promise(resolve=>{this.requestResolutions.set(reqId,m=>{clearTimeout(timeoutId),resolve(m),this.requestResolutions.delete(reqId)})})])}async handleConnected(){return"Fail"!==(await this.makeRequest({type:"HostSession",id:type_IntNumber(this.nextReqId++),sessionId:this.session.id,sessionKey:this.session.key})).type&&(this.sendData({type:"IsLinked",id:type_IntNumber(this.nextReqId++),sessionId:this.session.id}),this.sendData({type:"GetSessionConfig",id:type_IntNumber(this.nextReqId++),sessionId:this.session.id}),!0)}}class RelayEventManager{constructor(){this._nextRequestId=0,this.callbacks=new Map}makeRequestId(){this._nextRequestId=(this._nextRequestId+1)%2147483647;const id=this._nextRequestId,idStr=prepend0x(id.toString(16));return this.callbacks.get(idStr)&&this.callbacks.delete(idStr),id}}function _assert_bytes(b,...lengths){if(!function isBytes(a){return a instanceof Uint8Array||null!=a&&"object"==typeof a&&"Uint8Array"===a.constructor.name}(b))throw new Error("Uint8Array expected");if(lengths.length>0&&!lengths.includes(b.length))throw new Error(`Uint8Array expected of length ${lengths}, not of length=${b.length}`)}function exists(instance,checkFinished=!0){if(instance.destroyed)throw new Error("Hash instance has been destroyed");if(checkFinished&&instance.finished)throw new Error("Hash#digest() has already been called")}function output(out,instance){_assert_bytes(out);const min=instance.outputLen;if(out.length<min)throw new Error(`digestInto() expects output buffer of length at least ${min}`)}const createView=arr=>new DataView(arr.buffer,arr.byteOffset,arr.byteLength),rotr=(word,shift)=>word<<32-shift|word>>>shift;new Uint8Array(new Uint32Array([287454020]).buffer)[0];const utils_hexes=Array.from({length:256},(_,i)=>i.toString(16).padStart(2,"0"));function utils_toBytes(data){return"string"==typeof data&&(data=function utf8ToBytes(str){if("string"!=typeof str)throw new Error("utf8ToBytes expected string, got "+typeof str);return new Uint8Array((new TextEncoder).encode(str))}(data)),_assert_bytes(data),data}class utils_Hash{clone(){return this._cloneInto()}}function utils_wrapConstructor(hashCons){const hashC=msg=>hashCons().update(utils_toBytes(msg)).digest(),tmp=hashCons();return hashC.outputLen=tmp.outputLen,hashC.blockLen=tmp.blockLen,hashC.create=()=>hashCons(),hashC}const Chi=(a,b,c)=>a&b^~a&c,Maj=(a,b,c)=>a&b^a&c^b&c;class HashMD extends utils_Hash{constructor(blockLen,outputLen,padOffset,isLE){super(),this.blockLen=blockLen,this.outputLen=outputLen,this.padOffset=padOffset,this.isLE=isLE,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(blockLen),this.view=createView(this.buffer)}update(data){exists(this);const{view,buffer,blockLen}=this,len=(data=utils_toBytes(data)).length;for(let pos=0;pos<len;){const take=Math.min(blockLen-this.pos,len-pos);if(take===blockLen){const dataView=createView(data);for(;blockLen<=len-pos;pos+=blockLen)this.process(dataView,pos);continue}buffer.set(data.subarray(pos,pos+take),this.pos),this.pos+=take,pos+=take,this.pos===blockLen&&(this.process(view,0),this.pos=0)}return this.length+=data.length,this.roundClean(),this}digestInto(out){exists(this),output(out,this),this.finished=!0;const{buffer,view,blockLen,isLE}=this;let{pos}=this;buffer[pos++]=128,this.buffer.subarray(pos).fill(0),this.padOffset>blockLen-pos&&(this.process(view,0),pos=0);for(let i=pos;i<blockLen;i++)buffer[i]=0;!function setBigUint64(view,byteOffset,value,isLE){if("function"==typeof view.setBigUint64)return view.setBigUint64(byteOffset,value,isLE);const _32n=BigInt(32),_u32_max=BigInt(4294967295),wh=Number(value>>_32n&_u32_max),wl=Number(value&_u32_max),h=isLE?4:0,l=isLE?0:4;view.setUint32(byteOffset+h,wh,isLE),view.setUint32(byteOffset+l,wl,isLE)}(view,blockLen-8,BigInt(8*this.length),isLE),this.process(view,0);const oview=createView(out),len=this.outputLen;if(len%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const outLen=len/4,state=this.get();if(outLen>state.length)throw new Error("_sha2: outputLen bigger than state");for(let i=0;i<outLen;i++)oview.setUint32(4*i,state[i],isLE)}digest(){const{buffer,outputLen}=this;this.digestInto(buffer);const res=buffer.slice(0,outputLen);return this.destroy(),res}_cloneInto(to){to||(to=new this.constructor),to.set(...this.get());const{blockLen,buffer,length,finished,destroyed,pos}=this;return to.length=length,to.pos=pos,to.finished=finished,to.destroyed=destroyed,length%blockLen&&to.buffer.set(buffer),to}}const SHA256_K=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),SHA256_IV=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),SHA256_W=new Uint32Array(64);class SHA256 extends HashMD{constructor(){super(64,32,8,!1),this.A=0|SHA256_IV[0],this.B=0|SHA256_IV[1],this.C=0|SHA256_IV[2],this.D=0|SHA256_IV[3],this.E=0|SHA256_IV[4],this.F=0|SHA256_IV[5],this.G=0|SHA256_IV[6],this.H=0|SHA256_IV[7]}get(){const{A,B,C,D,E,F,G,H}=this;return[A,B,C,D,E,F,G,H]}set(A,B,C,D,E,F,G,H){this.A=0|A,this.B=0|B,this.C=0|C,this.D=0|D,this.E=0|E,this.F=0|F,this.G=0|G,this.H=0|H}process(view,offset){for(let i=0;i<16;i++,offset+=4)SHA256_W[i]=view.getUint32(offset,!1);for(let i=16;i<64;i++){const W15=SHA256_W[i-15],W2=SHA256_W[i-2],s0=rotr(W15,7)^rotr(W15,18)^W15>>>3,s1=rotr(W2,17)^rotr(W2,19)^W2>>>10;SHA256_W[i]=s1+SHA256_W[i-7]+s0+SHA256_W[i-16]|0}let{A,B,C,D,E,F,G,H}=this;for(let i=0;i<64;i++){const T1=H+(rotr(E,6)^rotr(E,11)^rotr(E,25))+Chi(E,F,G)+SHA256_K[i]+SHA256_W[i]|0,T2=(rotr(A,2)^rotr(A,13)^rotr(A,22))+Maj(A,B,C)|0;H=G,G=F,F=E,E=D+T1|0,D=C,C=B,B=A,A=T1+T2|0}A=A+this.A|0,B=B+this.B|0,C=C+this.C|0,D=D+this.D|0,E=E+this.E|0,F=F+this.F|0,G=G+this.G|0,H=H+this.H|0,this.set(A,B,C,D,E,F,G,H)}roundClean(){SHA256_W.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const sha256_sha256=utils_wrapConstructor(()=>new SHA256);class WalletLinkSession{constructor(storage,id,secret,linked=!1){this.storage=storage,this.id=id,this.secret=secret,this.key=function bytesToHex(bytes){_assert_bytes(bytes);let hex="";for(let i=0;i<bytes.length;i++)hex+=utils_hexes[bytes[i]];return hex}(sha256_sha256(`${id}, ${secret} WalletLink`)),this._linked=!!linked}static create(storage){const id=randomBytesHex(16),secret=randomBytesHex(32);return new WalletLinkSession(storage,id,secret).save()}static load(storage){const id=storage.getItem("session:id"),linked=storage.getItem("session:linked"),secret=storage.getItem("session:secret");return id&&secret?new WalletLinkSession(storage,id,secret,"1"===linked):null}get linked(){return this._linked}set linked(val){this._linked=val,this.persistLinked()}save(){return this.storage.setItem("session:id",this.id),this.storage.setItem("session:secret",this.secret),this.persistLinked(),this}persistLinked(){this.storage.setItem("session:linked",this._linked?"1":"0")}}class RedirectDialog{constructor(){this.root=null,this.darkMode=isDarkMode()}attach(){const el=document.documentElement;this.root=document.createElement("div"),this.root.className="-cbwsdk-css-reset",el.appendChild(this.root),injectCssReset()}present(props){this.render(props)}clear(){this.render(null)}render(props){this.root&&(B(null,this.root),props&&B(_(RedirectDialogContent,Object.assign({},props,{onDismiss:()=>{this.clear()},darkMode:this.darkMode})),this.root))}}const RedirectDialogContent=({title,buttonText,darkMode,onButtonClick,onDismiss})=>{const theme=darkMode?"dark":"light";return _(SnackbarContainer,{darkMode},_("div",{class:"-cbwsdk-redirect-dialog"},_("style",null,".-cbwsdk-css-reset .-cbwsdk-redirect-dialog-backdrop{position:fixed;top:0;left:0;right:0;bottom:0;transition:opacity .25s;background-color:rgba(10,11,13,.5)}.-cbwsdk-css-reset .-cbwsdk-redirect-dialog-backdrop-hidden{opacity:0}.-cbwsdk-css-reset .-cbwsdk-redirect-dialog-box{display:block;position:fixed;top:50%;left:50%;transform:translate(-50%, -50%);padding:20px;border-radius:8px;background-color:#fff;color:#0a0b0d}.-cbwsdk-css-reset .-cbwsdk-redirect-dialog-box p{display:block;font-weight:400;font-size:14px;line-height:20px;padding-bottom:12px;color:#5b636e}.-cbwsdk-css-reset .-cbwsdk-redirect-dialog-box button{appearance:none;border:none;background:none;color:#0052ff;padding:0;text-decoration:none;display:block;font-weight:600;font-size:16px;line-height:24px}.-cbwsdk-css-reset .-cbwsdk-redirect-dialog-box.dark{background-color:#0a0b0d;color:#fff}.-cbwsdk-css-reset .-cbwsdk-redirect-dialog-box.dark button{color:#0052ff}.-cbwsdk-css-reset .-cbwsdk-redirect-dialog-box.light{background-color:#fff;color:#0a0b0d}.-cbwsdk-css-reset .-cbwsdk-redirect-dialog-box.light button{color:#0052ff}"),_("div",{class:"-cbwsdk-redirect-dialog-backdrop",onClick:onDismiss}),_("div",{class:clsx("-cbwsdk-redirect-dialog-box",theme)},_("p",null,title),_("button",{onClick:onButtonClick},buttonText))))};class WLMobileRelayUI{constructor(){this.attached=!1,this.redirectDialog=new RedirectDialog}attach(){if(this.attached)throw new Error("Coinbase Wallet SDK UI is already attached");this.redirectDialog.attach(),this.attached=!0}redirectToCoinbaseWallet(walletLinkUrl){const url=new URL("https://go.cb-w.com/walletlink");url.searchParams.append("redirect_url",getLocation().href),walletLinkUrl&&url.searchParams.append("wl_url",walletLinkUrl);const anchorTag=document.createElement("a");anchorTag.target="cbw-opener",anchorTag.href=url.href,anchorTag.rel="noreferrer noopener",anchorTag.click()}openCoinbaseWalletDeeplink(walletLinkUrl){this.redirectToCoinbaseWallet(walletLinkUrl),setTimeout(()=>{this.redirectDialog.present({title:"Redirecting to Coinbase Wallet...",buttonText:"Open",onButtonClick:()=>{this.redirectToCoinbaseWallet(walletLinkUrl)}})},99)}showConnecting(_options){return()=>{this.redirectDialog.clear()}}}class WalletLinkRelay{constructor(options){this.chainCallbackParams={chainId:"",jsonRpcUrl:""},this.isMobileWeb=function isMobileWeb(){var _a;return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(null===(_a=null===window||void 0===window?void 0:window.navigator)||void 0===_a?void 0:_a.userAgent)}(),this.linkedUpdated=linked=>{this.isLinked=linked;const cachedAddresses=this.storage.getItem("Addresses");if(linked&&(this._session.linked=linked),this.isUnlinkedErrorState=!1,cachedAddresses){const addresses=cachedAddresses.split(" "),wasConnectedViaStandalone="true"===this.storage.getItem("IsStandaloneSigning");""===addresses[0]||linked||!this._session.linked||wasConnectedViaStandalone||(this.isUnlinkedErrorState=!0)}},this.metadataUpdated=(key,value)=>{this.storage.setItem(key,value)},this.chainUpdated=(chainId,jsonRpcUrl)=>{this.chainCallbackParams.chainId===chainId&&this.chainCallbackParams.jsonRpcUrl===jsonRpcUrl||(this.chainCallbackParams={chainId,jsonRpcUrl},this.chainCallback&&this.chainCallback(jsonRpcUrl,Number.parseInt(chainId,10)))},this.accountUpdated=selectedAddress=>{this.accountsCallback&&this.accountsCallback([selectedAddress]),WalletLinkRelay.accountRequestCallbackIds.size>0&&(Array.from(WalletLinkRelay.accountRequestCallbackIds.values()).forEach(id=>{this.invokeCallback(id,{method:"requestEthereumAccounts",result:[selectedAddress]})}),WalletLinkRelay.accountRequestCallbackIds.clear())},this.resetAndReload=this.resetAndReload.bind(this),this.linkAPIUrl=options.linkAPIUrl,this.storage=options.storage,this.metadata=options.metadata,this.accountsCallback=options.accountsCallback,this.chainCallback=options.chainCallback;const{session,ui,connection}=this.subscribe();this._session=session,this.connection=connection,this.relayEventManager=new RelayEventManager,this.ui=ui,this.ui.attach()}subscribe(){const session=WalletLinkSession.load(this.storage)||WalletLinkSession.create(this.storage),{linkAPIUrl}=this,connection=new WalletLinkConnection({session,linkAPIUrl,listener:this}),ui=this.isMobileWeb?new WLMobileRelayUI:new WalletLinkRelayUI;return connection.connect(),{session,ui,connection}}resetAndReload(){this.connection.destroy().then(()=>{const storedSession=WalletLinkSession.load(this.storage);(null==storedSession?void 0:storedSession.id)===this._session.id&&ScopedLocalStorage.clearAll(),document.location.reload()}).catch(_=>{})}signEthereumTransaction(params){return this.sendRequest({method:"signEthereumTransaction",params:{fromAddress:params.fromAddress,toAddress:params.toAddress,weiValue:bigIntStringFromBigInt(params.weiValue),data:hexStringFromBuffer(params.data,!0),nonce:params.nonce,gasPriceInWei:params.gasPriceInWei?bigIntStringFromBigInt(params.gasPriceInWei):null,maxFeePerGas:params.gasPriceInWei?bigIntStringFromBigInt(params.gasPriceInWei):null,maxPriorityFeePerGas:params.gasPriceInWei?bigIntStringFromBigInt(params.gasPriceInWei):null,gasLimit:params.gasLimit?bigIntStringFromBigInt(params.gasLimit):null,chainId:params.chainId,shouldSubmit:!1}})}signAndSubmitEthereumTransaction(params){return this.sendRequest({method:"signEthereumTransaction",params:{fromAddress:params.fromAddress,toAddress:params.toAddress,weiValue:bigIntStringFromBigInt(params.weiValue),data:hexStringFromBuffer(params.data,!0),nonce:params.nonce,gasPriceInWei:params.gasPriceInWei?bigIntStringFromBigInt(params.gasPriceInWei):null,maxFeePerGas:params.maxFeePerGas?bigIntStringFromBigInt(params.maxFeePerGas):null,maxPriorityFeePerGas:params.maxPriorityFeePerGas?bigIntStringFromBigInt(params.maxPriorityFeePerGas):null,gasLimit:params.gasLimit?bigIntStringFromBigInt(params.gasLimit):null,chainId:params.chainId,shouldSubmit:!0}})}submitEthereumTransaction(signedTransaction,chainId){return this.sendRequest({method:"submitEthereumTransaction",params:{signedTransaction:hexStringFromBuffer(signedTransaction,!0),chainId}})}getWalletLinkSession(){return this._session}sendRequest(request){let hideSnackbarItem=null;const id=randomBytesHex(8),cancel=error=>{this.publishWeb3RequestCanceledEvent(id),this.handleErrorResponse(id,request.method,error),null==hideSnackbarItem||hideSnackbarItem()};return new Promise((resolve,reject)=>{hideSnackbarItem=this.ui.showConnecting({isUnlinkedErrorState:this.isUnlinkedErrorState,onCancel:cancel,onResetConnection:this.resetAndReload}),this.relayEventManager.callbacks.set(id,response=>{if(null==hideSnackbarItem||hideSnackbarItem(),isErrorResponse(response))return reject(new Error(response.errorMessage));resolve(response)}),this.publishWeb3RequestEvent(id,request)})}publishWeb3RequestEvent(id,request){const message={type:"WEB3_REQUEST",id,request};this.publishEvent("Web3Request",message,!0).then(_=>{}).catch(err=>{this.handleWeb3ResponseMessage(message.id,{method:request.method,errorMessage:err.message})}),this.isMobileWeb&&this.openCoinbaseWalletDeeplink(request.method)}openCoinbaseWalletDeeplink(method){if(this.ui instanceof WLMobileRelayUI)switch(method){case"requestEthereumAccounts":case"switchEthereumChain":return;default:window.addEventListener("blur",()=>{window.addEventListener("focus",()=>{this.connection.checkUnseenEvents()},{once:!0})},{once:!0}),this.ui.openCoinbaseWalletDeeplink()}}publishWeb3RequestCanceledEvent(id){const message={type:"WEB3_REQUEST_CANCELED",id};this.publishEvent("Web3RequestCanceled",message,!1).then()}publishEvent(event,message,callWebhook){return this.connection.publishEvent(event,message,callWebhook)}handleWeb3ResponseMessage(id,response){if("requestEthereumAccounts"===response.method)return WalletLinkRelay.accountRequestCallbackIds.forEach(id=>this.invokeCallback(id,response)),void WalletLinkRelay.accountRequestCallbackIds.clear();this.invokeCallback(id,response)}handleErrorResponse(id,method,error){var _a;const errorMessage=null!==(_a=null==error?void 0:error.message)&&void 0!==_a?_a:"Unspecified error message.";this.handleWeb3ResponseMessage(id,{method,errorMessage})}invokeCallback(id,response){const callback=this.relayEventManager.callbacks.get(id);callback&&(callback(response),this.relayEventManager.callbacks.delete(id))}requestEthereumAccounts(){const{appName,appLogoUrl}=this.metadata,request={method:"requestEthereumAccounts",params:{appName,appLogoUrl}},id=randomBytesHex(8);return new Promise((resolve,reject)=>{this.relayEventManager.callbacks.set(id,response=>{if(isErrorResponse(response))return reject(new Error(response.errorMessage));resolve(response)}),WalletLinkRelay.accountRequestCallbackIds.add(id),this.publishWeb3RequestEvent(id,request)})}watchAsset(type,address,symbol,decimals,image,chainId){const request={method:"watchAsset",params:{type,options:{address,symbol,decimals,image},chainId}};let hideSnackbarItem=null;const id=randomBytesHex(8),cancel=error=>{this.publishWeb3RequestCanceledEvent(id),this.handleErrorResponse(id,request.method,error),null==hideSnackbarItem||hideSnackbarItem()};return hideSnackbarItem=this.ui.showConnecting({isUnlinkedErrorState:this.isUnlinkedErrorState,onCancel:cancel,onResetConnection:this.resetAndReload}),new Promise((resolve,reject)=>{this.relayEventManager.callbacks.set(id,response=>{if(null==hideSnackbarItem||hideSnackbarItem(),isErrorResponse(response))return reject(new Error(response.errorMessage));resolve(response)}),this.publishWeb3RequestEvent(id,request)})}addEthereumChain(chainId,rpcUrls,iconUrls,blockExplorerUrls,chainName,nativeCurrency){const request={method:"addEthereumChain",params:{chainId,rpcUrls,blockExplorerUrls,chainName,iconUrls,nativeCurrency}};let hideSnackbarItem=null;const id=randomBytesHex(8),cancel=error=>{this.publishWeb3RequestCanceledEvent(id),this.handleErrorResponse(id,request.method,error),null==hideSnackbarItem||hideSnackbarItem()};return hideSnackbarItem=this.ui.showConnecting({isUnlinkedErrorState:this.isUnlinkedErrorState,onCancel:cancel,onResetConnection:this.resetAndReload}),new Promise((resolve,reject)=>{this.relayEventManager.callbacks.set(id,response=>{if(null==hideSnackbarItem||hideSnackbarItem(),isErrorResponse(response))return reject(new Error(response.errorMessage));resolve(response)}),this.publishWeb3RequestEvent(id,request)})}switchEthereumChain(chainId,address){const request={method:"switchEthereumChain",params:Object.assign({chainId},{address})};let hideSnackbarItem=null;const id=randomBytesHex(8),cancel=error=>{this.publishWeb3RequestCanceledEvent(id),this.handleErrorResponse(id,request.method,error),null==hideSnackbarItem||hideSnackbarItem()};return hideSnackbarItem=this.ui.showConnecting({isUnlinkedErrorState:this.isUnlinkedErrorState,onCancel:cancel,onResetConnection:this.resetAndReload}),new Promise((resolve,reject)=>{this.relayEventManager.callbacks.set(id,response=>(null==hideSnackbarItem||hideSnackbarItem(),isErrorResponse(response)&&response.errorCode?reject(errors_standardErrors.provider.custom({code:response.errorCode,message:"Unrecognized chain ID. Try adding the chain using addEthereumChain first."})):isErrorResponse(response)?reject(new Error(response.errorMessage)):void resolve(response))),this.publishWeb3RequestEvent(id,request)})}}WalletLinkRelay.accountRequestCallbackIds=new Set;var WalletLinkSigner_Buffer=__webpack_require__("./node_modules/buffer/index.js").Buffer;class WalletLinkSigner{constructor(options){this._relay=null,this._addresses=[],this.metadata=options.metadata,this._storage=new ScopedLocalStorage("walletlink","https://www.walletlink.org"),this.callback=options.callback||null;const cachedAddresses=this._storage.getItem("Addresses");if(cachedAddresses){const addresses=cachedAddresses.split(" ");""!==addresses[0]&&(this._addresses=addresses.map(address=>ensureAddressString(address)))}this.initializeRelay()}getSession(){const relay=this.initializeRelay(),{id,secret}=relay.getWalletLinkSession();return{id,secret}}async handshake(args){const method="eth_requestAccounts",correlationId=correlationIds_get(args);(({method,correlationId})=>{logEvent("walletlink_signer.handshake.started",{action:ActionType.unknown,componentType:ComponentType.unknown,method,correlationId},AnalyticsEventImportance.high)})({method,correlationId});try{await this._eth_requestAccounts(),(({method,correlationId})=>{logEvent("walletlink_signer.handshake.completed",{action:ActionType.unknown,componentType:ComponentType.unknown,method,correlationId},AnalyticsEventImportance.high)})({method,correlationId})}catch(error){throw(({method,correlationId,errorMessage})=>{logEvent("walletlink_signer.handshake.error",{action:ActionType.error,componentType:ComponentType.unknown,method,correlationId,errorMessage},AnalyticsEventImportance.high)})({method,correlationId,errorMessage:parseErrorMessageFromAny(error)}),error}}get selectedAddress(){return this._addresses[0]||void 0}get jsonRpcUrl(){var _a;return null!==(_a=this._storage.getItem("DefaultJsonRpcUrl"))&&void 0!==_a?_a:void 0}set jsonRpcUrl(value){this._storage.setItem("DefaultJsonRpcUrl",value)}updateProviderInfo(jsonRpcUrl,chainId){var _a;this.jsonRpcUrl=jsonRpcUrl;const originalChainId=this.getChainId();this._storage.setItem("DefaultChainId",chainId.toString(10));ensureIntNumber(chainId)!==originalChainId&&(null===(_a=this.callback)||void 0===_a||_a.call(this,"chainChanged",hexStringFromNumber(chainId)))}async watchAsset(params){const request=Array.isArray(params)?params[0]:params;if(!request.type)throw errors_standardErrors.rpc.invalidParams("Type is required");if("ERC20"!==(null==request?void 0:request.type))throw errors_standardErrors.rpc.invalidParams(`Asset of type '${request.type}' is not supported`);if(!(null==request?void 0:request.options))throw errors_standardErrors.rpc.invalidParams("Options are required");if(!(null==request?void 0:request.options.address))throw errors_standardErrors.rpc.invalidParams("Address is required");const chainId=this.getChainId(),{address,symbol,image,decimals}=request.options,relay=this.initializeRelay(),result=await relay.watchAsset(request.type,address,symbol,decimals,image,null==chainId?void 0:chainId.toString());return!isErrorResponse(result)&&!!result.result}async addEthereumChain(params){var _a,_b;const request=params[0];if(0===(null===(_a=request.rpcUrls)||void 0===_a?void 0:_a.length))throw errors_standardErrors.rpc.invalidParams("please pass in at least 1 rpcUrl");if(!request.chainName||""===request.chainName.trim())throw errors_standardErrors.rpc.invalidParams("chainName is a required field");if(!request.nativeCurrency)throw errors_standardErrors.rpc.invalidParams("nativeCurrency is a required field");const chainIdNumber=Number.parseInt(request.chainId,16);if(chainIdNumber===this.getChainId())return!1;const relay=this.initializeRelay(),{rpcUrls=[],blockExplorerUrls=[],chainName,iconUrls=[],nativeCurrency}=request,res=await relay.addEthereumChain(chainIdNumber.toString(),rpcUrls,iconUrls,blockExplorerUrls,chainName,nativeCurrency);if(isErrorResponse(res))return!1;if(!0===(null===(_b=res.result)||void 0===_b?void 0:_b.isApproved))return this.updateProviderInfo(rpcUrls[0],chainIdNumber),null;throw errors_standardErrors.rpc.internal("unable to add ethereum chain")}async switchEthereumChain(params){const request=params[0],chainId=Number.parseInt(request.chainId,16),relay=this.initializeRelay(),res=await relay.switchEthereumChain(chainId.toString(10),this.selectedAddress||void 0);if(isErrorResponse(res))throw res;const switchResponse=res.result;return switchResponse.isApproved&&switchResponse.rpcUrl.length>0&&this.updateProviderInfo(switchResponse.rpcUrl,chainId),null}async cleanup(){this.callback=null,this._relay&&this._relay.resetAndReload(),this._storage.clear()}_setAddresses(addresses,_){var _a;if(!Array.isArray(addresses))throw new Error("addresses is not an array");const newAddresses=addresses.map(address=>ensureAddressString(address));JSON.stringify(newAddresses)!==JSON.stringify(this._addresses)&&(this._addresses=newAddresses,null===(_a=this.callback)||void 0===_a||_a.call(this,"accountsChanged",newAddresses),this._storage.setItem("Addresses",newAddresses.join(" ")))}async request(request){const correlationId=correlationIds_get(request);(({method,correlationId})=>{logEvent("walletlink_signer.request.started",{action:ActionType.unknown,componentType:ComponentType.unknown,method,correlationId},AnalyticsEventImportance.high)})({method:request.method,correlationId});try{const result=await this._request(request);return(({method,correlationId})=>{logEvent("walletlink_signer.request.completed",{action:ActionType.unknown,componentType:ComponentType.unknown,method,correlationId},AnalyticsEventImportance.high)})({method:request.method,correlationId}),result}catch(error){throw(({method,correlationId,errorMessage})=>{logEvent("walletlink_signer.request.error",{action:ActionType.error,componentType:ComponentType.unknown,method,correlationId,errorMessage},AnalyticsEventImportance.high)})({method:request.method,correlationId,errorMessage:parseErrorMessageFromAny(error)}),error}}async _request(request){const params=request.params||[];switch(request.method){case"eth_accounts":return[...this._addresses];case"eth_coinbase":return this.selectedAddress||null;case"net_version":return this.getChainId().toString(10);case"eth_chainId":return hexStringFromNumber(this.getChainId());case"eth_requestAccounts":return this._eth_requestAccounts();case"eth_ecRecover":case"personal_ecRecover":return this.ecRecover(request);case"personal_sign":return this.personalSign(request);case"eth_signTransaction":return this._eth_signTransaction(params);case"eth_sendRawTransaction":return this._eth_sendRawTransaction(params);case"eth_sendTransaction":return this._eth_sendTransaction(params);case"eth_signTypedData_v1":case"eth_signTypedData_v3":case"eth_signTypedData_v4":case"eth_signTypedData":return this.signTypedData(request);case"wallet_addEthereumChain":return this.addEthereumChain(params);case"wallet_switchEthereumChain":return this.switchEthereumChain(params);case"wallet_watchAsset":return this.watchAsset(params);default:if(!this.jsonRpcUrl)throw errors_standardErrors.rpc.internal("No RPC URL set for chain");return fetchRPCRequest(request,this.jsonRpcUrl)}}_ensureKnownAddress(addressString){const addressStr=ensureAddressString(addressString);if(!this._addresses.map(address=>ensureAddressString(address)).includes(addressStr))throw new Error("Unknown Ethereum address")}_prepareTransactionParams(tx){const fromAddress=tx.from?ensureAddressString(tx.from):this.selectedAddress;if(!fromAddress)throw new Error("Ethereum address is unavailable");this._ensureKnownAddress(fromAddress);return{fromAddress,toAddress:tx.to?ensureAddressString(tx.to):null,weiValue:null!=tx.value?ensureBigInt(tx.value):BigInt(0),data:tx.data?ensureBuffer(tx.data):WalletLinkSigner_Buffer.alloc(0),nonce:null!=tx.nonce?ensureIntNumber(tx.nonce):null,gasPriceInWei:null!=tx.gasPrice?ensureBigInt(tx.gasPrice):null,maxFeePerGas:null!=tx.maxFeePerGas?ensureBigInt(tx.maxFeePerGas):null,maxPriorityFeePerGas:null!=tx.maxPriorityFeePerGas?ensureBigInt(tx.maxPriorityFeePerGas):null,gasLimit:null!=tx.gas?ensureBigInt(tx.gas):null,chainId:tx.chainId?ensureIntNumber(tx.chainId):this.getChainId()}}async ecRecover(request){const{method,params}=request;if(!Array.isArray(params))throw errors_standardErrors.rpc.invalidParams();const relay=this.initializeRelay(),res=await relay.sendRequest({method:"ethereumAddressFromSignedMessage",params:{message:encodeToHexString(params[0]),signature:encodeToHexString(params[1]),addPrefix:"personal_ecRecover"===method}});if(isErrorResponse(res))throw res;return res.result}getChainId(){var _a;return Number.parseInt(null!==(_a=this._storage.getItem("DefaultChainId"))&&void 0!==_a?_a:"1",10)}async _eth_requestAccounts(){var _a,_b;if(this._addresses.length>0)return null===(_a=this.callback)||void 0===_a||_a.call(this,"connect",{chainId:hexStringFromNumber(this.getChainId())}),this._addresses;const relay=this.initializeRelay(),res=await relay.requestEthereumAccounts();if(isErrorResponse(res))throw res;if(!res.result)throw new Error("accounts received is empty");return this._setAddresses(res.result),null===(_b=this.callback)||void 0===_b||_b.call(this,"connect",{chainId:hexStringFromNumber(this.getChainId())}),this._addresses}async personalSign({params}){if(!Array.isArray(params))throw errors_standardErrors.rpc.invalidParams();const address=params[1],rawData=params[0];this._ensureKnownAddress(address);const relay=this.initializeRelay(),res=await relay.sendRequest({method:"signEthereumMessage",params:{address:ensureAddressString(address),message:encodeToHexString(rawData),addPrefix:!0,typedDataJson:null}});if(isErrorResponse(res))throw res;return res.result}async _eth_signTransaction(params){const tx=this._prepareTransactionParams(params[0]||{}),relay=this.initializeRelay(),res=await relay.signEthereumTransaction(tx);if(isErrorResponse(res))throw res;return res.result}async _eth_sendRawTransaction(params){const signedTransaction=ensureBuffer(params[0]),relay=this.initializeRelay(),res=await relay.submitEthereumTransaction(signedTransaction,this.getChainId());if(isErrorResponse(res))throw res;return res.result}async _eth_sendTransaction(params){const tx=this._prepareTransactionParams(params[0]||{}),relay=this.initializeRelay(),res=await relay.signAndSubmitEthereumTransaction(tx);if(isErrorResponse(res))throw res;return res.result}async signTypedData(request){const{method,params}=request;if(!Array.isArray(params))throw errors_standardErrors.rpc.invalidParams();const address=params["eth_signTypedData_v1"===method?1:0],rawData=params["eth_signTypedData_v1"===method?0:1];this._ensureKnownAddress(address);const relay=this.initializeRelay(),res=await relay.sendRequest({method:"signEthereumMessage",params:{address:ensureAddressString(address),message:(input=rawData,hexStringFromBuffer({eth_signTypedData_v1:eth_eip712_util_default().hashForSignTypedDataLegacy,eth_signTypedData_v3:eth_eip712_util_default().hashForSignTypedData_v3,eth_signTypedData_v4:eth_eip712_util_default().hashForSignTypedData_v4,eth_signTypedData:eth_eip712_util_default().hashForSignTypedData_v4}[method]({data:ensureParsedJSONObject(input)}),!0)),typedDataJson:JSON.stringify(rawData,null,2),addPrefix:!1}});var input;if(isErrorResponse(res))throw res;return res.result}initializeRelay(){return this._relay||(this._relay=new WalletLinkRelay({linkAPIUrl:"https://www.walletlink.org",storage:this._storage,metadata:this.metadata,accountsCallback:this._setAddresses.bind(this),chainCallback:this.updateProviderInfo.bind(this)})),this._relay}}const util_storage=new ScopedLocalStorage("CBWSDK","SignerConfigurator");function signerToSignerType(signer){if(signer)return signer instanceof SCWSigner?"scw":"walletlink"}async function fetchSignerType(params){const{communicator,metadata,handshakeRequest,callback}=params;(async function listenForWalletLinkSessionRequest(communicator,metadata,callback,handshakeRequest){await communicator.onMessage(({event})=>"WalletLinkSessionRequest"===event);const walletlink=new WalletLinkSigner({metadata,callback});communicator.postMessage({event:"WalletLinkUpdate",data:{session:walletlink.getSession()}}),await walletlink.handshake(handshakeRequest),communicator.postMessage({event:"WalletLinkUpdate",data:{connected:!0}})})(communicator,metadata,callback,handshakeRequest).catch(()=>{});const request={id:crypto.randomUUID(),event:"selectSignerType",data:Object.assign(Object.assign({},params.preference),{handshakeRequest})},{data}=await communicator.postRequestAndWaitForResponse(request);return data}var CoinbaseWalletProvider_console=__webpack_require__("./node_modules/console-browserify/index.js"),CoinbaseWalletProvider_rest=function(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(p=Object.getOwnPropertySymbols(s);i<p.length;i++)e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(t[p[i]]=s[p[i]])}return t};class CoinbaseWalletProvider extends ProviderEventEmitter{constructor(_a){var{metadata}=_a,_b=_a.preference,{keysUrl}=_b,preference=CoinbaseWalletProvider_rest(_b,["keysUrl"]);super(),this.signer=null,this.isCoinbaseWallet=!0,this.metadata=metadata,this.preference=preference,this.communicator=new Communicator({url:keysUrl,metadata,preference});const signerType=function loadSignerType(){return util_storage.getItem("SignerType")}();signerType&&(this.signer=this.initSigner(signerType),(({signerType})=>{logEvent("provider.signer.loaded_from_storage",{action:ActionType.measurement,componentType:ComponentType.unknown,signerType},AnalyticsEventImportance.low)})({signerType}))}async request(args){const correlationId=crypto.randomUUID();correlationIds_set(args,correlationId),(({method,correlationId})=>{logEvent("provider.request.started",{action:ActionType.unknown,componentType:ComponentType.unknown,method,correlationId},AnalyticsEventImportance.high)})({method:args.method,correlationId});try{const result=await this._request(args);return(({method,signerType,correlationId})=>{logEvent("provider.request.responded",{action:ActionType.unknown,componentType:ComponentType.unknown,method,signerType,correlationId},AnalyticsEventImportance.high)})({method:args.method,signerType:signerToSignerType(this.signer),correlationId}),result}catch(error){throw(({method,correlationId,signerType,errorMessage})=>{logEvent("provider.request.error",{action:ActionType.error,componentType:ComponentType.unknown,method,signerType,correlationId,errorMessage},AnalyticsEventImportance.high)})({method:args.method,correlationId,signerType:signerToSignerType(this.signer),errorMessage:error instanceof Error?error.message:""}),error}finally{correlationIds_delete(args)}}async _request(args){try{if(function checkErrorForInvalidRequestArgs(args){if(!args||"object"!=typeof args||Array.isArray(args))throw errors_standardErrors.rpc.invalidParams({message:"Expected a single, non-array, object argument.",data:args});const{method,params}=args;if("string"!=typeof method||0===method.length)throw errors_standardErrors.rpc.invalidParams({message:"'args.method' must be a non-empty string.",data:args});if(void 0!==params&&!Array.isArray(params)&&("object"!=typeof params||null===params))throw errors_standardErrors.rpc.invalidParams({message:"'args.params' must be an object or array if provided.",data:args});switch(method){case"eth_sign":case"eth_signTypedData_v2":case"eth_subscribe":case"eth_unsubscribe":throw errors_standardErrors.provider.unsupportedMethod()}}(args),!this.signer)switch(args.method){case"eth_requestAccounts":{let signerType;const subAccountsConfig=store.subAccountsConfig.get();signerType=(null==subAccountsConfig?void 0:subAccountsConfig.enableAutoSubAccounts)?"scw":await this.requestSignerSelection(args);const signer=this.initSigner(signerType);"scw"===signerType&&(null==subAccountsConfig?void 0:subAccountsConfig.enableAutoSubAccounts)?(await signer.handshake({method:"handshake"}),await signer.request(args)):await signer.handshake(args),this.signer=signer,function storeSignerType(signerType){util_storage.setItem("SignerType",signerType)}(signerType);break}case"wallet_connect":{const signer=this.initSigner("scw");await signer.handshake({method:"handshake"});const result=await signer.request(args);return this.signer=signer,result}case"wallet_sendCalls":case"wallet_sign":{const ephemeralSigner=this.initSigner("scw");await ephemeralSigner.handshake({method:"handshake"});const result=await ephemeralSigner.request(args);return await ephemeralSigner.cleanup(),result}case"wallet_getCallsStatus":return await fetchRPCRequest(args,"https://rpc.wallet.coinbase.com");case"net_version":return 1;case"eth_chainId":return hexStringFromNumber(1);default:throw errors_standardErrors.provider.unauthorized("Must call 'eth_requestAccounts' before other methods")}return await this.signer.request(args)}catch(error){const{code}=error;return code===standardErrorCodes_provider.unauthorized&&this.disconnect(),Promise.reject(serializeError(error))}}async enable(){return CoinbaseWalletProvider_console.warn('.enable() has been deprecated. Please use .request({ method: "eth_requestAccounts" }) instead.'),logEvent("provider.enable_function.called",{action:ActionType.measurement,componentType:ComponentType.unknown},AnalyticsEventImportance.high),await this.request({method:"eth_requestAccounts"})}async disconnect(){var _a;await(null===(_a=this.signer)||void 0===_a?void 0:_a.cleanup()),this.signer=null,ScopedLocalStorage.clearAll(),correlationIds_clear(),this.emit("disconnect",errors_standardErrors.provider.disconnected("User initiated disconnection"))}async requestSignerSelection(handshakeRequest){logEvent("signer.selection.requested",{action:ActionType.unknown,componentType:ComponentType.unknown},AnalyticsEventImportance.high);const signerType=await fetchSignerType({communicator:this.communicator,preference:this.preference,metadata:this.metadata,handshakeRequest,callback:this.emit.bind(this)});return(signerType=>{logEvent("signer.selection.responded",{action:ActionType.unknown,componentType:ComponentType.unknown,signerType},AnalyticsEventImportance.high)})(signerType),signerType}initSigner(signerType){return function createSigner(params){const{signerType,metadata,communicator,callback}=params;switch(signerType){case"scw":return new SCWSigner({metadata,callback,communicator});case"walletlink":return new WalletLinkSigner({metadata,callback})}}({signerType,metadata:this.metadata,communicator:this.communicator,callback:this.emit.bind(this)})}}const DEFAULT_PREFERENCE={options:"all"};function createCoinbaseWalletSDK(params){var _a,_b,_c,_d;const options={metadata:{appName:params.appName||"Dapp",appLogoUrl:params.appLogoUrl||"",appChainIds:params.appChainIds||[]},preference:Object.assign(DEFAULT_PREFERENCE,null!==(_a=params.preference)&&void 0!==_a?_a:{}),paymasterUrls:params.paymasterUrls};(null===(_b=params.subAccounts)||void 0===_b?void 0:_b.toOwnerAccount)&&validateSubAccount(params.subAccounts.toOwnerAccount),store.subAccountsConfig.set({toOwnerAccount:null===(_c=params.subAccounts)||void 0===_c?void 0:_c.toOwnerAccount,enableAutoSubAccounts:null===(_d=params.subAccounts)||void 0===_d?void 0:_d.enableAutoSubAccounts}),store.config.set(options),store.persist.rehydrate(),checkCrossOriginOpenerPolicy(),!1!==options.preference.telemetry&&loadTelemetryScript(),function validatePreferences(preference){if(preference){if(!["all","smartWalletOnly","eoaOnly"].includes(preference.options))throw new Error(`Invalid options: ${preference.options}`);if(preference.attribution&&void 0!==preference.attribution.auto&&void 0!==preference.attribution.dataSuffix)throw new Error("Attribution cannot contain both auto and dataSuffix properties");if(preference.telemetry&&"boolean"!=typeof preference.telemetry)throw new Error("Telemetry must be a boolean")}}(options.preference);let provider=null;const sdk={getProvider:()=>(provider||(provider=function createCoinbaseWalletProvider(options){var _a;const params={metadata:options.metadata,preference:options.preference};return null!==(_a=getCoinbaseInjectedProvider(params))&&void 0!==_a?_a:new CoinbaseWalletProvider(params)}(options)),provider.sdk=sdk,provider),subAccount:{async create(account){var _a,_b;return assertPresence(null===(_a=store.getState().subAccount)||void 0===_a?void 0:_a.address,new Error("subaccount already exists")),await(null===(_b=sdk.getProvider())||void 0===_b?void 0:_b.request({method:"wallet_addSubAccount",params:[{version:"1",account}]}))},async get(){var _a,_b;const subAccount=store.subAccounts.get();if(null==subAccount?void 0:subAccount.address)return subAccount;const subAccounts=null===(_b=(await(null===(_a=sdk.getProvider())||void 0===_a?void 0:_a.request({method:"wallet_connect",params:[{version:"1",capabilities:{}}]}))).accounts[0].capabilities)||void 0===_b?void 0:_b.subAccounts;return Array.isArray(subAccounts)?subAccounts[0]:null},async addOwner({address,publicKey,chainId}){var _a,_b;const subAccount=store.subAccounts.get(),account=store.account.get();assertPresence(account,new Error("account does not exist")),assertPresence(null==subAccount?void 0:subAccount.address,new Error("subaccount does not exist"));const calls=[];if(publicKey){const[x,y]=(0,decodeAbiParameters.n)([{type:"bytes32"},{type:"bytes32"}],publicKey);calls.push({to:subAccount.address,data:(0,encodeFunctionData.p)({abi,functionName:"addOwnerPublicKey",args:[x,y]}),value:(0,toHex.nj)(0)})}return address&&calls.push({to:subAccount.address,data:(0,encodeFunctionData.p)({abi,functionName:"addOwnerAddress",args:[address]}),value:(0,toHex.nj)(0)}),await(null===(_a=sdk.getProvider())||void 0===_a?void 0:_a.request({method:"wallet_sendCalls",params:[{calls,chainId:(0,toHex.nj)(chainId),from:null===(_b=account.accounts)||void 0===_b?void 0:_b[0],version:"1"}]}))},setToOwnerAccount(toSubAccountOwner){validateSubAccount(toSubAccountOwner),store.subAccountsConfig.set({toOwnerAccount:toSubAccountOwner})}}};return sdk}},"./node_modules/@coinbase/wallet-sdk/dist/vendor-js/eth-eip712-util/abi.cjs":(module,__unused_webpack_exports,__webpack_require__)=>{var Buffer=__webpack_require__("./node_modules/buffer/index.js").Buffer;const util=__webpack_require__("./node_modules/@coinbase/wallet-sdk/dist/vendor-js/eth-eip712-util/util.cjs");function elementaryName(name){return name.startsWith("int[")?"int256"+name.slice(3):"int"===name?"int256":name.startsWith("uint[")?"uint256"+name.slice(4):"uint"===name?"uint256":name.startsWith("fixed[")?"fixed128x128"+name.slice(5):"fixed"===name?"fixed128x128":name.startsWith("ufixed[")?"ufixed128x128"+name.slice(6):"ufixed"===name?"ufixed128x128":name}function parseTypeN(type){return Number.parseInt(/^\D+(\d+)$/.exec(type)[1],10)}function parseTypeNxM(type){var tmp=/^\D+(\d+)x(\d+)$/.exec(type);return[Number.parseInt(tmp[1],10),Number.parseInt(tmp[2],10)]}function parseTypeArray(type){var tmp=type.match(/(.*)\[(.*?)\]$/);return tmp?""===tmp[2]?"dynamic":Number.parseInt(tmp[2],10):null}function parseNumber(arg){var type=typeof arg;if("string"===type||"number"===type)return BigInt(arg);if("bigint"===type)return arg;throw new Error("Argument is not a number")}function encodeSingle(type,arg){var size,num,ret,i;if("address"===type)return encodeSingle("uint160",parseNumber(arg));if("bool"===type)return encodeSingle("uint8",arg?1:0);if("string"===type)return encodeSingle("bytes",new Buffer(arg,"utf8"));if(function isArray(type){return type.lastIndexOf("]")===type.length-1}(type)){if(void 0===arg.length)throw new Error("Not an array?");if("dynamic"!==(size=parseTypeArray(type))&&0!==size&&arg.length>size)throw new Error("Elements exceed array size: "+size);for(i in ret=[],type=type.slice(0,type.lastIndexOf("[")),"string"==typeof arg&&(arg=JSON.parse(arg)),arg)ret.push(encodeSingle(type,arg[i]));if("dynamic"===size){var length=encodeSingle("uint256",arg.length);ret.unshift(length)}return Buffer.concat(ret)}if("bytes"===type)return arg=new Buffer(arg),ret=Buffer.concat([encodeSingle("uint256",arg.length),arg]),arg.length%32!=0&&(ret=Buffer.concat([ret,util.zeros(32-arg.length%32)])),ret;if(type.startsWith("bytes")){if((size=parseTypeN(type))<1||size>32)throw new Error("Invalid bytes<N> width: "+size);return util.setLengthRight(arg,32)}if(type.startsWith("uint")){if((size=parseTypeN(type))%8||size<8||size>256)throw new Error("Invalid uint<N> width: "+size);num=parseNumber(arg);const bitLength=util.bitLengthFromBigInt(num);if(bitLength>size)throw new Error("Supplied uint exceeds width: "+size+" vs "+bitLength);if(num<0)throw new Error("Supplied uint is negative");return util.bufferBEFromBigInt(num,32)}if(type.startsWith("int")){if((size=parseTypeN(type))%8||size<8||size>256)throw new Error("Invalid int<N> width: "+size);num=parseNumber(arg);const bitLength=util.bitLengthFromBigInt(num);if(bitLength>size)throw new Error("Supplied int exceeds width: "+size+" vs "+bitLength);const twos=util.twosFromBigInt(num,256);return util.bufferBEFromBigInt(twos,32)}if(type.startsWith("ufixed")){if(size=parseTypeNxM(type),(num=parseNumber(arg))<0)throw new Error("Supplied ufixed is negative");return encodeSingle("uint256",num*BigInt(2)**BigInt(size[1]))}if(type.startsWith("fixed"))return size=parseTypeNxM(type),encodeSingle("int256",parseNumber(arg)*BigInt(2)**BigInt(size[1]));throw new Error("Unsupported or invalid type: "+type)}function isDynamic(type){return"string"===type||"bytes"===type||"dynamic"===parseTypeArray(type)}function solidityPack(types,values){if(types.length!==values.length)throw new Error("Number of types are not matching the values");for(var size,num,ret=[],i=0;i<types.length;i++){var type=elementaryName(types[i]),value=values[i];if("bytes"===type)ret.push(value);else if("string"===type)ret.push(new Buffer(value,"utf8"));else if("bool"===type)ret.push(new Buffer(value?"01":"00","hex"));else if("address"===type)ret.push(util.setLength(value,20));else if(type.startsWith("bytes")){if((size=parseTypeN(type))<1||size>32)throw new Error("Invalid bytes<N> width: "+size);ret.push(util.setLengthRight(value,size))}else if(type.startsWith("uint")){if((size=parseTypeN(type))%8||size<8||size>256)throw new Error("Invalid uint<N> width: "+size);num=parseNumber(value);const bitLength=util.bitLengthFromBigInt(num);if(bitLength>size)throw new Error("Supplied uint exceeds width: "+size+" vs "+bitLength);ret.push(util.bufferBEFromBigInt(num,size/8))}else{if(!type.startsWith("int"))throw new Error("Unsupported or invalid type: "+type);{if((size=parseTypeN(type))%8||size<8||size>256)throw new Error("Invalid int<N> width: "+size);num=parseNumber(value);const bitLength=util.bitLengthFromBigInt(num);if(bitLength>size)throw new Error("Supplied int exceeds width: "+size+" vs "+bitLength);const twos=util.twosFromBigInt(num,size);ret.push(util.bufferBEFromBigInt(twos,size/8))}}}return Buffer.concat(ret)}module.exports={rawEncode:function rawEncode(types,values){var output=[],data=[],headLength=32*types.length;for(var i in types){var type=elementaryName(types[i]),cur=encodeSingle(type,values[i]);isDynamic(type)?(output.push(encodeSingle("uint256",headLength)),data.push(cur),headLength+=cur.length):output.push(cur)}return Buffer.concat(output.concat(data))},solidityPack,soliditySHA3:function soliditySHA3(types,values){return util.keccak(solidityPack(types,values))}}},"./node_modules/@coinbase/wallet-sdk/dist/vendor-js/eth-eip712-util/index.cjs":(module,__unused_webpack_exports,__webpack_require__)=>{var Buffer=__webpack_require__("./node_modules/buffer/index.js").Buffer;const util=__webpack_require__("./node_modules/@coinbase/wallet-sdk/dist/vendor-js/eth-eip712-util/util.cjs"),abi=__webpack_require__("./node_modules/@coinbase/wallet-sdk/dist/vendor-js/eth-eip712-util/abi.cjs"),TYPED_MESSAGE_SCHEMA={type:"object",properties:{types:{type:"object",additionalProperties:{type:"array",items:{type:"object",properties:{name:{type:"string"},type:{type:"string"}},required:["name","type"]}}},primaryType:{type:"string"},domain:{type:"object"},message:{type:"object"}},required:["types","primaryType","domain","message"]},TypedDataUtils={encodeData(primaryType,data,types,useV4=!0){const encodedTypes=["bytes32"],encodedValues=[this.hashType(primaryType,types)];if(useV4){const encodeField=(name,type,value)=>{if(void 0!==types[type])return["bytes32",null==value?"0x0000000000000000000000000000000000000000000000000000000000000000":util.keccak(this.encodeData(type,value,types,useV4))];if(void 0===value)throw new Error(`missing value for field ${name} of type ${type}`);if("bytes"===type)return["bytes32",util.keccak(value)];if("string"===type)return"string"==typeof value&&(value=Buffer.from(value,"utf8")),["bytes32",util.keccak(value)];if(type.lastIndexOf("]")===type.length-1){const parsedType=type.slice(0,type.lastIndexOf("[")),typeValuePairs=value.map(item=>encodeField(name,parsedType,item));return["bytes32",util.keccak(abi.rawEncode(typeValuePairs.map(([type])=>type),typeValuePairs.map(([,value])=>value)))]}return[type,value]};for(const field of types[primaryType]){const[type,value]=encodeField(field.name,field.type,data[field.name]);encodedTypes.push(type),encodedValues.push(value)}}else for(const field of types[primaryType]){let value=data[field.name];if(void 0!==value)if("bytes"===field.type)encodedTypes.push("bytes32"),value=util.keccak(value),encodedValues.push(value);else if("string"===field.type)encodedTypes.push("bytes32"),"string"==typeof value&&(value=Buffer.from(value,"utf8")),value=util.keccak(value),encodedValues.push(value);else if(void 0!==types[field.type])encodedTypes.push("bytes32"),value=util.keccak(this.encodeData(field.type,value,types,useV4)),encodedValues.push(value);else{if(field.type.lastIndexOf("]")===field.type.length-1)throw new Error("Arrays currently unimplemented in encodeData");encodedTypes.push(field.type),encodedValues.push(value)}}return abi.rawEncode(encodedTypes,encodedValues)},encodeType(primaryType,types){let result="",deps=this.findTypeDependencies(primaryType,types).filter(dep=>dep!==primaryType);deps=[primaryType].concat(deps.sort());for(const type of deps){if(!types[type])throw new Error("No type definition specified: "+type);result+=type+"("+types[type].map(({name,type})=>type+" "+name).join(",")+")"}return result},findTypeDependencies(primaryType,types,results=[]){if(primaryType=primaryType.match(/^\w*/)[0],results.includes(primaryType)||void 0===types[primaryType])return results;results.push(primaryType);for(const field of types[primaryType])for(const dep of this.findTypeDependencies(field.type,types,results))!results.includes(dep)&&results.push(dep);return results},hashStruct(primaryType,data,types,useV4=!0){return util.keccak(this.encodeData(primaryType,data,types,useV4))},hashType(primaryType,types){return util.keccak(this.encodeType(primaryType,types))},sanitizeData(data){const sanitizedData={};for(const key in TYPED_MESSAGE_SCHEMA.properties)data[key]&&(sanitizedData[key]=data[key]);return sanitizedData.types&&(sanitizedData.types=Object.assign({EIP712Domain:[]},sanitizedData.types)),sanitizedData},hash(typedData,useV4=!0){const sanitizedData=this.sanitizeData(typedData),parts=[Buffer.from("1901","hex")];return parts.push(this.hashStruct("EIP712Domain",sanitizedData.domain,sanitizedData.types,useV4)),"EIP712Domain"!==sanitizedData.primaryType&&parts.push(this.hashStruct(sanitizedData.primaryType,sanitizedData.message,sanitizedData.types,useV4)),util.keccak(Buffer.concat(parts))}};module.exports={TYPED_MESSAGE_SCHEMA,TypedDataUtils,hashForSignTypedDataLegacy:function(msgParams){return function typedSignatureHashLegacy(typedData){const error=new Error("Expect argument to be non-empty array");if("object"!=typeof typedData||!typedData.length)throw error;const data=typedData.map(function(e){return"bytes"===e.type?util.toBuffer(e.value):e.value}),types=typedData.map(function(e){return e.type}),schema=typedData.map(function(e){if(!e.name)throw error;return e.type+" "+e.name});return abi.soliditySHA3(["bytes32","bytes32"],[abi.soliditySHA3(new Array(typedData.length).fill("string"),schema),abi.soliditySHA3(types,data)])}(msgParams.data)},hashForSignTypedData_v3:function(msgParams){return TypedDataUtils.hash(msgParams.data,!1)},hashForSignTypedData_v4:function(msgParams){return TypedDataUtils.hash(msgParams.data)}}},"./node_modules/@coinbase/wallet-sdk/dist/vendor-js/eth-eip712-util/util.cjs":(module,__unused_webpack_exports,__webpack_require__)=>{var Buffer=__webpack_require__("./node_modules/buffer/index.js").Buffer;const{keccak_256}=__webpack_require__("./node_modules/@coinbase/wallet-sdk/node_modules/@noble/hashes/sha3.js");function zeros(bytes){return Buffer.allocUnsafe(bytes).fill(0)}function bufferBEFromBigInt(num,length){let hex=num.toString(16);hex.length%2!=0&&(hex="0"+hex);const byteArray=hex.match(/.{1,2}/g).map(byte=>parseInt(byte,16));for(;byteArray.length<length;)byteArray.unshift(0);return Buffer.from(byteArray)}function setLength(msg,length,right){const buf=zeros(length);return msg=toBuffer(msg),right?msg.length<length?(msg.copy(buf),buf):msg.slice(0,length):msg.length<length?(msg.copy(buf,length-msg.length),buf):msg.slice(-length)}function toBuffer(v){if(!Buffer.isBuffer(v))if(Array.isArray(v))v=Buffer.from(v);else if("string"==typeof v)v=isHexString(v)?Buffer.from(padToEven(stripHexPrefix(v)),"hex"):Buffer.from(v);else if("number"==typeof v)v=function intToBuffer(i){const hex=function intToHex(i){return`0x${i.toString(16)}`}(i);return new Buffer(padToEven(hex.slice(2)),"hex")}(v);else if(null==v)v=Buffer.allocUnsafe(0);else if("bigint"==typeof v)v=bufferBEFromBigInt(v);else{if(!v.toArray)throw new Error("invalid type");v=Buffer.from(v.toArray())}return v}function padToEven(str){return str.length%2?"0"+str:str}function isHexString(str){return"string"==typeof str&&str.match(/^0x[0-9A-Fa-f]*$/)}function stripHexPrefix(str){return"string"==typeof str&&str.startsWith("0x")?str.slice(2):str}module.exports={zeros,setLength,setLengthRight:function setLengthRight(msg,length){return setLength(msg,length,!0)},isHexString,stripHexPrefix,toBuffer,bufferToHex:function bufferToHex(buf){return"0x"+(buf=toBuffer(buf)).toString("hex")},keccak:function keccak(a,bits){if(a=toBuffer(a),bits||(bits=256),256!==bits)throw new Error("unsupported");return Buffer.from(keccak_256(new Uint8Array(a)))},bitLengthFromBigInt:function bitLengthFromBigInt(num){return num.toString(2).length},bufferBEFromBigInt,twosFromBigInt:function twosFromBigInt(value,width){let result;if(value<0n){result=1n+(~value&(1n<<BigInt(width))-1n)}else result=value;return result&=(1n<<BigInt(width))-1n,result}}},"./node_modules/@coinbase/wallet-sdk/node_modules/@noble/hashes/_assert.js":(__unused_webpack_module,exports)=>{"use strict";function number(n){if(!Number.isSafeInteger(n)||n<0)throw new Error(`positive integer expected, not ${n}`)}function bool(b){if("boolean"!=typeof b)throw new Error(`boolean expected, not ${b}`)}function isBytes(a){return a instanceof Uint8Array||null!=a&&"object"==typeof a&&"Uint8Array"===a.constructor.name}function bytes(b,...lengths){if(!isBytes(b))throw new Error("Uint8Array expected");if(lengths.length>0&&!lengths.includes(b.length))throw new Error(`Uint8Array expected of length ${lengths}, not of length=${b.length}`)}function hash(h){if("function"!=typeof h||"function"!=typeof h.create)throw new Error("Hash should be wrapped by utils.wrapConstructor");number(h.outputLen),number(h.blockLen)}function exists(instance,checkFinished=!0){if(instance.destroyed)throw new Error("Hash instance has been destroyed");if(checkFinished&&instance.finished)throw new Error("Hash#digest() has already been called")}function output(out,instance){bytes(out);const min=instance.outputLen;if(out.length<min)throw new Error(`digestInto() expects output buffer of length at least ${min}`)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.output=exports.exists=exports.hash=exports.bytes=exports.bool=exports.number=exports.isBytes=void 0,exports.number=number,exports.bool=bool,exports.isBytes=isBytes,exports.bytes=bytes,exports.hash=hash,exports.exists=exists,exports.output=output;const assert={number,bool,bytes,hash,exists,output};exports.default=assert},"./node_modules/@coinbase/wallet-sdk/node_modules/@noble/hashes/_u64.js":(__unused_webpack_module,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.add5L=exports.add5H=exports.add4H=exports.add4L=exports.add3H=exports.add3L=exports.add=exports.rotlBL=exports.rotlBH=exports.rotlSL=exports.rotlSH=exports.rotr32L=exports.rotr32H=exports.rotrBL=exports.rotrBH=exports.rotrSL=exports.rotrSH=exports.shrSL=exports.shrSH=exports.toBig=exports.split=exports.fromBig=void 0;const U32_MASK64=BigInt(2**32-1),_32n=BigInt(32);function fromBig(n,le=!1){return le?{h:Number(n&U32_MASK64),l:Number(n>>_32n&U32_MASK64)}:{h:0|Number(n>>_32n&U32_MASK64),l:0|Number(n&U32_MASK64)}}function split(lst,le=!1){let Ah=new Uint32Array(lst.length),Al=new Uint32Array(lst.length);for(let i=0;i<lst.length;i++){const{h,l}=fromBig(lst[i],le);[Ah[i],Al[i]]=[h,l]}return[Ah,Al]}exports.fromBig=fromBig,exports.split=split;const toBig=(h,l)=>BigInt(h>>>0)<<_32n|BigInt(l>>>0);exports.toBig=toBig;const shrSH=(h,_l,s)=>h>>>s;exports.shrSH=shrSH;const shrSL=(h,l,s)=>h<<32-s|l>>>s;exports.shrSL=shrSL;const rotrSH=(h,l,s)=>h>>>s|l<<32-s;exports.rotrSH=rotrSH;const rotrSL=(h,l,s)=>h<<32-s|l>>>s;exports.rotrSL=rotrSL;const rotrBH=(h,l,s)=>h<<64-s|l>>>s-32;exports.rotrBH=rotrBH;const rotrBL=(h,l,s)=>h>>>s-32|l<<64-s;exports.rotrBL=rotrBL;const rotr32H=(_h,l)=>l;exports.rotr32H=rotr32H;const rotr32L=(h,_l)=>h;exports.rotr32L=rotr32L;const rotlSH=(h,l,s)=>h<<s|l>>>32-s;exports.rotlSH=rotlSH;const rotlSL=(h,l,s)=>l<<s|h>>>32-s;exports.rotlSL=rotlSL;const rotlBH=(h,l,s)=>l<<s-32|h>>>64-s;exports.rotlBH=rotlBH;const rotlBL=(h,l,s)=>h<<s-32|l>>>64-s;function add(Ah,Al,Bh,Bl){const l=(Al>>>0)+(Bl>>>0);return{h:Ah+Bh+(l/2**32|0)|0,l:0|l}}exports.rotlBL=rotlBL,exports.add=add;const add3L=(Al,Bl,Cl)=>(Al>>>0)+(Bl>>>0)+(Cl>>>0);exports.add3L=add3L;const add3H=(low,Ah,Bh,Ch)=>Ah+Bh+Ch+(low/2**32|0)|0;exports.add3H=add3H;const add4L=(Al,Bl,Cl,Dl)=>(Al>>>0)+(Bl>>>0)+(Cl>>>0)+(Dl>>>0);exports.add4L=add4L;const add4H=(low,Ah,Bh,Ch,Dh)=>Ah+Bh+Ch+Dh+(low/2**32|0)|0;exports.add4H=add4H;const add5L=(Al,Bl,Cl,Dl,El)=>(Al>>>0)+(Bl>>>0)+(Cl>>>0)+(Dl>>>0)+(El>>>0);exports.add5L=add5L;const add5H=(low,Ah,Bh,Ch,Dh,Eh)=>Ah+Bh+Ch+Dh+Eh+(low/2**32|0)|0;exports.add5H=add5H;const u64={fromBig,split,toBig,shrSH,shrSL,rotrSH,rotrSL,rotrBH,rotrBL,rotr32H,rotr32L,rotlSH,rotlSL,rotlBH,rotlBL,add,add3L,add3H,add4L,add4H,add5H,add5L};exports.default=u64},"./node_modules/@coinbase/wallet-sdk/node_modules/@noble/hashes/crypto.js":(__unused_webpack_module,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.crypto=void 0,exports.crypto="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0},"./node_modules/@coinbase/wallet-sdk/node_modules/@noble/hashes/sha3.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.shake256=exports.shake128=exports.keccak_512=exports.keccak_384=exports.keccak_256=exports.keccak_224=exports.sha3_512=exports.sha3_384=exports.sha3_256=exports.sha3_224=exports.Keccak=exports.keccakP=void 0;const _assert_js_1=__webpack_require__("./node_modules/@coinbase/wallet-sdk/node_modules/@noble/hashes/_assert.js"),_u64_js_1=__webpack_require__("./node_modules/@coinbase/wallet-sdk/node_modules/@noble/hashes/_u64.js"),utils_js_1=__webpack_require__("./node_modules/@coinbase/wallet-sdk/node_modules/@noble/hashes/utils.js"),SHA3_PI=[],SHA3_ROTL=[],_SHA3_IOTA=[],_0n=BigInt(0),_1n=BigInt(1),_2n=BigInt(2),_7n=BigInt(7),_256n=BigInt(256),_0x71n=BigInt(113);for(let round=0,R=_1n,x=1,y=0;round<24;round++){[x,y]=[y,(2*x+3*y)%5],SHA3_PI.push(2*(5*y+x)),SHA3_ROTL.push((round+1)*(round+2)/2%64);let t=_0n;for(let j=0;j<7;j++)R=(R<<_1n^(R>>_7n)*_0x71n)%_256n,R&_2n&&(t^=_1n<<(_1n<<BigInt(j))-_1n);_SHA3_IOTA.push(t)}const[SHA3_IOTA_H,SHA3_IOTA_L]=(0,_u64_js_1.split)(_SHA3_IOTA,!0),rotlH=(h,l,s)=>s>32?(0,_u64_js_1.rotlBH)(h,l,s):(0,_u64_js_1.rotlSH)(h,l,s),rotlL=(h,l,s)=>s>32?(0,_u64_js_1.rotlBL)(h,l,s):(0,_u64_js_1.rotlSL)(h,l,s);function keccakP(s,rounds=24){const B=new Uint32Array(10);for(let round=24-rounds;round<24;round++){for(let x=0;x<10;x++)B[x]=s[x]^s[x+10]^s[x+20]^s[x+30]^s[x+40];for(let x=0;x<10;x+=2){const idx1=(x+8)%10,idx0=(x+2)%10,B0=B[idx0],B1=B[idx0+1],Th=rotlH(B0,B1,1)^B[idx1],Tl=rotlL(B0,B1,1)^B[idx1+1];for(let y=0;y<50;y+=10)s[x+y]^=Th,s[x+y+1]^=Tl}let curH=s[2],curL=s[3];for(let t=0;t<24;t++){const shift=SHA3_ROTL[t],Th=rotlH(curH,curL,shift),Tl=rotlL(curH,curL,shift),PI=SHA3_PI[t];curH=s[PI],curL=s[PI+1],s[PI]=Th,s[PI+1]=Tl}for(let y=0;y<50;y+=10){for(let x=0;x<10;x++)B[x]=s[y+x];for(let x=0;x<10;x++)s[y+x]^=~B[(x+2)%10]&B[(x+4)%10]}s[0]^=SHA3_IOTA_H[round],s[1]^=SHA3_IOTA_L[round]}B.fill(0)}exports.keccakP=keccakP;class Keccak extends utils_js_1.Hash{constructor(blockLen,suffix,outputLen,enableXOF=!1,rounds=24){if(super(),this.blockLen=blockLen,this.suffix=suffix,this.outputLen=outputLen,this.enableXOF=enableXOF,this.rounds=rounds,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,(0,_assert_js_1.number)(outputLen),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=(0,utils_js_1.u32)(this.state)}keccak(){utils_js_1.isLE||(0,utils_js_1.byteSwap32)(this.state32),keccakP(this.state32,this.rounds),utils_js_1.isLE||(0,utils_js_1.byteSwap32)(this.state32),this.posOut=0,this.pos=0}update(data){(0,_assert_js_1.exists)(this);const{blockLen,state}=this,len=(data=(0,utils_js_1.toBytes)(data)).length;for(let pos=0;pos<len;){const take=Math.min(blockLen-this.pos,len-pos);for(let i=0;i<take;i++)state[this.pos++]^=data[pos++];this.pos===blockLen&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state,suffix,pos,blockLen}=this;state[pos]^=suffix,128&suffix&&pos===blockLen-1&&this.keccak(),state[blockLen-1]^=128,this.keccak()}writeInto(out){(0,_assert_js_1.exists)(this,!1),(0,_assert_js_1.bytes)(out),this.finish();const bufferOut=this.state,{blockLen}=this;for(let pos=0,len=out.length;pos<len;){this.posOut>=blockLen&&this.keccak();const take=Math.min(blockLen-this.posOut,len-pos);out.set(bufferOut.subarray(this.posOut,this.posOut+take),pos),this.posOut+=take,pos+=take}return out}xofInto(out){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(out)}xof(bytes){return(0,_assert_js_1.number)(bytes),this.xofInto(new Uint8Array(bytes))}digestInto(out){if((0,_assert_js_1.output)(out,this),this.finished)throw new Error("digest() was already called");return this.writeInto(out),this.destroy(),out}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(to){const{blockLen,suffix,outputLen,rounds,enableXOF}=this;return to||(to=new Keccak(blockLen,suffix,outputLen,enableXOF,rounds)),to.state32.set(this.state32),to.pos=this.pos,to.posOut=this.posOut,to.finished=this.finished,to.rounds=rounds,to.suffix=suffix,to.outputLen=outputLen,to.enableXOF=enableXOF,to.destroyed=this.destroyed,to}}exports.Keccak=Keccak;const gen=(suffix,blockLen,outputLen)=>(0,utils_js_1.wrapConstructor)(()=>new Keccak(blockLen,suffix,outputLen));exports.sha3_224=gen(6,144,28),exports.sha3_256=gen(6,136,32),exports.sha3_384=gen(6,104,48),exports.sha3_512=gen(6,72,64),exports.keccak_224=gen(1,144,28),exports.keccak_256=gen(1,136,32),exports.keccak_384=gen(1,104,48),exports.keccak_512=gen(1,72,64);const genShake=(suffix,blockLen,outputLen)=>(0,utils_js_1.wrapXOFConstructorWithOpts)((opts={})=>new Keccak(blockLen,suffix,void 0===opts.dkLen?outputLen:opts.dkLen,!0));exports.shake128=genShake(31,168,16),exports.shake256=genShake(31,136,32)},"./node_modules/@coinbase/wallet-sdk/node_modules/@noble/hashes/utils.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.randomBytes=exports.wrapXOFConstructorWithOpts=exports.wrapConstructorWithOpts=exports.wrapConstructor=exports.checkOpts=exports.Hash=exports.concatBytes=exports.toBytes=exports.utf8ToBytes=exports.asyncLoop=exports.nextTick=exports.hexToBytes=exports.bytesToHex=exports.byteSwap32=exports.byteSwapIfBE=exports.byteSwap=exports.isLE=exports.rotl=exports.rotr=exports.createView=exports.u32=exports.u8=exports.isBytes=void 0;const crypto_1=__webpack_require__("./node_modules/@coinbase/wallet-sdk/node_modules/@noble/hashes/crypto.js"),_assert_js_1=__webpack_require__("./node_modules/@coinbase/wallet-sdk/node_modules/@noble/hashes/_assert.js");exports.isBytes=function isBytes(a){return a instanceof Uint8Array||null!=a&&"object"==typeof a&&"Uint8Array"===a.constructor.name};exports.u8=arr=>new Uint8Array(arr.buffer,arr.byteOffset,arr.byteLength);exports.u32=arr=>new Uint32Array(arr.buffer,arr.byteOffset,Math.floor(arr.byteLength/4));exports.createView=arr=>new DataView(arr.buffer,arr.byteOffset,arr.byteLength);exports.rotr=(word,shift)=>word<<32-shift|word>>>shift;exports.rotl=(word,shift)=>word<<shift|word>>>32-shift>>>0,exports.isLE=68===new Uint8Array(new Uint32Array([287454020]).buffer)[0];exports.byteSwap=word=>word<<24&4278190080|word<<8&16711680|word>>>8&65280|word>>>24&255,exports.byteSwapIfBE=exports.isLE?n=>n:n=>(0,exports.byteSwap)(n),exports.byteSwap32=function byteSwap32(arr){for(let i=0;i<arr.length;i++)arr[i]=(0,exports.byteSwap)(arr[i])};const hexes=Array.from({length:256},(_,i)=>i.toString(16).padStart(2,"0"));exports.bytesToHex=function bytesToHex(bytes){(0,_assert_js_1.bytes)(bytes);let hex="";for(let i=0;i<bytes.length;i++)hex+=hexes[bytes[i]];return hex};const asciis__0=48,asciis__9=57,asciis__A=65,asciis__F=70,asciis__a=97,asciis__f=102;function asciiToBase16(char){return char>=asciis__0&&char<=asciis__9?char-asciis__0:char>=asciis__A&&char<=asciis__F?char-(asciis__A-10):char>=asciis__a&&char<=asciis__f?char-(asciis__a-10):void 0}exports.hexToBytes=function hexToBytes(hex){if("string"!=typeof hex)throw new Error("hex string expected, got "+typeof hex);const hl=hex.length,al=hl/2;if(hl%2)throw new Error("padded hex string expected, got unpadded hex of length "+hl);const array=new Uint8Array(al);for(let ai=0,hi=0;ai<al;ai++,hi+=2){const n1=asciiToBase16(hex.charCodeAt(hi)),n2=asciiToBase16(hex.charCodeAt(hi+1));if(void 0===n1||void 0===n2){const char=hex[hi]+hex[hi+1];throw new Error('hex string expected, got non-hex character "'+char+'" at index '+hi)}array[ai]=16*n1+n2}return array};function utf8ToBytes(str){if("string"!=typeof str)throw new Error("utf8ToBytes expected string, got "+typeof str);return new Uint8Array((new TextEncoder).encode(str))}function toBytes(data){return"string"==typeof data&&(data=utf8ToBytes(data)),(0,_assert_js_1.bytes)(data),data}exports.nextTick=async()=>{},exports.asyncLoop=async function asyncLoop(iters,tick,cb){let ts=Date.now();for(let i=0;i<iters;i++){cb(i);const diff=Date.now()-ts;diff>=0&&diff<tick||(await(0,exports.nextTick)(),ts+=diff)}},exports.utf8ToBytes=utf8ToBytes,exports.toBytes=toBytes,exports.concatBytes=function concatBytes(...arrays){let sum=0;for(let i=0;i<arrays.length;i++){const a=arrays[i];(0,_assert_js_1.bytes)(a),sum+=a.length}const res=new Uint8Array(sum);for(let i=0,pad=0;i<arrays.length;i++){const a=arrays[i];res.set(a,pad),pad+=a.length}return res};exports.Hash=class Hash{clone(){return this._cloneInto()}};const toStr={}.toString;exports.checkOpts=function checkOpts(defaults,opts){if(void 0!==opts&&"[object Object]"!==toStr.call(opts))throw new Error("Options should be object or undefined");return Object.assign(defaults,opts)},exports.wrapConstructor=function wrapConstructor(hashCons){const hashC=msg=>hashCons().update(toBytes(msg)).digest(),tmp=hashCons();return hashC.outputLen=tmp.outputLen,hashC.blockLen=tmp.blockLen,hashC.create=()=>hashCons(),hashC},exports.wrapConstructorWithOpts=function wrapConstructorWithOpts(hashCons){const hashC=(msg,opts)=>hashCons(opts).update(toBytes(msg)).digest(),tmp=hashCons({});return hashC.outputLen=tmp.outputLen,hashC.blockLen=tmp.blockLen,hashC.create=opts=>hashCons(opts),hashC},exports.wrapXOFConstructorWithOpts=function wrapXOFConstructorWithOpts(hashCons){const hashC=(msg,opts)=>hashCons(opts).update(toBytes(msg)).digest(),tmp=hashCons({});return hashC.outputLen=tmp.outputLen,hashC.blockLen=tmp.blockLen,hashC.create=opts=>hashCons(opts),hashC},exports.randomBytes=function randomBytes(bytesLength=32){if(crypto_1.crypto&&"function"==typeof crypto_1.crypto.getRandomValues)return crypto_1.crypto.getRandomValues(new Uint8Array(bytesLength));throw new Error("crypto.getRandomValues must be defined")}}}]);